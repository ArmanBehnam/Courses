WEBVTT

1
00:00:00.420 --> 00:00:01.730
Hi, I'm Sergei Sav and

2
00:00:01.730 --> 00:00:06.250
we're starting session two of the second
week of Operations and Litics course.

3
00:00:06.250 --> 00:00:09.140
In session one,
we have looked at the Zooter example,

4
00:00:09.140 --> 00:00:12.620
a resource allocation problem
in which limited resources

5
00:00:12.620 --> 00:00:16.920
must be allocated among two competing
products in the most profitable way.

6
00:00:16.920 --> 00:00:20.330
We have identified the three main
components of the optimization model.

7
00:00:20.330 --> 00:00:24.250
Decision variables,
an objective function, and constraints.

8
00:00:24.250 --> 00:00:27.790
We have also written down an algebraic
formulation of this other problem.

9
00:00:27.790 --> 00:00:31.859
In this session, we'll create a
spreadsheet formulation of the model, and

10
00:00:31.859 --> 00:00:35.064
find the best decision using
the Solver Optimization tool.

11
00:00:35.064 --> 00:00:36.825
Okay, in session two,

12
00:00:36.825 --> 00:00:42.160
we will take an algebraic model
we put together in session one.

13
00:00:42.160 --> 00:00:46.490
Express it in the spreadsheet terms,
and we'll use Solver to optimize it.

14
00:00:47.740 --> 00:00:51.080
As a reminder, here's the algebraic
model of the Zooter problem.

15
00:00:51.080 --> 00:00:53.090
We have the decision variables, R,

16
00:00:53.090 --> 00:00:58.630
the number of razor scooters to produce,
and N, the number of scooters to produce.

17
00:00:58.630 --> 00:01:05.260
The objective function which is the
profit, 150 x R + 160 x N, that we want

18
00:01:05.260 --> 00:01:10.670
to maximize any constraints on available
resources and on our decision variables.

19
00:01:11.990 --> 00:01:15.550
As I mentioned Solver will
be our weapon of choice.

20
00:01:15.550 --> 00:01:16.320
So what is Solver?

21
00:01:17.380 --> 00:01:20.700
Solver is a standard
Excel editing Windows and

22
00:01:20.700 --> 00:01:23.670
it is available on later
versions of Excel for Mac.

23
00:01:23.670 --> 00:01:26.870
If you use Mac, we have a link
that explains the details for you.

24
00:01:28.490 --> 00:01:29.970
If you use Google Sheets,

25
00:01:29.970 --> 00:01:34.740
a version of the Solver is
available as the so-called add-on.

26
00:01:34.740 --> 00:01:37.824
Okay, this is my Excel template Zooter_0.

27
00:01:38.910 --> 00:01:41.430
It is posted on our site,
so you can open it now and

28
00:01:41.430 --> 00:01:43.380
follow the steps I'm going through.

29
00:01:45.210 --> 00:01:48.010
Here in the zero version,
we have put in the problem data,

30
00:01:48.010 --> 00:01:52.410
and also pasted in a copy of
the algebraic model so it'll be easier

31
00:01:52.410 --> 00:01:56.320
to make comparisons between the algebraic
and the spreadsheet formulations.

32
00:01:57.350 --> 00:01:59.067
We will do the model step by step and

33
00:01:59.067 --> 00:02:02.635
then we will use the solver to find
the best production plan for Zooter.

34
00:02:04.437 --> 00:02:10.130
To go over this example, we will use
Excel 2013 on the Windows platform.

35
00:02:10.130 --> 00:02:12.340
If you're using Mac or
Google Sheets instead,

36
00:02:12.340 --> 00:02:15.270
you should still look at the steps
we're following here first.

37
00:02:15.270 --> 00:02:18.530
Before we build the model,
let's figure out where to find the Solver.

38
00:02:18.530 --> 00:02:21.240
The Solver's is called Excel add in.

39
00:02:21.240 --> 00:02:25.450
We're not in Excel 2013 and in this
version of Excel, the Solver's located

40
00:02:25.450 --> 00:02:29.870
under the tab called Data in
the portion of the tab called Analysis.

41
00:02:29.870 --> 00:02:30.800
Here's my Solver button.

42
00:02:31.860 --> 00:02:34.320
If your setup is just like mine and

43
00:02:34.320 --> 00:02:37.450
you see the silver button there,
you're good to go.

44
00:02:37.450 --> 00:02:41.219
If you do not see the silver button,

45
00:02:41.219 --> 00:02:46.260
then you should go to
File > Options > Add Ins.

46
00:02:46.260 --> 00:02:49.820
And here at the bottom where it says
Manage Excel Add Ins, you click Go,

47
00:02:49.820 --> 00:02:54.120
and you wanna make sure that
the Solver Add In is checked.

48
00:02:54.120 --> 00:02:57.980
You click OK, and the Solver should
appear here on the Data tab.

49
00:03:00.340 --> 00:03:04.260
In the early versions of Excel, the steps
you need to take may be different but

50
00:03:04.260 --> 00:03:07.880
in any case just keep in mind
the Solver is an Excel add in.

51
00:03:07.880 --> 00:03:10.940
Find where the add ins are in
your version of Excel and

52
00:03:10.940 --> 00:03:13.320
make sure that the Solver is selected.

53
00:03:13.320 --> 00:03:15.810
Okay we're now ready to set up our model.

54
00:03:15.810 --> 00:03:19.140
For this first example we will proceed in
a very detailed manner to make sure that

55
00:03:19.140 --> 00:03:22.370
we cover every important
aspect of the model setup, and

56
00:03:22.370 --> 00:03:23.620
of the solver functionality.

57
00:03:24.720 --> 00:03:29.030
Now we need to translate our algebraic
model into a spreadsheet formulation.

58
00:03:29.030 --> 00:03:31.880
In other words,
we need to describe on the spreadsheet

59
00:03:31.880 --> 00:03:35.060
three key components of
an optimization model.

60
00:03:35.060 --> 00:03:39.520
Decision variables,
an objective function, and constraints.

61
00:03:39.520 --> 00:03:41.210
Let's start with the decision variables.

62
00:03:41.210 --> 00:03:45.180
In the Zooter problem we have two
products, Razor and Navajo scooters.

63
00:03:45.180 --> 00:03:47.860
So let's create cells that
will hold the values for

64
00:03:47.860 --> 00:03:50.120
each type of scooter to be produced.

65
00:03:50.120 --> 00:03:53.830
Let's say we select cell C10 and
D10 for this purpose.

66
00:03:54.870 --> 00:03:58.190
C10 will hold the value of the number
of Razor scooters to be produced,

67
00:03:58.190 --> 00:04:00.610
that is the value of
the decision variable R.

68
00:04:00.610 --> 00:04:03.790
And D10 will be reserved for
the number of Navajo scooters.

69
00:04:03.790 --> 00:04:06.410
That is,
the value of the decision variable N.

70
00:04:06.410 --> 00:04:13.225
Let us put the header in cell A10,
units to make,

71
00:04:18.756 --> 00:04:22.520
and let's add some trial
values In cells C10 and

72
00:04:22.520 --> 00:04:26.640
T10 to make sure that
those cells are not empty.

73
00:04:26.640 --> 00:04:30.447
Say let's consider producing
500 units of each scooter type.

74
00:04:34.543 --> 00:04:38.888
One last thing, let's highlight
the decision variable cells by

75
00:04:38.888 --> 00:04:43.665
using the blue color and bold font,
and by putting a frame around them.

76
00:04:43.665 --> 00:04:51.697
[SOUND] Of course whether
you do this embellishment or

77
00:04:51.697 --> 00:04:56.083
not is completely up to you.

78
00:04:56.083 --> 00:04:58.855
It will not effect the optimization but
if you do,

79
00:04:58.855 --> 00:05:02.287
the decision variables will be
easily recognizable as soon as

80
00:05:02.287 --> 00:05:07.300
the Excel file is opened and this will
make you're file easier to navigate.

81
00:05:07.300 --> 00:05:10.580
We have to find results to hold
our decision variable values.

82
00:05:10.580 --> 00:05:15.560
Later, we'll point the cells out to
Solver and ask the Solver to chang

83
00:05:15.560 --> 00:05:21.150
the values in cell C10 and D10 to identify
the best possible production plan.

84
00:05:21.150 --> 00:05:23.770
Okay, we're done with the decision
variables and are now ready for

85
00:05:23.770 --> 00:05:25.130
the objective function.

86
00:05:25.130 --> 00:05:27.600
The objective in this
model is the total profit.

87
00:05:27.600 --> 00:05:31.320
So we should be able to calculate how
much profit Zooter will be making for

88
00:05:31.320 --> 00:05:33.910
any values of the decision variables.

89
00:05:33.910 --> 00:05:36.940
Now, let's calculate and
record the profit value

90
00:05:36.940 --> 00:05:41.960
corresponding to our production
plan of 500 units of each model.

91
00:05:41.960 --> 00:05:46.460
Let's select the cell F10 to hold
the value of the objective function,

92
00:05:46.460 --> 00:05:47.770
that is the total profit value.

93
00:05:47.770 --> 00:05:50.960
In the cell F10 we will
be writing a formula

94
00:05:50.960 --> 00:05:53.510
that calculates the value
of the total profit.

95
00:05:53.510 --> 00:05:57.930
We'll start with the equality sign to tell
Excel that we have a formula in this cell.

96
00:05:57.930 --> 00:06:02.690
Now, for each of 500 Razor scooters,
Zooter gets $150.00.

97
00:06:02.690 --> 00:06:06.370
So we multiply 150 by 500.

98
00:06:06.370 --> 00:06:12.170
And to that value we must add the profit
earned from the Navajo scooters.

99
00:06:12.170 --> 00:06:17.280
That is 160 x 500.

100
00:06:17.280 --> 00:06:21.710
So the total is $155,000.

101
00:06:21.710 --> 00:06:27.090
So we have a formula for
the objective function cell.

102
00:06:27.090 --> 00:06:30.280
This formula will calculate
the total profit value for

103
00:06:30.280 --> 00:06:32.440
any choice of the decision variables.

104
00:06:32.440 --> 00:06:35.210
For example,
if we try a production plan of say,

105
00:06:35.210 --> 00:06:40.860
600 units of Razors, and
600 units of Navajos.

106
00:06:42.060 --> 00:06:46.670
The number in F10 immediately changes
to reflect the new profit value.

107
00:06:47.910 --> 00:06:51.556
So let's go back and
change it to 500 and 500.

108
00:06:54.646 --> 00:06:59.200
By the way, if you would like to see
the formula inside a particular cell or

109
00:06:59.200 --> 00:07:02.520
edit that formula you can
use a Windows shortcut F2.

110
00:07:03.630 --> 00:07:08.540
So we are in cell F10 and here we see
the formula for the objective function.

111
00:07:09.620 --> 00:07:12.480
In this problem we have
two decision variables.

112
00:07:12.480 --> 00:07:16.480
And the calculation of the profit
value involves studying two products.

113
00:07:16.480 --> 00:07:20.270
The product of the number of Razor
scooters and the profit contribution for

114
00:07:20.270 --> 00:07:24.260
each Razor scooter and the product
of the number of Navajo scooters and

115
00:07:24.260 --> 00:07:27.380
the profit contribution for
each Navajo scooter.

116
00:07:27.380 --> 00:07:31.270
But what if our problem contained
1,000 of decision variables,

117
00:07:31.270 --> 00:07:35.370
do we still have to write the profit
formula as a sum of 1,000 of products,

118
00:07:35.370 --> 00:07:37.260
one for each decision variable?

119
00:07:37.260 --> 00:07:38.900
Fortunately not.

120
00:07:38.900 --> 00:07:42.400
The Excel function sum product
allows us to use a kind of

121
00:07:42.400 --> 00:07:44.815
shorthand notation in such cases.

122
00:07:44.815 --> 00:07:48.885
Here's how the sum product works for
the case of two scooter models.

123
00:07:48.885 --> 00:07:50.538
We are in the cell left hand.

124
00:07:50.538 --> 00:07:54.033
And let's replace the current
profit formula by its

125
00:07:54.033 --> 00:07:56.900
equivalent using some product function.

126
00:07:56.900 --> 00:08:02.181
So we type SUMPRODUCT Of, C9 and

127
00:08:02.181 --> 00:08:07.950
D9 are profit contributions.

128
00:08:07.950 --> 00:08:11.290
And C10 and D10 are decision variables.

129
00:08:14.030 --> 00:08:18.460
The sum product function uses two
areas of cells of equal size.

130
00:08:18.460 --> 00:08:22.430
And multiplies the numbers in the first
area by the corresponding numbers in

131
00:08:22.430 --> 00:08:23.980
the second area.

132
00:08:23.980 --> 00:08:26.700
First number in the first array is
multiplied by the first number in

133
00:08:26.700 --> 00:08:28.030
the second array.

134
00:08:28.030 --> 00:08:31.310
Second number in the first array is
multiplied by the second number in

135
00:08:31.310 --> 00:08:33.970
the second array, and so on.

136
00:08:33.970 --> 00:08:37.690
After that the SUMPRODUCT simply
sums all of these products.

137
00:08:37.690 --> 00:08:42.920
So, the formula SUMPRODUCT C9:D9,
C10:D10 is exactly the same

138
00:08:42.920 --> 00:08:47.900
as the formula C9 x C10, + D9, x D10,

139
00:08:47.900 --> 00:08:52.380
and you'll get the same optimization
result no matter which one you use.

140
00:08:52.380 --> 00:08:56.530
However, the sum product formula is
a lot more convenient when working with

141
00:08:56.530 --> 00:09:00.730
the models with large numbers of variables
and large numbers of constraints.

142
00:09:01.740 --> 00:09:05.270
You can find more information about the
sum product function in the Excel Help.

143
00:09:06.650 --> 00:09:09.090
Okay, one last thing about
the objective function cell.

144
00:09:09.090 --> 00:09:11.030
Just like we did for
the decision variable cells,,

145
00:09:11.030 --> 00:09:15.420
let's highlight the objective function
cell to make sure it stands out visually.

146
00:09:15.420 --> 00:09:18.580
Let's change the font color to red and
make the font bold.

147
00:09:20.480 --> 00:09:25.540
So we're going to change the color to red,
make the font bold.

148
00:09:26.790 --> 00:09:29.560
And put the thick border.

149
00:09:29.560 --> 00:09:34.310
Now every time we open the file, we see
the decision variable cells in blue and

150
00:09:34.310 --> 00:09:35.760
the objective function cell in red.

151
00:09:35.760 --> 00:09:39.720
So those cells have visually
distinguishable from other cells.

152
00:09:39.720 --> 00:09:43.360
Later on we will instruct the solver
to change the values in our blue cells,

153
00:09:43.360 --> 00:09:45.880
C10 and D10, our decision variable values,

154
00:09:45.880 --> 00:09:50.610
to maximize the value in the red cell F10,
our objective function value.

155
00:09:50.610 --> 00:09:53.800
Of course, we can not just use
any values in the blue cells, but

156
00:09:53.800 --> 00:09:57.710
only those who require more resources
to produce, than what we have.

157
00:09:58.710 --> 00:10:01.800
Now that we're done with the decision
variables in the objective function,

158
00:10:01.800 --> 00:10:04.890
it is time to move on to the constraints.

159
00:10:04.890 --> 00:10:08.420
The main constraints in our model
express the limited developability of

160
00:10:08.420 --> 00:10:10.560
free production resources.

161
00:10:10.560 --> 00:10:14.520
Frame manufacturing hours,
wheel and deck assembly hours, and

162
00:10:14.520 --> 00:10:16.930
QA and packaging hours.

163
00:10:16.930 --> 00:10:20.130
Let's look first at the frame
manufacturing hours.

164
00:10:20.130 --> 00:10:23.080
We need to make sure that whatever
production plan we consider,

165
00:10:23.080 --> 00:10:26.280
the number of frame manufacturing
hours used by this plan

166
00:10:26.280 --> 00:10:29.670
does not exceed the number of frame
manufacturing hours available.

167
00:10:30.720 --> 00:10:34.790
In the algebraic formulation, the number
of frame manufacturing hours used by

168
00:10:34.790 --> 00:10:38.340
a production plan described
by decision variables are NN,

169
00:10:38.340 --> 00:10:43.208
is equal to 4*R + 5*N,

170
00:10:43.208 --> 00:10:48.559
and the number of available hours is 5610.

171
00:10:49.610 --> 00:10:54.130
In our spreadsheet formulation,
cell G14 holds

172
00:10:54.130 --> 00:10:59.156
the value of number of frame
manufacturing hours available 5610.

173
00:10:59.156 --> 00:11:05.200
Let us use the cell E14,
to calculate the number of

174
00:11:05.200 --> 00:11:11.260
frame manufacturing hours required by
the production plan in cells C10 and D10.

175
00:11:12.350 --> 00:11:20.660
For convenience, let us put the header
Required (hours) in cell E13, above E14.

176
00:11:28.697 --> 00:11:32.286
Okay, we have two more constraints to
convert into a spreadsheet format.

177
00:11:32.286 --> 00:11:35.407
The constraint on the number of wheels and
deck assembly hours and

178
00:11:35.407 --> 00:11:38.840
the constraint on the number of Q&A and
packaging hours.

179
00:11:38.840 --> 00:11:42.070
If you look at the algebraic formulation
of each of those constraints, you

180
00:11:42.070 --> 00:11:45.630
will notice that both have a very similar
structure to that of the constraint we

181
00:11:45.630 --> 00:11:50.080
already dealt with, the constraint on
the number of frame manufacturing hours.

182
00:11:50.080 --> 00:11:54.290
All three constraints have the full
instructure, expression on the left-hand

183
00:11:54.290 --> 00:11:58.620
side of the constraint, the number of
required hours, cannot exceed the number

184
00:11:58.620 --> 00:12:02.000
on the right-hand side of the constraint,
the number of available hours.

185
00:12:03.240 --> 00:12:05.470
Let's go to the cell E15 and

186
00:12:05.470 --> 00:12:08.890
put in the formula that will
calculate the number of wheels and

187
00:12:08.890 --> 00:12:14.600
deck assembly hours required for any pair
of decision variables in cell C10 and D10.

188
00:12:16.320 --> 00:12:20.390
Just like in the similar calculation for
the number of required frame manufacturing

189
00:12:20.390 --> 00:12:24.890
hours, we need to multiply each decision
variable by the number of wheels and deck

190
00:12:24.890 --> 00:12:31.080
assembly hours that a respective scooter
model uses and add the resulting products.

191
00:12:31.080 --> 00:12:36.222
In other words,
the formula that we put in the cell

192
00:12:36.222 --> 00:12:42.476
E15 is =SUMPRODUCT(C10:D10,C15:D15).

193
00:12:45.481 --> 00:12:48.722
For the production plan
we're currently considering,

194
00:12:48.722 --> 00:12:51.018
500 scooters of each scooter model,

195
00:12:51.018 --> 00:12:55.624
we have the number of required wheels and
deck manufacturing hours as 1750.

196
00:12:55.624 --> 00:12:59.978
Similarly, if we use cell E16 to
calculate the number of Q&A and

197
00:12:59.978 --> 00:13:04.879
packaging hours required by
the production plan in cells C10 and D10,

198
00:13:04.879 --> 00:13:07.630
we will put in the formula =SUMPRODUCT,

199
00:13:12.687 --> 00:13:22.141
(C10:D10, C16:D16).

200
00:13:22.141 --> 00:13:26.742
As we see, the current production plan
we're considering requires 900 hours of

201
00:13:26.742 --> 00:13:27.660
this resource.

202
00:13:28.750 --> 00:13:33.230
Okay, but what if we have thousands of
different resources to keep track of?

203
00:13:33.230 --> 00:13:36.970
Do we have to keep going into cells
in the E column one by one and

204
00:13:36.970 --> 00:13:38.500
type the sum product formula?

205
00:13:39.590 --> 00:13:43.940
Fortunately, Excel provides a way
of avoiding this by using copy and

206
00:13:43.940 --> 00:13:48.950
paste and the so-called absolute
cell referencing or cell anchoring.

207
00:13:50.120 --> 00:13:56.190
Let's compare the formula in the cell
E14 to the formulas in the cells E15 and

208
00:13:56.190 --> 00:13:57.550
E16 one more time.

209
00:13:58.640 --> 00:14:05.460
All three formulas use the SUMPRODUCT of
the decision variable cells, C10 and D10.

210
00:14:06.470 --> 00:14:08.850
Here's the formula in the cell E14.

211
00:14:11.510 --> 00:14:15.100
And the consumption amounts
of each respective resource.

212
00:14:15.100 --> 00:14:19.286
C14 and D14 for this cell E14.

213
00:14:19.286 --> 00:14:22.760
C15 and D15 for the cell E15.

214
00:14:22.760 --> 00:14:26.457
And C16 and D16 for the cell E16.

215
00:14:26.457 --> 00:14:30.343
So if we would take a formula
in the cell E14 and

216
00:14:30.343 --> 00:14:33.646
copy and paste it into the cells E15 and

217
00:14:33.646 --> 00:14:38.310
E16, we would need to instruct
Excel to leave C10 and

218
00:14:38.310 --> 00:14:43.169
D10 unchanged during this copy and
paste operation, and

219
00:14:43.169 --> 00:14:49.030
to change C14 and D14 into C15 and
D15 and into C16 and D16.

220
00:14:50.320 --> 00:14:55.070
The way to accomplish this is to use
the absolute cell referencing, or

221
00:14:55.070 --> 00:14:57.860
cell anchoring, for the cells C10 and

222
00:14:57.860 --> 00:15:03.270
D10 before doing the regular
Excel copy and paste operation.

223
00:15:03.270 --> 00:15:05.130
Here's how we accomplish this.

224
00:15:05.130 --> 00:15:11.750
We go into the cell E14,
we highlight cells C10 and D10,

225
00:15:11.750 --> 00:15:17.690
and we use a Windows shortcut,
F4 to put the dollar signs

226
00:15:17.690 --> 00:15:23.190
around the addresses for
sales C10 and D10.

227
00:15:23.190 --> 00:15:27.750
Those dollar signs instruct Excel not
to change the addresses of the cells

228
00:15:27.750 --> 00:15:29.700
when doing copy and paste.

229
00:15:29.700 --> 00:15:34.700
If I now just copy and
paste the formula in E14 into E15 and

230
00:15:34.700 --> 00:15:38.000
E16, I get the correct
formulas in those cells.

231
00:15:39.780 --> 00:15:42.910
So, I am doing copy and paste.

232
00:15:45.610 --> 00:15:49.270
For example if I now look at the cell E16,

233
00:15:49.270 --> 00:15:53.543
I see the formula =SUMPRODUCT(C10:D10,

234
00:15:53.543 --> 00:15:57.830
C16:D16) and that is the correct formula.

235
00:15:57.830 --> 00:16:02.039
Clearly using this anchoring technique,
I can simply type a formula for

236
00:16:02.039 --> 00:16:06.387
the resource consumption of one resource
And curve what ever cells I want,

237
00:16:06.387 --> 00:16:09.130
in this case decision variable cells.

238
00:16:09.130 --> 00:16:11.690
And then just copy and
paste the formula to

239
00:16:11.690 --> 00:16:16.540
all cells that calculate consumption
amounts of all other resources.

240
00:16:16.540 --> 00:16:19.530
And it does not really matter
if I have hundreds of those.

241
00:16:19.530 --> 00:16:24.180
I can still do it all in one copy and
paste operation.

242
00:16:24.180 --> 00:16:29.420
You can learn more about the absolute
cell referencing using Excel Help.

243
00:16:31.490 --> 00:16:36.410
Let's also use a visual cue to indicate
that what we want in the optimization,

244
00:16:36.410 --> 00:16:41.230
is that the values in the cells E14,
E15, and E16, to be less than or

245
00:16:41.230 --> 00:16:45.484
equal to the values in the cells G14,
G15, and G16.

246
00:16:48.940 --> 00:16:51.170
So we put less or equal signs here.

247
00:16:51.170 --> 00:16:55.430
This is just a visual embellishment
to make sure that we can

248
00:16:55.430 --> 00:16:58.610
read our file in an easy manner.

249
00:17:00.220 --> 00:17:04.400
Okay, we have created cells that hold
values of the decision variables.

250
00:17:04.400 --> 00:17:08.170
The objective function and
the resource consumption values.

251
00:17:08.170 --> 00:17:11.380
How will we go about finding
the best production plan?

252
00:17:11.380 --> 00:17:15.340
In short, we want to find the values
in the cells C0 and D10, our decision

253
00:17:15.340 --> 00:17:20.800
variable cells, that make the value in
the cell F10, our objective function cell,

254
00:17:20.800 --> 00:17:25.410
as large as possible while making
sure that the values in E14, E15, and

255
00:17:25.410 --> 00:17:30.830
E16 do not exceed the values in G14,
G15, and G16, respectively.

256
00:17:30.830 --> 00:17:33.020
Those are resource constraints.

257
00:17:33.020 --> 00:17:36.370
For example if we produce
500 units of each model,

258
00:17:36.370 --> 00:17:41.350
we earn the profit of
$155,000 as Excel tells us.

259
00:17:41.350 --> 00:17:46.000
And all of our resource consumption
values stay within allowable ranges.

260
00:17:46.000 --> 00:17:49.090
Well, can we make more money
by increasing the production?

261
00:17:49.090 --> 00:17:51.413
Let's try producing 500 Razor scooters.

262
00:17:51.413 --> 00:17:54.362
That's 750 Navajo scooters.

263
00:17:54.362 --> 00:17:59.255
Our profit jumps to $195,000 but
unfortunately we ran out of

264
00:17:59.255 --> 00:18:04.040
frame manufacturing and wheels and
deck assembly resources.

265
00:18:04.040 --> 00:18:07.350
So we cannot simply implement
this production plan.

266
00:18:07.350 --> 00:18:12.710
Now, let's tone it down to say,
600 Navajo scooters, so

267
00:18:12.710 --> 00:18:17.460
our profit goes down to $171,000,

268
00:18:17.460 --> 00:18:23.150
and our required number of hours
stay within the allowable limits.

269
00:18:23.150 --> 00:18:29.440
So we can keep checking different
values of decision variables,

270
00:18:29.440 --> 00:18:34.030
trying to improve the profit while
staying within the resource limits.

271
00:18:34.030 --> 00:18:36.857
The problem is,
if we're trying to do it manually,

272
00:18:36.857 --> 00:18:41.183
then we spend a tremendous amount of
time checking out various possibilities.

273
00:18:41.183 --> 00:18:44.291
And even then we might not
find the best production plan,

274
00:18:44.291 --> 00:18:48.310
especially if we have to deal
with many decision variables.

275
00:18:48.310 --> 00:18:50.050
This is where the solver comes in.

276
00:18:50.050 --> 00:18:54.070
It would be impossible any human to
check all possible alternatives,

277
00:18:54.070 --> 00:18:57.060
just because there could be so
many of those alternatives.

278
00:18:57.060 --> 00:19:01.110
The solver, though, does a much faster,
and much more through job

279
00:19:01.110 --> 00:19:04.890
of checking those alternatives in
trying to come up with the best.

280
00:19:04.890 --> 00:19:06.960
So let's bring in a solver.

281
00:19:06.960 --> 00:19:10.620
Let's go to Data, click on Solver.

282
00:19:12.140 --> 00:19:17.370
The solver parameter's dialog comes
up here in the set objective part.

283
00:19:17.370 --> 00:19:19.830
We click on the cell selection tool and

284
00:19:19.830 --> 00:19:23.490
choose the cell F10 to
represent our objective.

285
00:19:25.410 --> 00:19:30.310
As you can see, the solver can maximize or
minimize the objective.

286
00:19:31.440 --> 00:19:36.680
Minimization could be helpful if you are
dealing with minimization of the cost, or

287
00:19:36.680 --> 00:19:39.740
it could select a values
of decision variables to

288
00:19:39.740 --> 00:19:43.250
produce a desired value of
the objective function.

289
00:19:43.250 --> 00:19:46.886
In a scooter problem we maximize profits,
so recheck max option.

290
00:19:46.886 --> 00:19:54.410
Next, we use by changing variable cells to
specify where our decision variables are.

291
00:19:54.410 --> 00:19:59.950
So we use the cell selection tool again to
point to the cells C10 and D10, and we go

292
00:19:59.950 --> 00:20:06.240
back and we see that Excel now understands
where our decision variables are.

293
00:20:06.240 --> 00:20:09.310
Finally, we need to specify to
sole where the constraints are.

294
00:20:09.310 --> 00:20:13.160
We use Subject to Constraints,
a part, and click Add.

295
00:20:14.640 --> 00:20:16.480
The dialog Add Constraint appears.

296
00:20:16.480 --> 00:20:22.070
In this dialogue,
we use Cell Reference to select cells E14,

297
00:20:22.070 --> 00:20:25.690
E15, and E16 on the left-hand
side of the constraint.

298
00:20:27.240 --> 00:20:32.090
We also use constraint part
to select the values G14,

299
00:20:32.090 --> 00:20:35.460
G15, and G16 on the right-hand
side of that constraint.

300
00:20:35.460 --> 00:20:40.970
So, now we instructing this over to
make sure that E14 does not exceed G14,

301
00:20:40.970 --> 00:20:47.080
E15 does not exceed G15, and
E16 does not exceed G16.

302
00:20:48.990 --> 00:20:53.600
Know that we can also specify
constraint of equal type or

303
00:20:53.600 --> 00:20:56.560
greater equal type, and
there are other choices here.

304
00:20:56.560 --> 00:20:58.400
We'll use one of them later.

305
00:20:58.400 --> 00:21:02.230
So let's select our less or
equal than sign.

306
00:21:02.230 --> 00:21:03.440
Let's click OK.

307
00:21:03.440 --> 00:21:05.150
And we see that this constraint is added.

308
00:21:06.500 --> 00:21:09.420
What is left is adding constraints
that tell the solver that our decision

309
00:21:09.420 --> 00:21:13.440
variables must be integer and
non-negative.

310
00:21:13.440 --> 00:21:15.560
Let's add the integer constraint first.

311
00:21:15.560 --> 00:21:22.000
We can click on Add, select our
decision variable, C10 and D10, and

312
00:21:22.000 --> 00:21:27.400
then in the drop down menu select
INT options, which means integer.

313
00:21:27.400 --> 00:21:33.350
So now when we click OK,
the Excel solver understands that

314
00:21:33.350 --> 00:21:38.260
it must only use integer
values in the cells C10 and

315
00:21:38.260 --> 00:21:41.260
D10 when it searches for
the best production plant.

316
00:21:43.485 --> 00:21:47.250
Okay, the last constraint is
a non-negativity constraint and

317
00:21:47.250 --> 00:21:50.770
the solver offers a convenient way
of introducing this constraint for

318
00:21:50.770 --> 00:21:54.020
all decision variables at the same time.

319
00:21:54.020 --> 00:21:59.809
All we need to do is to check the box make
all unconstrained variables non-negative.

320
00:22:01.580 --> 00:22:04.460
Next we need to select a solving method.

321
00:22:04.460 --> 00:22:11.330
Solver offers several choices here
with a default being GRG Nonlinear.

322
00:22:12.680 --> 00:22:16.019
One of the choices is LP Simplex.

323
00:22:17.550 --> 00:22:22.340
This is a solving method that can only be
applied to linear models, in other words,

324
00:22:22.340 --> 00:22:24.840
the models where
the objective function and

325
00:22:24.840 --> 00:22:28.620
the constraints are linear
functions of decision variables.

326
00:22:28.620 --> 00:22:33.470
So if you are sure that your
model is built as a linear model,

327
00:22:33.470 --> 00:22:36.770
use this option since it solves
linear models very efficiently.

328
00:22:38.370 --> 00:22:41.009
If your model is not linear however, and

329
00:22:41.009 --> 00:22:45.756
you're trying to use the LP Simplex
option, the solver will complain.

330
00:22:45.756 --> 00:22:49.740
Now in this discussion I would like to
focus on the details of the modeling

331
00:22:49.740 --> 00:22:54.370
process rather than on distinctions
between linear and nonlinear models.

332
00:22:54.370 --> 00:22:58.800
So I would leave the solving
method at GRG Nonlinear.

333
00:22:58.800 --> 00:23:02.530
This solution method is very general and
will allow you to work with

334
00:23:02.530 --> 00:23:06.710
many different kinds of models,
both linear and nonlinear.

335
00:23:07.750 --> 00:23:12.270
And a word of caution, if you select the
GRG nonlinear method, you do not have to

336
00:23:12.270 --> 00:23:15.630
worry about whether your model is linear
or nonlinear, which is the good thing.

337
00:23:16.870 --> 00:23:20.340
Since it is a general method of
solving optimization problems,

338
00:23:20.340 --> 00:23:25.200
it will try to find the solution for
any model that you formulate.

339
00:23:25.200 --> 00:23:29.940
However, it may not always be able to
guarantee that what it finds, it gives you

340
00:23:29.940 --> 00:23:34.082
as a solution, is actually the best
possible alternative in every case.

341
00:23:34.082 --> 00:23:38.566
In addition the output of optimization
using the GRG nonlinear method

342
00:23:38.566 --> 00:23:42.293
may depend on the trial values
of the decision variables.

343
00:23:42.293 --> 00:23:44.456
So when optimizing using this method,

344
00:23:44.456 --> 00:23:49.043
run it several times with different trial
values of the decision variables to see if

345
00:23:49.043 --> 00:23:51.680
you can improve the objective
function value.

346
00:23:52.860 --> 00:23:55.863
Okay, the last stop before optimizing.

347
00:23:55.863 --> 00:23:58.085
Let's go to Options, and

348
00:23:58.085 --> 00:24:03.444
make sure that the Ignore Exchange
Constraints is unchecked.

349
00:24:03.444 --> 00:24:07.298
This way, we're really making
sure that the solver will

350
00:24:07.298 --> 00:24:11.020
not try to produce something
like 54.6 scooters.

351
00:24:11.020 --> 00:24:14.330
We're ready to find
the best production plan.

352
00:24:14.330 --> 00:24:15.940
Let's click solve button, and

353
00:24:15.940 --> 00:24:21.330
make sure that solver found is solution is
displayed in the dialogue that appears.

354
00:24:21.330 --> 00:24:22.410
And it does.

355
00:24:23.870 --> 00:24:26.450
Let's click okay and
look at the spreadsheet.

356
00:24:28.830 --> 00:24:33.325
Solver recommends producing
840 unit of razor scooters and

357
00:24:33.325 --> 00:24:37.050
450 of Navajo scooters,

358
00:24:37.050 --> 00:24:42.700
if Zooter wants to maximize it's profit
given the resources the company has.

359
00:24:42.700 --> 00:24:50.160
The corresponding profit value is 100 and
$98,000.

360
00:24:50.160 --> 00:24:54.500
Before we leave Excel,
a few words about solver messages.

361
00:24:54.500 --> 00:24:58.140
This time the solver came up with
the message, solver found a solution.

362
00:24:58.140 --> 00:24:59.440
This is the message we want to see.

363
00:24:59.440 --> 00:25:04.500
I would like to mention two other
messages that we do not want to see.

364
00:25:04.500 --> 00:25:07.300
Suppose that we made a mistake
in setting up our model and

365
00:25:07.300 --> 00:25:10.580
forgot to include one or
more important constraints.

366
00:25:10.580 --> 00:25:13.780
Let's go to our solver dialogue and
wipe out all of our constraints,

367
00:25:13.780 --> 00:25:16.930
and then try to optimize
our production plan.

368
00:25:16.930 --> 00:25:17.830
So we go here.

369
00:25:17.830 --> 00:25:22.110
I'm going to say delete, and
we say delete, so we have no constraints.

370
00:25:22.110 --> 00:25:25.640
Of course, that's silly, but
let's try to solve the model and

371
00:25:25.640 --> 00:25:28.558
see what kind of message
the solver comes up with.

372
00:25:28.558 --> 00:25:32.790
Well, the solver comes up with
a huge red explanation sign,

373
00:25:32.790 --> 00:25:37.150
and the message,
objective cell values do not converge.

374
00:25:37.150 --> 00:25:40.550
This means that the profit in
this model can grow to infinity.

375
00:25:40.550 --> 00:25:44.600
When you see a message like that when
trying to optimize your model, please

376
00:25:44.600 --> 00:25:49.000
remember that it most probably indicates
that you forgot an important constraint.

377
00:25:50.245 --> 00:25:53.218
Okay, let's put back our constraints.

378
00:25:53.218 --> 00:25:57.612
So over, add.

379
00:25:57.612 --> 00:26:00.430
This pre-constraints
should be less than three,

380
00:26:00.430 --> 00:26:02.890
the other should be lesser or
equivalent than this three values.

381
00:26:06.790 --> 00:26:10.410
And let's add integer constraints
on our decision variables.

382
00:26:10.410 --> 00:26:15.270
So let's go like this and
click I-N-T, integer.

383
00:26:15.270 --> 00:26:16.450
And we're back.

384
00:26:16.450 --> 00:26:19.850
Let's click solver, just to make
sure that we get everything right.

385
00:26:19.850 --> 00:26:21.030
Here's the optimal solution.

386
00:26:22.330 --> 00:26:24.360
Okay.
Now, let's set a constraint that will

387
00:26:24.360 --> 00:26:28.440
make it impossible for the solver to find
the values of the decision variables

388
00:26:28.440 --> 00:26:31.670
that will satisfy all of
the constraints in the problem.

389
00:26:31.670 --> 00:26:35.790
For example, right now we want
the number of frame manufacturing hours

390
00:26:35.790 --> 00:26:38.250
used by the production and
not exceed 5,610.

391
00:26:38.250 --> 00:26:43.570
Suppose with a constraint that also
requires the number used manufacturing,

392
00:26:43.570 --> 00:26:47.040
frame manufacturing hours
to be at least 6,000.

393
00:26:47.040 --> 00:26:51.550
Of course, these two constraints
cannot be set aside at the same time.

394
00:26:51.550 --> 00:26:55.930
But let's see what the software tells us
when we are trying to solve the model

395
00:26:55.930 --> 00:26:58.790
with this constraint added.

396
00:26:58.790 --> 00:27:03.250
So we're going to solver, and
we're saying, let's add this constraint.

397
00:27:03.250 --> 00:27:08.020
Let's say the number of required
hours of freight manufacturing

398
00:27:08.020 --> 00:27:11.904
should be at least greater or
equal than 6000.

399
00:27:13.810 --> 00:27:16.250
It's an incompatible constraint
with your other constraints,

400
00:27:16.250 --> 00:27:18.920
but let's see what the cell
reaction would be.

401
00:27:18.920 --> 00:27:23.840
We click solve and the solver comes up
with another red exclamation sign and

402
00:27:23.840 --> 00:27:26.980
a message that it could not
find a feasible solution.

403
00:27:26.980 --> 00:27:31.940
In other words, it could not satisfy
all the constraints at the same time.

404
00:27:31.940 --> 00:27:36.240
So when we see one of these messages,
there's something wrong with our model.

405
00:27:36.240 --> 00:27:40.480
Either, in the case of the first message
we are probably missing an important

406
00:27:40.480 --> 00:27:44.520
constraint, given the objective
function we're trying to optimize, or

407
00:27:44.520 --> 00:27:49.440
we have some incompatible constraints
in the case of the second message.

408
00:27:49.440 --> 00:27:52.505
Let's restore our model
to its original state and

409
00:27:52.505 --> 00:27:57.710
solve it one more time to
make sure everything is fine.

410
00:27:57.710 --> 00:28:00.680
Let's delete this spurious constraint.

411
00:28:00.680 --> 00:28:02.400
Let's click unsolved.

412
00:28:02.400 --> 00:28:05.500
And here we go,
we have our optimal solution.

413
00:28:06.790 --> 00:28:10.830
This final spreadsheet with comments
reflecting the formulas we introduced

414
00:28:10.830 --> 00:28:13.860
is posted on our site
under the name Zooter.

415
00:28:15.240 --> 00:28:19.630
Okay, here's a picture of the optimized
spreadsheet with formulas.

416
00:28:19.630 --> 00:28:25.140
We have the best solution,
840 Razors and 450 Navajos and

417
00:28:26.350 --> 00:28:30.394
the best possible profit, $198,000.

418
00:28:31.910 --> 00:28:35.230
Okay, let's rig up some
optimization terms.

419
00:28:35.230 --> 00:28:38.930
A particular combination of decision
variable values is called solution.

420
00:28:40.290 --> 00:28:44.738
A feasible solution is the one
that satisfies all constraints.

421
00:28:44.738 --> 00:28:49.950
And an in-feasible solution is the one
that violates at least one constraint,

422
00:28:49.950 --> 00:28:50.730
no matter which.

423
00:28:52.260 --> 00:28:55.800
The objective function value is
a number that you will obtain

424
00:28:55.800 --> 00:28:59.380
if you plug in decision variable values,

425
00:28:59.380 --> 00:29:03.330
corresponding to a particular
solution into the objective function.

426
00:29:06.430 --> 00:29:11.670
Finally, the optimal solution
is the best feasible solution.

427
00:29:11.670 --> 00:29:16.830
In the Zooter case,
it is 840 Razor scooters,

428
00:29:16.830 --> 00:29:19.510
and 450 Navajo scooters.

429
00:29:20.530 --> 00:29:23.430
It is possible to have more
than one optimal solution, but

430
00:29:23.430 --> 00:29:29.270
in that case, any optimal solution will
produce the same objective function value.

431
00:29:29.270 --> 00:29:30.000
The best one.

432
00:29:31.210 --> 00:29:35.120
In this session, we have used the solver
optimization tool to set up and

433
00:29:35.120 --> 00:29:37.620
solve Zooter optimization problem.

434
00:29:37.620 --> 00:29:40.730
While doing this, we have learned two
approaches that are often useful in

435
00:29:40.730 --> 00:29:45.120
setting up spreadsheet optimization models
in Excel, the use of the sum-product

436
00:29:45.120 --> 00:29:50.090
function and the use of cell anchoring or
absolute cell referencing.

437
00:29:50.090 --> 00:29:54.160
While details of solver operation may be
slightly different in different platforms,

438
00:29:54.160 --> 00:29:56.290
for example Windows versus Mac,

439
00:29:56.290 --> 00:30:00.460
the main features of the optimization
process are pretty much the same.

440
00:30:00.460 --> 00:30:04.530
In particular, we must identify for
the solver the three main components of

441
00:30:04.530 --> 00:30:10.790
an optimization model, decision variables,
the objective function and constraints.

442
00:30:10.790 --> 00:30:13.200
If you an excel for Mac or google sheets,

443
00:30:13.200 --> 00:30:17.760
have a look at two brief videos we created
for you to go over some minor differences,

444
00:30:17.760 --> 00:30:20.260
in how optimization problems
are set up and solved.

445
00:30:21.360 --> 00:30:26.560
The Zooter's problem had two decision
variables and three resource constraints.

446
00:30:26.560 --> 00:30:30.920
Real resource allocation applications may
contain hundreds of thousands of variables

447
00:30:30.920 --> 00:30:33.280
and constraints or more.

448
00:30:33.280 --> 00:30:36.550
Of course, solver will not be able
to handle such large problems.

449
00:30:36.550 --> 00:30:40.130
But commercial optimization software
packages that are powerful enough to deal

450
00:30:40.130 --> 00:30:44.570
with problems of this size will still
operate using decision variables,

451
00:30:44.570 --> 00:30:47.920
objective function and
constraints just like the solver.

452
00:30:49.110 --> 00:30:52.230
The Zooter's problem is
a resource allocation example.

453
00:30:52.230 --> 00:30:56.160
In the next session, we will look at
another popular type of resource problem.

454
00:30:56.160 --> 00:31:00.790
One in which supply must meet demand
across the network of locations.

455
00:31:00.790 --> 00:31:01.570
See you next time.