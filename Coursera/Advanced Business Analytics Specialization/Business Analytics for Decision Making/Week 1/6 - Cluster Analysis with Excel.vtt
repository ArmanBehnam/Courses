WEBVTT

1
00:00:00.200 --> 00:00:01.880
As we mentioned in the previous video,

2
00:00:01.880 --> 00:00:05.640
cluster analysis can be viewed
as an optimization problem.

3
00:00:05.640 --> 00:00:09.150
Excel includes an optimization
tool called Solver.

4
00:00:09.150 --> 00:00:13.900
We'll not get into the details of how
Solver works because we will cover

5
00:00:13.900 --> 00:00:15.319
optimization later in this course.

6
00:00:16.320 --> 00:00:18.870
Also, the approach of using Solver for

7
00:00:18.870 --> 00:00:24.260
the cluster analysis is only practical for
datasets that are relatively small.

8
00:00:24.260 --> 00:00:29.020
So we just want to show that it is
possible to use Excel to approach

9
00:00:29.020 --> 00:00:32.840
cluster analysis from the point of
view of an optimization problem.

10
00:00:32.840 --> 00:00:36.710
To make it more interesting we're
going to show how to use Excel for

11
00:00:36.710 --> 00:00:39.390
cluster analysis using an example.

12
00:00:39.390 --> 00:00:45.290
As we mention before, companies are often
interested in segmenting their customers

13
00:00:45.290 --> 00:00:51.220
to better target a specific product
offerings to meet specific customer needs.

14
00:00:51.220 --> 00:00:54.640
Letâ€™s assume that an online
retailer has collected data

15
00:00:54.640 --> 00:00:57.430
on three contents of her customers.

16
00:00:57.430 --> 00:01:02.010
This data is in the Excel file
Market Segmentation- Excel.

17
00:01:02.010 --> 00:01:04.920
You might want to pause
the video to locate the file and

18
00:01:04.920 --> 00:01:07.740
open it so you can follow along or

19
00:01:07.740 --> 00:01:12.850
just continue to watch the video and
play with the model later, it's up to you.

20
00:01:12.850 --> 00:01:16.920
Let us start in the original Data tab
to examine what data was collected for

21
00:01:16.920 --> 00:01:18.700
each of the three candy customers.

22
00:01:18.700 --> 00:01:22.810
You can see that for each customer,
there are two demographic variables,

23
00:01:22.810 --> 00:01:28.330
income level and number of dependence as
well as two buying behavior variables,

24
00:01:28.330 --> 00:01:33.010
number of purchases made last year, and
the average value of each purchase.

25
00:01:33.010 --> 00:01:36.040
Let's assume that the online
retailers wants to know

26
00:01:36.040 --> 00:01:40.500
if the data supports the hypothesis that
there are three segments in her market.

27
00:01:40.500 --> 00:01:44.730
So we're going to use closer analysis
to help her answer this question.

28
00:01:44.730 --> 00:01:48.600
The first step in our analysis
is to normalize the data.

29
00:01:48.600 --> 00:01:52.010
Recall that normalization is
a transformation of each variable

30
00:01:52.010 --> 00:01:53.260
in the dataset.

31
00:01:53.260 --> 00:01:57.250
In our table, the variables
are in the columns label Income,

32
00:01:57.250 --> 00:02:01.460
Average Purchase, Last year purchases and
the Number of Dependents.

33
00:02:01.460 --> 00:02:04.570
The normalization consists
of subtracting the mean and

34
00:02:04.570 --> 00:02:06.600
dividing by the standard deviation.

35
00:02:06.600 --> 00:02:10.830
Click on the normalized Data tab
to see the normalized values.

36
00:02:10.830 --> 00:02:14.790
The normalized values have a mean of 0 and
a standard deviation of 1.

37
00:02:14.790 --> 00:02:18.190
Now, click on the Clusters
tab to look at the model.

38
00:02:18.190 --> 00:02:23.100
The model is based on the idea of choosing
three customers to represent the centroids

39
00:02:23.100 --> 00:02:24.770
of the three clusters.

40
00:02:24.770 --> 00:02:32.230
Cells H5, H6, and H7 have the three
customers that haven't chosen a centroids.

41
00:02:32.230 --> 00:02:36.590
The arbitrary solution that is shown on
the spreadsheet consists of customers 10,

42
00:02:36.590 --> 00:02:40.370
20, and
30 as the centroids of the three clusters.

43
00:02:40.370 --> 00:02:44.750
The center values in the table
correspond to the normalized values for

44
00:02:44.750 --> 00:02:46.470
the selected customer.

45
00:02:46.470 --> 00:02:51.850
For example, if we change 10 to 15,
we see that the central values change.

46
00:02:51.850 --> 00:02:54.730
In this other table,
the model uses Euclidean

47
00:02:54.730 --> 00:02:58.240
distances to assign the customers
to the closest cluster.

48
00:02:58.240 --> 00:03:03.310
For example, we see that the first six
customers are assigned to cluster 2.

49
00:03:03.310 --> 00:03:09.360
Customer 7 is assigned to cluster 3 and
customer 10 is assigned to cluster 1.

50
00:03:09.360 --> 00:03:13.200
The model also calculates
the total squared distance,

51
00:03:13.200 --> 00:03:17.070
which is the sum of all
the distances in column E.

52
00:03:17.070 --> 00:03:20.670
Now we're ready to optimize,
which is nothing more than searching for

53
00:03:20.670 --> 00:03:24.480
the set of three customers
that are the best centroids.

54
00:03:24.480 --> 00:03:29.390
Clearly, the best set is the one that
minimizes the total sum of a squares.

55
00:03:29.390 --> 00:03:33.180
We don't want to do this by manually
changing the values because believe it or

56
00:03:33.180 --> 00:03:37.830
not, there are more than 4.4 million
ways of choosing three customers

57
00:03:37.830 --> 00:03:39.730
from a set of 300.

58
00:03:39.730 --> 00:03:43.050
So we're going to use
an Excel tool called Solver.

59
00:03:43.050 --> 00:03:47.315
To access this tool, we got to
the Analyze Group in the Data tab.

60
00:03:47.315 --> 00:03:50.211
If Solver is not there,
you need to first load it.

61
00:03:50.211 --> 00:03:54.321
If you Google adding solver to Excel,
you will find instructions on how

62
00:03:54.321 --> 00:03:59.150
to add Solver to the different versions
of Excel for Windows and for the Mac.

63
00:03:59.150 --> 00:04:02.880
You can pause this video and come back
here once you have loaded Solver.

64
00:04:02.880 --> 00:04:06.290
Okay, if your Solver is ready to go,
then click on it and

65
00:04:06.290 --> 00:04:09.130
you will see that the model
is all ready there.

66
00:04:09.130 --> 00:04:11.640
This is a simple model for
the set of objective,

67
00:04:11.640 --> 00:04:17.000
SJ9 that is the objective function
is the total sum of squares.

68
00:04:17.000 --> 00:04:20.391
We want to minimize this value so
Min is chosen.

69
00:04:20.391 --> 00:04:24.978
The changing cells are the values that
the solver can manipulate to minimize your

70
00:04:24.978 --> 00:04:26.265
objective function.

71
00:04:26.265 --> 00:04:31.372
In this case, there are only three cells,
H5 to H7, which correspond

72
00:04:31.372 --> 00:04:36.420
to the three customers that are going
to be selected as centroids.

73
00:04:36.420 --> 00:04:40.560
And then, there are three constraints
related to the changing cells.

74
00:04:40.560 --> 00:04:43.540
The values in the changing
cells must be integer.

75
00:04:43.540 --> 00:04:47.310
They must be greater than or equal to 1,
and they must be less than or

76
00:04:47.310 --> 00:04:48.640
equal to 300.

77
00:04:48.640 --> 00:04:51.470
For reasons that go beyond
the scope of this course for

78
00:04:51.470 --> 00:04:56.100
this particular problem,
we must choose the Evolutionary Solver.

79
00:04:56.100 --> 00:04:58.670
You can now click on the Solve button.

80
00:04:58.670 --> 00:05:00.510
The solution process starts, and

81
00:05:00.510 --> 00:05:04.970
search progress is shown on the status
bar at the bottom of the spreadsheet.

82
00:05:04.970 --> 00:05:07.670
The solution time depends
on the computer speed.

83
00:05:07.670 --> 00:05:09.360
So if it is taking too long,

84
00:05:09.360 --> 00:05:12.880
you can always press this
K key to stop the search.

85
00:05:12.880 --> 00:05:16.230
The Evolutionary Solver is a so
called Metaheuristic.

86
00:05:16.230 --> 00:05:19.980
What this means is that it cannot
guarantee that when it stops,

87
00:05:19.980 --> 00:05:22.470
it has found the very best solution.

88
00:05:22.470 --> 00:05:24.970
Also called the optimal solution.

89
00:05:24.970 --> 00:05:30.280
When the Solver stops, it simply reports
the best solution that it could find.

90
00:05:30.280 --> 00:05:34.030
It is states that the Solver can
not improve the current solution.

91
00:05:34.030 --> 00:05:37.410
We're going to press the Escape key and
assert the solver solution.

92
00:05:37.410 --> 00:05:39.640
Since we may end up with
different solutions,

93
00:05:39.640 --> 00:05:43.860
we're going to change the solution
that we have to one that I found, and

94
00:05:43.860 --> 00:05:46.440
that I would like to discuss with you.

95
00:05:46.440 --> 00:05:50.780
The solution has customer 103,
as the first Centroid,

96
00:05:50.780 --> 00:05:57.530
customer 112 as the second,
and customer 170 as the third.

97
00:05:57.530 --> 00:06:00.900
Let's enter those values in
the corresponding cells and

98
00:06:00.900 --> 00:06:03.070
examine the normalized centroid.

99
00:06:04.270 --> 00:06:07.720
The normalized values are very
helpful in interpreting each

100
00:06:07.720 --> 00:06:10.510
cluster because they are centered at 0.

101
00:06:10.510 --> 00:06:15.400
So negative values are below average,
and positive values are above average.

102
00:06:15.400 --> 00:06:17.680
Let's interpret the first cluster.

103
00:06:17.680 --> 00:06:21.490
The one that has customer
103 as the centroid.

104
00:06:21.490 --> 00:06:25.070
The normalized values for
this group are all negative.

105
00:06:25.070 --> 00:06:30.920
The group is about one standard deviation
below the average in all attributes.

106
00:06:30.920 --> 00:06:35.360
Perhaps these are students given that
their income is below average, they don't

107
00:06:35.360 --> 00:06:39.950
buy very frequently, and they don't
spend a lot of money when they do buy.

108
00:06:39.950 --> 00:06:43.140
Also they don't seem to have dependents.

109
00:06:43.140 --> 00:06:44.760
Moving to the second cluster,

110
00:06:44.760 --> 00:06:50.242
represented by customer 112 we see that
all the normalized values except for

111
00:06:50.242 --> 00:06:54.310
dependent at at least one standard
deviation above the average.

112
00:06:54.310 --> 00:06:59.640
This group could be one of middle aged
professionals with above average income

113
00:06:59.640 --> 00:07:02.100
and average number of dependents.

114
00:07:02.100 --> 00:07:04.390
They make frequent online purchases and

115
00:07:04.390 --> 00:07:07.930
they spend above average
in the items they buy.

116
00:07:07.930 --> 00:07:14.490
Finally, the third cluster represented by
customer 170 has an average income and

117
00:07:14.490 --> 00:07:18.490
also makes purchases with a value
that is close to the average.

118
00:07:18.490 --> 00:07:21.990
However, the number of dependents
that the members of this group

119
00:07:21.990 --> 00:07:25.910
has is almost one standard
deviation above average.

120
00:07:25.910 --> 00:07:28.890
This group could very
well represent families.

121
00:07:28.890 --> 00:07:31.900
Therefore, a reasonable
conclusion in this analysis

122
00:07:31.900 --> 00:07:36.470
is that the data seems to indicate that
the market for this online retailer

123
00:07:36.470 --> 00:07:41.880
consists of three segments the students,
families, and professionals.

124
00:07:41.880 --> 00:07:47.158
We have shown how cluster analysis can be
approached as an optimization problem.

125
00:07:47.158 --> 00:07:52.130
We have mold the problem in a way that
the search for the best set of clusters is

126
00:07:52.130 --> 00:07:58.270
equivalent to searching for the best set
of customers to represent each cluster.

127
00:07:58.270 --> 00:08:01.600
In our model a customer
that represent a cluster

128
00:08:01.600 --> 00:08:04.040
becomes the centroid of the cluster.

129
00:08:04.040 --> 00:08:08.540
To illustrate the process we use
a market segmentation example.

130
00:08:08.540 --> 00:08:13.470
This is the same example that we will use
in the next video to illustrate how to do

131
00:08:13.470 --> 00:08:15.800
cluster analysis with Excel minor.