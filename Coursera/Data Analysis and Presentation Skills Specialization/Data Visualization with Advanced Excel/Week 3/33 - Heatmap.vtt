WEBVTT

1
00:00:00.000 --> 00:00:04.650
[MUSIC]

2
00:00:04.650 --> 00:00:08.270
In problem four, we are going
to look at how to use heat maps.

3
00:00:09.340 --> 00:00:12.770
We're being asked to analyze
the average delay time for

4
00:00:12.770 --> 00:00:15.960
all the routes leaving from
Chicago's O'Hare airport.

5
00:00:17.040 --> 00:00:21.660
Your employer wants to know if there's
a correlation between average delay times

6
00:00:21.660 --> 00:00:27.600
and first, distance, and two, the time
of day that flights are departing.

7
00:00:27.600 --> 00:00:31.630
We are going to use a heat map,
as it is used as a grid table format

8
00:00:31.630 --> 00:00:35.150
to highlight issues and
potentially groupings of issues.

9
00:00:37.350 --> 00:00:40.460
Let's look at our data set
on the problem 4A data tab.

10
00:00:41.730 --> 00:00:44.670
The table shows the average delay time for

11
00:00:44.670 --> 00:00:48.490
each route by their departure time and
total distance flown.

12
00:00:49.700 --> 00:00:53.910
Our airline looks at flights
grouped by distance categories,

13
00:00:53.910 --> 00:00:55.155
which we can see in column D.

14
00:00:56.210 --> 00:01:00.820
Using this data, we'll be able to
analyze the average delay time for

15
00:01:00.820 --> 00:01:01.570
the two groupings.

16
00:01:02.570 --> 00:01:05.932
One, distance grouping,
and two, time of day,

17
00:01:05.932 --> 00:01:09.951
to see if we can identify
an underlying pattern in the data.

18
00:01:11.572 --> 00:01:14.598
To help get the data organized,
summarized, and

19
00:01:14.598 --> 00:01:20.030
into a useful form to support a heat map,
we are going to create a PivotTable.

20
00:01:20.030 --> 00:01:25.250
Select the entire data
table from cell B2 to F140.

21
00:01:28.927 --> 00:01:32.393
Click on the PivotTable in the Insert tab.

22
00:01:35.899 --> 00:01:39.035
Instead of creating a new worksheet for
the PivotTable,

23
00:01:39.035 --> 00:01:41.330
let's insert it in the problem four tab.

24
00:01:48.333 --> 00:01:54.281
Specifically, let's place
the pivot table in cell C28.

25
00:02:02.754 --> 00:02:06.979
We are going to build a PivotTable similar
to how they were built in course two.

26
00:02:08.590 --> 00:02:11.960
Let's start by clicking
on our empty PivotTable,

27
00:02:11.960 --> 00:02:14.740
which opens up our Field List
on the right side of the screen.

28
00:02:15.750 --> 00:02:21.532
If it doesn't appear, you can make it
appear by clicking on your PivotTable,

29
00:02:21.532 --> 00:02:26.353
navigating to the Analyze tab
within the Pivot tools ribbon, and

30
00:02:26.353 --> 00:02:28.210
clicking on Field List.

31
00:02:28.210 --> 00:02:31.576
Before we begin building the PivotTable,
let's step back and

32
00:02:31.576 --> 00:02:35.270
understand how we can summarize
the data table to support a heat map.

33
00:02:37.540 --> 00:02:40.285
We know that we want
the distance in rows and

34
00:02:40.285 --> 00:02:45.415
the time of day in the columns based on
how the formatted table above is laid out.

35
00:02:45.415 --> 00:02:49.050
We will build a pivot table
that mimics the setup, so

36
00:02:49.050 --> 00:02:54.187
we then can easily extract the data
from the pivot table into the heat map.

37
00:02:57.301 --> 00:02:59.586
Our data contains distance groupings,

38
00:02:59.586 --> 00:03:03.090
which we can leverage to
populate our columns.

39
00:03:03.090 --> 00:03:05.430
So let's drag the field into the row area.

40
00:03:07.030 --> 00:03:12.610
Similar to before, the heat map has
time of day groupings across the top.

41
00:03:12.610 --> 00:03:17.357
So let's select the field and drag it into
the column portion of our PivotTable.

42
00:03:20.388 --> 00:03:25.518
For the value section of our PivotTable,
we want to show the average delay time,

43
00:03:25.518 --> 00:03:30.360
to identify the intersection
that drives most of the delays.

44
00:03:30.360 --> 00:03:35.050
Therefore, let's leverage
the average delay time field and

45
00:03:35.050 --> 00:03:38.505
drag it into the value
section of our PivotTable.

46
00:03:39.980 --> 00:03:42.810
The PivotTable now looks complete.

47
00:03:42.810 --> 00:03:47.300
However, let's pause and think,
are these the correct values?

48
00:03:48.600 --> 00:03:51.040
No, they're not the correct values.

49
00:03:51.040 --> 00:03:55.738
We want the average delay time,
not the sum of the average delay time.

50
00:03:55.738 --> 00:03:59.861
We are not looking to understand
which combination of distance and

51
00:03:59.861 --> 00:04:02.290
time of day has caused the most delays,

52
00:04:02.290 --> 00:04:06.500
as this information could be skewed
by frequency of flight routes.

53
00:04:07.800 --> 00:04:12.704
To fix this in our PivotTable, we can
right-click on the value output in our

54
00:04:12.704 --> 00:04:15.702
PivotTable and
select Value Field Settings.

55
00:04:20.911 --> 00:04:25.459
In the menu that appears,
we want to select the Average within

56
00:04:25.459 --> 00:04:29.402
the summarized value field drop down,
and click OK.

57
00:04:32.195 --> 00:04:37.472
By adjusting the value field settings, the
PivotTable now calculates the average for

58
00:04:37.472 --> 00:04:40.880
each value by the distance grouping and
time grouping.

59
00:04:42.500 --> 00:04:46.240
For example,
if we look at the output in D30,

60
00:04:46.240 --> 00:04:52.318
we can see the average delay times for
flights under 500 miles in length and

61
00:04:52.318 --> 00:04:56.169
departing between 12 PM and 3 PM is 34.5.

62
00:04:58.992 --> 00:05:03.075
If we double click the combination,
a new sheet opens,

63
00:05:05.420 --> 00:05:10.627
And we can see that there are two
data points, 20 minutes and

64
00:05:10.627 --> 00:05:18.058
49 minutes for which the average is 34.5
as shown in our PivotTable, cell D30.

65
00:05:18.058 --> 00:05:21.430
We won't need this newly
created tab going forward.

66
00:05:21.430 --> 00:05:24.786
So let's right-click on the active tab and
select Delete.

67
00:05:27.259 --> 00:05:29.410
Return to our PivotTable.

68
00:05:29.410 --> 00:05:33.230
Since we want to show the correlation
between the average delay times and

69
00:05:33.230 --> 00:05:37.310
the distance and time of day,
we need to have our dimensions organized.

70
00:05:38.840 --> 00:05:43.240
Now let's begin to move our data
into the table space provided.

71
00:05:43.240 --> 00:05:47.790
The groupings for both Distance and
Time of Day are already in place for us.

72
00:05:47.790 --> 00:05:51.660
So we will want to use this key to
formulaically bring in our new data.

73
00:05:53.030 --> 00:05:57.130
We are going to leverage a formula
that we learned in course two,

74
00:05:57.130 --> 00:05:58.540
the get pivot function.

75
00:06:00.150 --> 00:06:05.449
To utilize this function,
I'm going to type = into cell E16.

76
00:06:09.822 --> 00:06:14.142
Then I'm going to look for
the corresponding matching cell in

77
00:06:14.142 --> 00:06:19.060
the PivotTable for the 6 to 9 AM and
0 to 500 miles intersection.

78
00:06:20.110 --> 00:06:23.060
In the table below,
this can be found in cell F30.

79
00:06:25.650 --> 00:06:28.860
Let's select F30 and then hit Enter.

80
00:06:28.860 --> 00:06:33.485
You see, E16 now has the proper
data from our PivotTable.

81
00:06:35.050 --> 00:06:38.090
We could continue matching
the cells with their output, but

82
00:06:38.090 --> 00:06:39.920
this would be time consuming.

83
00:06:39.920 --> 00:06:45.390
Instead, let's update the formula,
now contained in E16, so it's dynamic.

84
00:06:45.390 --> 00:06:47.490
And we can use it throughout
the rest of the table.

85
00:06:50.000 --> 00:06:55.590
If we look at the contents of E16, we see
that instead of a direct formula link,

86
00:06:55.590 --> 00:06:58.417
we have a sizable GETPIVOTDATA formula.

87
00:06:59.670 --> 00:07:04.928
Looking further, after each of our
field names, for this example,

88
00:07:04.928 --> 00:07:10.030
Distance Grouping,
we see desired match hard-coded in quotes.

89
00:07:10.030 --> 00:07:13.450
We can replace this hard-coded
value with a cell reference.

90
00:07:15.120 --> 00:07:21.453
Highlight the 0 to 500 grouping,
including the quotes, and click Delete.

91
00:07:25.011 --> 00:07:30.359
Now, we'll select the matching field 0
to 500, and lock the column reference.

92
00:07:36.679 --> 00:07:40.850
Next, we need to replace the column
reference or the time of day reference.

93
00:07:42.270 --> 00:07:46.294
Lets select the current parameter, 6-9 AM,

94
00:07:46.294 --> 00:07:49.935
in quotation marks, and delete the value.

95
00:07:49.935 --> 00:07:54.770
Now let's replace the cell reference E15,
and lock the row number.

96
00:07:56.445 --> 00:07:59.870
Now we've built a dynamic
formula with references

97
00:07:59.870 --> 00:08:03.020
that will change its relative
position within the table.

98
00:08:04.150 --> 00:08:09.638
Now to complete the graph, let's copy
the formula we just wrote in cell E16 and

99
00:08:09.638 --> 00:08:13.849
Paste Special Formula only
throughout the rest of the table.

100
00:08:24.937 --> 00:08:30.300
You can see now the table pulls
the matching data out of the PivotTable.

101
00:08:30.300 --> 00:08:33.659
If the source data changes,
it will update our PivotTable and

102
00:08:33.659 --> 00:08:36.460
then our partially built heat map.

103
00:08:36.460 --> 00:08:40.830
To finish creating our heat map, we'll
need to apply conditional formatting.

104
00:08:40.830 --> 00:08:43.835
We're going to use two color
scale on our PivotTable.

105
00:08:44.980 --> 00:08:48.350
A two color scale helps you
compare a range of cells

106
00:08:48.350 --> 00:08:51.250
by using a gradation of two colors.

107
00:08:51.250 --> 00:08:55.720
The shade of the color represents higher
or lower values within our table.

108
00:08:57.700 --> 00:09:01.687
First, select the data
in cells E16 to J22.

109
00:09:04.288 --> 00:09:10.830
Navigate to the Home tab, and click on
the Conditional Formatting drop down.

110
00:09:10.830 --> 00:09:16.060
Open up the Color Scales menu, and
select the red to white color scale.

111
00:09:17.680 --> 00:09:19.560
Now let's update our scale, so

112
00:09:19.560 --> 00:09:22.910
the higher the value,
the more red the conditional formatting.

113
00:09:24.430 --> 00:09:34.210
Go back to our Home tab >
Conditional Formatting > Manage Rules.

114
00:09:34.210 --> 00:09:39.170
Select our current conditional
formatting rule, and go to Edit Rule.

115
00:09:40.590 --> 00:09:41.860
On the left you have minimum.

116
00:09:43.000 --> 00:09:44.810
Let's change the color to white.

117
00:09:45.880 --> 00:09:48.563
On the right side we have our maximum, and

118
00:09:48.563 --> 00:09:51.792
this time,
let's change the color value to red.

119
00:09:58.560 --> 00:10:00.992
Now we've developed a heat map, but

120
00:10:00.992 --> 00:10:06.188
the cluster delays around the longer
flight routes towards the end of the day.

121
00:10:06.188 --> 00:10:12.870
Now let's do some final visual cleanup to
align with our principal, less is more.

122
00:10:12.870 --> 00:10:17.440
Since the actual numerical values
are not providing any additional value,

123
00:10:17.440 --> 00:10:18.290
let's clear them out.

124
00:10:19.380 --> 00:10:22.630
To accomplish this,
let's apply a custom numbering format.

125
00:10:23.790 --> 00:10:29.290
This is a useful trick that I'm sure
you'll be able to apply in other contexts.

126
00:10:29.290 --> 00:10:33.092
Select the data in cells E16 to J22.

127
00:10:36.230 --> 00:10:38.366
Navigate to the Home tab.

128
00:10:40.127 --> 00:10:47.668
And click on the number format dropdown,
and select More Number Formats.

129
00:10:47.668 --> 00:10:52.637
In the Number tab,
select Custom within the Category field.

130
00:10:52.637 --> 00:10:56.889
We are going to enter a custom number
format in order to make the numbers

131
00:10:56.889 --> 00:10:57.690
invisible.

132
00:10:59.290 --> 00:11:02.160
Number format codes
are the string of symbols

133
00:11:02.160 --> 00:11:06.840
that define Excel displays
the data you store in cells.

134
00:11:06.840 --> 00:11:14.630
Each number format code is made up of up
to four sections separated by a semicolon.

135
00:11:15.860 --> 00:11:20.830
These section control formatting for
one of more part of the number line

136
00:11:20.830 --> 00:11:25.671
including positive numbers,
negative numbers, and zeros.

137
00:11:27.540 --> 00:11:30.600
For our purpose,
we don't want any formatting.

138
00:11:30.600 --> 00:11:34.540
So we're going to enter quote,
closed quote.

139
00:11:34.540 --> 00:11:38.229
Essentially, this is telling
Excel that the format for

140
00:11:38.229 --> 00:11:41.769
each of the four sections
should be nothing, blank.

141
00:11:48.158 --> 00:11:49.450
Click OK.

142
00:11:50.780 --> 00:11:54.460
Now that we have the data in
the formatted table, what are we missing?

143
00:11:56.250 --> 00:11:57.980
We also need a legend.

144
00:11:57.980 --> 00:12:00.380
How else will someone be able
to interpret the heat map?

145
00:12:01.990 --> 00:12:03.600
Let's build one.

146
00:12:03.600 --> 00:12:06.691
In L18, type Legend.

147
00:12:11.354 --> 00:12:15.190
Adjust the fill color of L19 to red.

148
00:12:15.190 --> 00:12:18.333
And adjust the fill color of L20 to white.

149
00:12:25.616 --> 00:12:30.261
Add borders to cells M19 and M20.

150
00:12:30.261 --> 00:12:34.830
And then type in
Higher Average Delay Time in M19.

151
00:12:38.010 --> 00:12:43.142
And Lower Average Delay Time in M20.

152
00:12:43.142 --> 00:12:45.610
The heat map is looking good.

153
00:12:45.610 --> 00:12:49.210
However, we need to come up
with a couple of conclusions

154
00:12:49.210 --> 00:12:50.660
before going anywhere with it.

155
00:12:51.870 --> 00:12:53.940
What is the immediate takeaway?

156
00:12:53.940 --> 00:12:57.881
The strongest or
darkest red color is in J22,

157
00:12:57.881 --> 00:13:02.611
where the dimensions
are flights over 1700 miles and

158
00:13:02.611 --> 00:13:05.677
departing between 9PM and 12AM.

159
00:13:05.677 --> 00:13:08.300
Now, let's look for trends.

160
00:13:08.300 --> 00:13:11.950
It definitely appears that the left
side of the table shows more white

161
00:13:11.950 --> 00:13:13.400
than the right side,

162
00:13:13.400 --> 00:13:17.890
which we can interpret to mean that
during the early part of the day,

163
00:13:17.890 --> 00:13:22.340
average delay times are much lower
than during the later part of the day.

164
00:13:22.340 --> 00:13:24.770
How about from the least
to greatest distance?

165
00:13:26.080 --> 00:13:30.290
Not as much,
even though J22 is the darkest red,

166
00:13:30.290 --> 00:13:32.550
that doesn't hold true
throughout the entire day.

167
00:13:33.770 --> 00:13:36.090
Now that we have a couple of takeaways,

168
00:13:36.090 --> 00:13:41.100
we can let our employer know that
the time of day flights are departing

169
00:13:41.100 --> 00:13:45.380
is a better indicator of average delay
times than the distance of flights.

170
00:13:46.450 --> 00:13:53.312
Now it's your turn to practice what you
just learned in the student workbook.

171
00:13:53.312 --> 00:13:59.643
[MUSIC]