WEBVTT

1
00:00:04.430 --> 00:00:07.020
In this video, we're
going to look at

2
00:00:07.020 --> 00:00:08.940
some great additional
features for

3
00:00:08.940 --> 00:00:11.625
doing data analysis
with Power Pivot.

4
00:00:11.625 --> 00:00:14.355
These include calculated columns,

5
00:00:14.355 --> 00:00:18.430
hierarchies, and the
distinct count option.

6
00:00:18.470 --> 00:00:21.090
We're going to start by going

7
00:00:21.090 --> 00:00:23.535
back into our Power Pivot window.

8
00:00:23.535 --> 00:00:26.235
Coming to your
Power Pivot ribbon,

9
00:00:26.235 --> 00:00:28.740
can you please click "Manage",

10
00:00:28.740 --> 00:00:31.730
and if it's open in
your diagram view,

11
00:00:31.730 --> 00:00:34.595
can you flip back to Data View.

12
00:00:34.595 --> 00:00:38.360
We're going to start by
coming to our Orders table.

13
00:00:38.360 --> 00:00:40.490
At the bottom, have a look
through the tabs until

14
00:00:40.490 --> 00:00:43.380
you get to Orders, and we're
going to click on that.

15
00:00:43.380 --> 00:00:48.005
This data has not been
imported using Power Query,

16
00:00:48.005 --> 00:00:49.220
but there are still

17
00:00:49.220 --> 00:00:51.605
simple modifications
we can make to it.

18
00:00:51.605 --> 00:00:55.265
For example, if I select
the OrderDate column,

19
00:00:55.265 --> 00:00:57.205
I can't change the formatting.

20
00:00:57.205 --> 00:00:58.790
On the home ribbon,
you'll see there's

21
00:00:58.790 --> 00:01:00.440
a format option and I can

22
00:01:00.440 --> 00:01:03.475
switch that over to be just date.

23
00:01:03.475 --> 00:01:06.195
But I need something
more than that.

24
00:01:06.195 --> 00:01:07.925
I want to be able to see

25
00:01:07.925 --> 00:01:11.360
the order year right
here in the table.

26
00:01:11.360 --> 00:01:14.420
To do that, I'm going to
need a simple calculation,

27
00:01:14.420 --> 00:01:17.750
and I can do that using
a calculated column,

28
00:01:17.750 --> 00:01:19.765
much like I would do in Excel.

29
00:01:19.765 --> 00:01:21.545
Coming to the end of the table,

30
00:01:21.545 --> 00:01:24.140
you'll see an option
to add a column,

31
00:01:24.140 --> 00:01:25.790
and I'm just going to click into

32
00:01:25.790 --> 00:01:27.860
the first cell in that column,

33
00:01:27.860 --> 00:01:28.910
and I'm going to create

34
00:01:28.910 --> 00:01:30.470
a calculation like
I normally would.

35
00:01:30.470 --> 00:01:31.955
I'm going to type equals,

36
00:01:31.955 --> 00:01:35.620
and you'll see the equals
appears in your formula bar.

37
00:01:35.620 --> 00:01:38.480
Now in Excel, the
formula to extract

38
00:01:38.480 --> 00:01:40.970
the year from the date
is the year function,

39
00:01:40.970 --> 00:01:43.159
and if I start typing YEAR,

40
00:01:43.159 --> 00:01:45.260
you'll see it actually comes
up in the autocomplete,

41
00:01:45.260 --> 00:01:48.810
and if I press Tab it
complete it for me.

42
00:01:48.810 --> 00:01:50.720
It is important to note,

43
00:01:50.720 --> 00:01:53.960
however, that this is
not an Excel function.

44
00:01:53.960 --> 00:01:55.790
We do not have access to

45
00:01:55.790 --> 00:01:58.285
the regular Excel
functions in Power Pivot.

46
00:01:58.285 --> 00:02:00.320
Instead, we have access to

47
00:02:00.320 --> 00:02:03.785
a whole new suite of
calculations called DAX,

48
00:02:03.785 --> 00:02:06.140
or Data Analysis Expressions,

49
00:02:06.140 --> 00:02:07.430
and we're going to
look at these a lot

50
00:02:07.430 --> 00:02:09.430
more in later videos.

51
00:02:09.430 --> 00:02:11.420
But the good thing is that you'll

52
00:02:11.420 --> 00:02:13.430
find a lot of the DAX functions

53
00:02:13.430 --> 00:02:14.750
are very similar or even

54
00:02:14.750 --> 00:02:17.660
identical to the
Excel counterparts.

55
00:02:17.660 --> 00:02:22.510
You can see the year function
is just asking for a date,

56
00:02:22.510 --> 00:02:25.649
and I'm going to
select OrderDate,

57
00:02:25.649 --> 00:02:27.740
and that looks very similar to

58
00:02:27.740 --> 00:02:29.750
a structured reference
in the table.

59
00:02:29.750 --> 00:02:31.670
The only difference is that it's

60
00:02:31.670 --> 00:02:34.000
not just working
with a single row.

61
00:02:34.000 --> 00:02:37.595
The DAX functions are going
to apply to entire columns.

62
00:02:37.595 --> 00:02:39.870
When I press Enter,

63
00:02:39.920 --> 00:02:42.425
it has now calculated

64
00:02:42.425 --> 00:02:44.450
the order year for
every single row,

65
00:02:44.450 --> 00:02:47.400
and all I need to do is
change the column heading,

66
00:02:47.400 --> 00:02:49.235
and you can do this
by double-clicking

67
00:02:49.235 --> 00:02:51.095
or right-click "Rename",

68
00:02:51.095 --> 00:02:56.445
and I'm going to call this
Order Year and press Enter.

69
00:02:56.445 --> 00:02:59.345
If there are columns
of data missing,

70
00:02:59.345 --> 00:03:03.650
you can go and add them by
including calculated columns.

71
00:03:03.650 --> 00:03:05.180
Now in the previous video,

72
00:03:05.180 --> 00:03:06.875
we saw that Power Pivot

73
00:03:06.875 --> 00:03:09.665
automatically added
a date hierarchy,

74
00:03:09.665 --> 00:03:11.180
which is really useful.

75
00:03:11.180 --> 00:03:14.255
What about if we want to
create our own hierarchies?

76
00:03:14.255 --> 00:03:15.915
Well, we can do that too.

77
00:03:15.915 --> 00:03:19.095
To do this, we're going to
come back to our Diagram View,

78
00:03:19.095 --> 00:03:22.750
so on the home ribbon we're
selecting Diagram View,

79
00:03:23.120 --> 00:03:27.830
and we want to add the hierarchy
to our customer table,

80
00:03:27.830 --> 00:03:30.350
and if you have a look at
the top right-hand corner

81
00:03:30.350 --> 00:03:32.585
you'll see an option to maximize.

82
00:03:32.585 --> 00:03:34.280
We're going to click
on that so we can

83
00:03:34.280 --> 00:03:36.265
see all the fields more easily,

84
00:03:36.265 --> 00:03:39.020
and just next to that maximize

85
00:03:39.020 --> 00:03:41.735
field is the Create
Hierarchy option,

86
00:03:41.735 --> 00:03:43.670
and we're going to
click on that as well.

87
00:03:43.670 --> 00:03:45.485
It's out of the hierarchy.

88
00:03:45.485 --> 00:03:46.880
We need to give a sensible name.

89
00:03:46.880 --> 00:03:50.005
I'm just going to call
this Geo and press Enter,

90
00:03:50.005 --> 00:03:52.260
and all I need to do now is drag

91
00:03:52.260 --> 00:03:54.590
the fields down
into the hierarchy.

92
00:03:54.590 --> 00:03:56.480
I'm going to start with Country.

93
00:03:56.480 --> 00:03:59.150
I'm going to click and
drag and basically drop

94
00:03:59.150 --> 00:04:01.520
it on the name of hierarchies.

95
00:04:01.520 --> 00:04:03.805
I just do that with
the first one,

96
00:04:03.805 --> 00:04:06.090
and now I've got Country.

97
00:04:06.090 --> 00:04:08.160
Next is State, and
I'm going to click

98
00:04:08.160 --> 00:04:10.185
and drag but now be careful.

99
00:04:10.185 --> 00:04:13.260
You want to try drop it
literally just blow Country.

100
00:04:13.260 --> 00:04:14.580
If you go too low,

101
00:04:14.580 --> 00:04:15.710
can you see that black line going

102
00:04:15.710 --> 00:04:17.470
before where I cross the window?

103
00:04:17.470 --> 00:04:19.065
That means it's
not going to work.

104
00:04:19.065 --> 00:04:22.130
Just pull it up a little bit
so that the black line stops

105
00:04:22.130 --> 00:04:23.750
about half a centimeter short

106
00:04:23.750 --> 00:04:26.255
of the edge of the
window, and now release.

107
00:04:26.255 --> 00:04:28.970
There's my State and
the same with city,

108
00:04:28.970 --> 00:04:31.805
just drop that underneath state,

109
00:04:31.805 --> 00:04:34.440
and I've created my hierarchy.

110
00:04:34.440 --> 00:04:36.620
To minimize this window again,

111
00:04:36.620 --> 00:04:39.125
you just click back on the
top right-hand corner,

112
00:04:39.125 --> 00:04:41.330
and now we're going
to press Alt tab to

113
00:04:41.330 --> 00:04:43.795
go back into our Excel workbook,

114
00:04:43.795 --> 00:04:46.685
and would like to
create an analysis

115
00:04:46.685 --> 00:04:50.030
to show the total
revenue by region.

116
00:04:50.030 --> 00:04:54.275
I'm going to come to
Insert, PivotTable,

117
00:04:54.275 --> 00:04:57.770
click "Okay", and now

118
00:04:57.770 --> 00:05:00.080
I'm going to start
by coming to Orders,

119
00:05:00.080 --> 00:05:02.330
and I'm going to add the subtotal

120
00:05:02.330 --> 00:05:04.825
because the total
includes freight,

121
00:05:04.825 --> 00:05:06.670
so I'm going to select subtotal,

122
00:05:06.670 --> 00:05:08.480
and of course it's added it up,

123
00:05:08.480 --> 00:05:10.714
and now coming up to customer,

124
00:05:10.714 --> 00:05:13.685
you'll see my new hierarchy
is being added at the top,

125
00:05:13.685 --> 00:05:15.825
and if I select it,

126
00:05:15.825 --> 00:05:20.440
I can see that next to each
country is a little plus,

127
00:05:20.440 --> 00:05:23.275
which will allow me to
expand or collapse.

128
00:05:23.275 --> 00:05:26.985
If you come up to your
PivotTable Analyze ribbon.

129
00:05:26.985 --> 00:05:29.230
In the Active Field group,

130
00:05:29.230 --> 00:05:32.525
you will see there's an option
to expand all the fields.

131
00:05:32.525 --> 00:05:33.910
If I click on that plus,

132
00:05:33.910 --> 00:05:35.680
it actually expands
all the countries,

133
00:05:35.680 --> 00:05:36.840
and if I click on the minus,

134
00:05:36.840 --> 00:05:38.290
it collapses all of them,

135
00:05:38.290 --> 00:05:40.480
and look those features
aren't very new,

136
00:05:40.480 --> 00:05:42.700
but they are useful
with our hierarchies.

137
00:05:42.700 --> 00:05:46.280
What is new is the
Drill Down option.

138
00:05:46.280 --> 00:05:48.040
If you clicked on one of

139
00:05:48.040 --> 00:05:50.275
the countries and you
select Drill Down,

140
00:05:50.275 --> 00:05:52.000
it actually drills
down to show you

141
00:05:52.000 --> 00:05:53.710
all the states for that country,

142
00:05:53.710 --> 00:05:55.615
and now if I click
Drill Down again,

143
00:05:55.615 --> 00:05:58.855
I'm seeing all the cities
within that state.

144
00:05:58.855 --> 00:06:01.240
I can then either drill backup to

145
00:06:01.240 --> 00:06:03.235
state or if I click the dropdown,

146
00:06:03.235 --> 00:06:06.490
I get the option to drill all
the way back up to country.

147
00:06:06.490 --> 00:06:09.040
Really handy feature to allow you

148
00:06:09.040 --> 00:06:11.710
to drill down in
your data analysis.

149
00:06:11.710 --> 00:06:14.035
Now taking this one step further,

150
00:06:14.035 --> 00:06:15.775
I'd actually like to know

151
00:06:15.775 --> 00:06:21.260
how many customers made a
purchase in each country.

152
00:06:21.260 --> 00:06:24.830
Now if I grab CustomerID

153
00:06:24.830 --> 00:06:26.500
and drag it and drop it into

154
00:06:26.500 --> 00:06:28.390
the values quadrant
because it's numeric,

155
00:06:28.390 --> 00:06:30.925
it's going to add it up, which
is obviously not correct.

156
00:06:30.925 --> 00:06:33.670
I'm going to click the
dropdown next to CustomerID,

157
00:06:33.670 --> 00:06:37.760
and I'm going to select
Value Field Settings.

158
00:06:38.280 --> 00:06:41.395
Now the counter's
been there forever,

159
00:06:41.395 --> 00:06:43.730
but the problem with the
count is it's going to

160
00:06:43.730 --> 00:06:46.760
tell me how many
orders were placed,

161
00:06:46.760 --> 00:06:48.980
and it's quite likely that

162
00:06:48.980 --> 00:06:51.815
some customers placed
more than one order.

163
00:06:51.815 --> 00:06:54.845
That's not going to tell me
how many customers I have.

164
00:06:54.845 --> 00:06:57.170
What I want is a way of counting

165
00:06:57.170 --> 00:06:59.840
how many unique customer IDs

166
00:06:59.840 --> 00:07:02.225
there are or distinct
if you prefer.

167
00:07:02.225 --> 00:07:04.010
If you scroll down in

168
00:07:04.010 --> 00:07:06.920
your Value Field
Settings, in Power Pivot,

169
00:07:06.920 --> 00:07:09.080
we have a brand new
calculation option

170
00:07:09.080 --> 00:07:10.955
called Distinct Count,

171
00:07:10.955 --> 00:07:13.505
and this will give us
exactly what we want.

172
00:07:13.505 --> 00:07:17.280
I'm going to select Distinct
Count and say Okay,

173
00:07:17.280 --> 00:07:18.950
and that tells me how

174
00:07:18.950 --> 00:07:21.350
many unique instances of

175
00:07:21.350 --> 00:07:24.410
the CustomerID it found
for each country.

176
00:07:24.410 --> 00:07:26.915
One more bonus little feature.

177
00:07:26.915 --> 00:07:28.910
Let's change this
up a little bit.

178
00:07:28.910 --> 00:07:32.960
Let's work out the percentage
revenue for each region.

179
00:07:32.960 --> 00:07:35.465
I'm going right-click
on my SubTotal,

180
00:07:35.465 --> 00:07:37.880
and I'm going to come
to Show Values As and

181
00:07:37.880 --> 00:07:40.720
choose Percentage
of Column Total.

182
00:07:40.720 --> 00:07:42.890
That's telling me
that the US made

183
00:07:42.890 --> 00:07:47.075
up over 58 percent of my revenue.

184
00:07:47.075 --> 00:07:51.805
But let's say I'm the manager
for the UK and Europe,

185
00:07:51.805 --> 00:07:55.085
so I only want to focus
on those regions.

186
00:07:55.085 --> 00:07:58.400
I'm going to come to my Row
Labels, click the dropdown,

187
00:07:58.400 --> 00:08:00.860
and I'm going to
unselect Australia,

188
00:08:00.860 --> 00:08:04.345
Canada, and the US.

189
00:08:04.345 --> 00:08:06.805
But when I click "Okay",

190
00:08:06.805 --> 00:08:09.020
you'll see it has recalculated

191
00:08:09.020 --> 00:08:11.570
my percentages
because by default,

192
00:08:11.570 --> 00:08:15.410
the subtotals in PivotTables
only show the visible cells,

193
00:08:15.410 --> 00:08:18.265
they do not include
the filtered values.

194
00:08:18.265 --> 00:08:19.695
But here again,

195
00:08:19.695 --> 00:08:22.635
Power Pivot gives us
something additional.

196
00:08:22.635 --> 00:08:25.145
If you come to your
Design ribbon,

197
00:08:25.145 --> 00:08:27.005
PivotTable tools design,

198
00:08:27.005 --> 00:08:30.140
and come to your Subtotals,

199
00:08:30.140 --> 00:08:32.570
we now have the option to

200
00:08:32.570 --> 00:08:35.690
include filtered items in totals.

201
00:08:35.690 --> 00:08:38.325
In normal pivots,
this is grayed out.

202
00:08:38.325 --> 00:08:39.860
But when I select that,

203
00:08:39.860 --> 00:08:42.935
I'm now seeing the
actual percentages

204
00:08:42.935 --> 00:08:45.500
for each of my regions
and let's put a little s

205
00:08:45.500 --> 00:08:48.470
next to my Grand Total
so that I can see that

206
00:08:48.470 --> 00:08:51.650
the total here includes
filtered items.

207
00:08:51.650 --> 00:08:54.520
I'm not saying all the values
that make up that total.

208
00:08:54.520 --> 00:08:56.540
Probably in this particular case,

209
00:08:56.540 --> 00:08:59.575
I come to Grand Totals
and just turn it off.

210
00:08:59.575 --> 00:09:01.970
We've seen some great features

211
00:09:01.970 --> 00:09:04.400
there for helping with
our data analysis,

212
00:09:04.400 --> 00:09:06.635
we've created calculated columns,

213
00:09:06.635 --> 00:09:09.620
hierarchies, used
the Distinct Count,

214
00:09:09.620 --> 00:09:11.810
and even looked at
how we can include

215
00:09:11.810 --> 00:09:14.105
filtered items in our subtotals.

216
00:09:14.105 --> 00:09:15.980
But we're only just
getting started.

217
00:09:15.980 --> 00:09:18.005
In the next video,
we're going to look

218
00:09:18.005 --> 00:09:19.940
at some exciting
opportunities for

219
00:09:19.940 --> 00:09:25.050
visualizing data using Power
Pivot, so keep watching.