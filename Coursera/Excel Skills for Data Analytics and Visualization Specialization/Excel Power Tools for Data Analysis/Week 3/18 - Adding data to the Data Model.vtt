WEBVTT

1
00:00:04.850 --> 00:00:08.070
Welcome back, in this video,

2
00:00:08.070 --> 00:00:10.980
we're going to introduce
Power Pivot and look at

3
00:00:10.980 --> 00:00:14.670
how we can get data into
the Power Pivot data model.

4
00:00:14.670 --> 00:00:16.905
What is Power Pivot?

5
00:00:16.905 --> 00:00:18.810
Power Pivot is an Excel

6
00:00:18.810 --> 00:00:21.465
add-in that allows us
to manage millions

7
00:00:21.465 --> 00:00:23.190
of rows of data and

8
00:00:23.190 --> 00:00:25.980
perform powerful data
analysis on that data.

9
00:00:25.980 --> 00:00:28.440
In the workbook I
currently have open,

10
00:00:28.440 --> 00:00:31.800
there are actually 5
million sales records.

11
00:00:31.800 --> 00:00:33.660
We can't see them
because I haven't put

12
00:00:33.660 --> 00:00:35.475
them in the worksheet
as they wouldn't fit.

13
00:00:35.475 --> 00:00:38.355
Instead, I've loaded them
into the data model.

14
00:00:38.355 --> 00:00:40.610
To access the data
model, however,

15
00:00:40.610 --> 00:00:44.520
we're going to need to enable
the Power Pivot add-in.

16
00:00:44.750 --> 00:00:48.405
We're going to come
to our file ribbon

17
00:00:48.405 --> 00:00:51.670
and we're going to
come down to Options,

18
00:00:51.680 --> 00:00:54.735
we're going to select Add-ins,

19
00:00:54.735 --> 00:00:56.400
and then at the
bottom where it says,

20
00:00:56.400 --> 00:00:58.265
Manage, we're going to choose

21
00:00:58.265 --> 00:01:02.020
COM Add-ins and then click, "Go".

22
00:01:02.020 --> 00:01:03.740
Make sure you've selected

23
00:01:03.740 --> 00:01:05.345
the Microsoft Power Pivot for

24
00:01:05.345 --> 00:01:08.165
Excel add-in and click, "Okay."

25
00:01:08.165 --> 00:01:09.830
If you have a look
in your ribbon,

26
00:01:09.830 --> 00:01:11.435
you will see a new tab called

27
00:01:11.435 --> 00:01:14.480
Power Pivot and when
you click on that,

28
00:01:14.480 --> 00:01:17.465
you get the option to
manage your data model,

29
00:01:17.465 --> 00:01:20.190
so we're going to
click on that button

30
00:01:20.570 --> 00:01:24.330
and now I can see my 5
million sales records.

31
00:01:24.330 --> 00:01:26.405
If you have a peek at the
bottom of the screen,

32
00:01:26.405 --> 00:01:28.415
it says 1 of 5 million.

33
00:01:28.415 --> 00:01:32.240
Now I can't edit the
data in Power Pivot,

34
00:01:32.240 --> 00:01:34.535
but I can sort it, filter it,

35
00:01:34.535 --> 00:01:38.710
and more importantly, create
pivot table reports from it.

36
00:01:38.710 --> 00:01:42.280
Something interesting
to note as well,

37
00:01:43.130 --> 00:01:45.440
if we have a look at

38
00:01:45.440 --> 00:01:48.305
the original CSV where I
loaded this data from,

39
00:01:48.305 --> 00:01:50.510
it was over 600 meg,

40
00:01:50.510 --> 00:01:54.405
but the Excel file
is only 140 megs,

41
00:01:54.405 --> 00:01:56.345
so Power Pivot also gives us

42
00:01:56.345 --> 00:01:59.460
some powerful data compression.

43
00:01:59.690 --> 00:02:02.450
But how do we get the data into

44
00:02:02.450 --> 00:02:04.370
Power Pivot in the first place?

45
00:02:04.370 --> 00:02:06.485
Well, that's what we're
going to look at next.

46
00:02:06.485 --> 00:02:07.940
I'm actually going to close up

47
00:02:07.940 --> 00:02:10.400
my Power Pivot window
and I'm going to close

48
00:02:10.400 --> 00:02:12.030
my 5 million sales records

49
00:02:12.030 --> 00:02:15.605
file and can you make
sure you've got 331,

50
00:02:15.605 --> 00:02:18.550
Adding Data to the
Data Model open.

51
00:02:18.550 --> 00:02:20.990
This week we've been asked to do

52
00:02:20.990 --> 00:02:24.875
some data analysis for a
company called AdventureWorks.

53
00:02:24.875 --> 00:02:26.840
They're a bicycle retailer,

54
00:02:26.840 --> 00:02:28.070
so they sell bicycles,

55
00:02:28.070 --> 00:02:31.875
components, and accessories
to stores all over the world.

56
00:02:31.875 --> 00:02:35.525
The actual data is from
a Microsoft database,

57
00:02:35.525 --> 00:02:38.780
and it comes in lots of
different tables and we

58
00:02:38.780 --> 00:02:42.140
need to now load those
tables into our data model.

59
00:02:42.140 --> 00:02:45.950
The very first one that we
want to load is our HR data,

60
00:02:45.950 --> 00:02:49.360
which is currently sitting
in an Excel spreadsheet.

61
00:02:49.360 --> 00:02:51.140
How do we get that data from

62
00:02:51.140 --> 00:02:53.090
the spreadsheet into
the data model?

63
00:02:53.090 --> 00:02:55.145
Well, we already know one way,

64
00:02:55.145 --> 00:02:57.755
it's our old friend, Power Query.

65
00:02:57.755 --> 00:03:00.455
Power Query is an ideal choice

66
00:03:00.455 --> 00:03:03.830
if you need to do
transformations on the data.

67
00:03:03.830 --> 00:03:05.480
But let's see how we use it

68
00:03:05.480 --> 00:03:07.100
to get it into the data model.

69
00:03:07.100 --> 00:03:09.755
We're going to come
to our data tab,

70
00:03:09.755 --> 00:03:10.700
and we are going to click,

71
00:03:10.700 --> 00:03:12.290
"New Query" or "GetData",

72
00:03:12.290 --> 00:03:16.880
depending on your version,
from file, and from workbook.

73
00:03:16.880 --> 00:03:19.670
Please navigate to
where you downloaded

74
00:03:19.670 --> 00:03:21.770
your files and we're

75
00:03:21.770 --> 00:03:23.660
looking for the HR data

76
00:03:23.660 --> 00:03:27.330
file and we're going to
double-click to open that.

77
00:03:30.200 --> 00:03:34.160
The data we want is in
the lookup staff tables,

78
00:03:34.160 --> 00:03:35.510
so I'm going to select that.

79
00:03:35.510 --> 00:03:38.540
There's our preview and now
we would typically click

80
00:03:38.540 --> 00:03:41.870
the "Transform Data" button
because we use Power Query,

81
00:03:41.870 --> 00:03:44.615
in this case, to actually
make the transformations.

82
00:03:44.615 --> 00:03:46.130
You guys know how
to do that though,

83
00:03:46.130 --> 00:03:47.465
so we're going to skip that step.

84
00:03:47.465 --> 00:03:49.190
I'm going to click
the dropdown next to

85
00:03:49.190 --> 00:03:51.075
Load, and I'm going to choose,

86
00:03:51.075 --> 00:03:55.290
Load to and here's
the magic button,

87
00:03:55.290 --> 00:03:57.745
"Add this data to
the data model."

88
00:03:57.745 --> 00:04:00.950
We're going to select that
and choose only create

89
00:04:00.950 --> 00:04:03.170
connection because
we only want in

90
00:04:03.170 --> 00:04:06.930
the data model and then we're
going to click, "Okay."

91
00:04:08.270 --> 00:04:10.840
Power Query has created

92
00:04:10.840 --> 00:04:12.640
a connection and loaded

93
00:04:12.640 --> 00:04:14.755
the data to the
data model for us,

94
00:04:14.755 --> 00:04:18.055
but what if we don't
need to use Power Query?

95
00:04:18.055 --> 00:04:21.640
For example, in the next
tab, the products tab,

96
00:04:21.640 --> 00:04:23.200
I have my data sitting right

97
00:04:23.200 --> 00:04:25.480
here and it doesn't
need to be transformed,

98
00:04:25.480 --> 00:04:27.835
I just want to put it
straight into the data model.

99
00:04:27.835 --> 00:04:29.525
Well, I can do that too.

100
00:04:29.525 --> 00:04:31.605
We're going to click
into the data,

101
00:04:31.605 --> 00:04:34.110
we're going to come to our
Power Pivot ribbon this

102
00:04:34.110 --> 00:04:36.390
time and we're just
going to select,

103
00:04:36.390 --> 00:04:38.265
"Add to Data Model."

104
00:04:38.265 --> 00:04:40.630
This is the best way
of getting data from

105
00:04:40.630 --> 00:04:43.405
Excel directly into your model.

106
00:04:43.405 --> 00:04:47.095
If you have a look at the
bottom of the screen,

107
00:04:47.095 --> 00:04:48.940
you'll see we have four tabs,

108
00:04:48.940 --> 00:04:50.505
one for each dataset,

109
00:04:50.505 --> 00:04:51.850
so here's our products,

110
00:04:51.850 --> 00:04:54.220
there's the stuff that
we loaded a moment ago,

111
00:04:54.220 --> 00:04:57.020
and actually there were two
datasets already there,

112
00:04:57.020 --> 00:04:59.750
all of the orders that
had been placed from

113
00:04:59.750 --> 00:05:02.900
2018-2020 and each of

114
00:05:02.900 --> 00:05:06.200
the items are ordered with
each of those orders,

115
00:05:06.200 --> 00:05:07.820
so this is the data
we're going to

116
00:05:07.820 --> 00:05:09.875
use to do our analysis.

117
00:05:09.875 --> 00:05:13.090
But there's two more
tables we need.

118
00:05:13.090 --> 00:05:15.705
The first one is
our customer data.

119
00:05:15.705 --> 00:05:17.040
Now, this is actually sitting in

120
00:05:17.040 --> 00:05:19.550
a database and one of the
fantastic things about

121
00:05:19.550 --> 00:05:21.380
Power Pivot is it allows us to

122
00:05:21.380 --> 00:05:23.810
connect directly to the database,

123
00:05:23.810 --> 00:05:25.475
which is much more efficient

124
00:05:25.475 --> 00:05:27.880
than downloading and uploading.

125
00:05:27.880 --> 00:05:31.285
Coming on to our home
ribbon in Power Pivot,

126
00:05:31.285 --> 00:05:33.650
we're going to come
to the From Database

127
00:05:33.650 --> 00:05:37.020
and we're going to
select From Access.

128
00:05:37.790 --> 00:05:40.660
Now we're going to browse
to find our database,

129
00:05:40.660 --> 00:05:43.220
so I'm going to select the
"Browse" button back to

130
00:05:43.220 --> 00:05:46.040
your download folder
and there's my CRM,

131
00:05:46.040 --> 00:05:47.840
my Customer Database,
I'm just going to

132
00:05:47.840 --> 00:05:51.145
double-click to select that
and then click, "Next".

133
00:05:51.145 --> 00:05:53.450
Now when you're pulling
data from a database,

134
00:05:53.450 --> 00:05:56.240
you actually have the
option to get the data from

135
00:05:56.240 --> 00:05:58.430
a query and that's
a great idea if you

136
00:05:58.430 --> 00:06:00.965
actually need a
subset of the data.

137
00:06:00.965 --> 00:06:03.110
We're going to get it directly
from the table though,

138
00:06:03.110 --> 00:06:05.065
so we're just going
to click "Next",

139
00:06:05.065 --> 00:06:07.750
there's only one table so
I'll look up customers,

140
00:06:07.750 --> 00:06:09.050
so just make sure that's ticked

141
00:06:09.050 --> 00:06:11.590
and we're going to
click, "Finish".

142
00:06:11.590 --> 00:06:13.940
This is a security
warning because

143
00:06:13.940 --> 00:06:15.815
we are pulling data from
an external source,

144
00:06:15.815 --> 00:06:17.270
that's fine, we're
going to click,

145
00:06:17.270 --> 00:06:20.480
"Okay" and close as

146
00:06:20.480 --> 00:06:24.490
our data has now been
imported into our data model.

147
00:06:24.490 --> 00:06:28.865
The last table we need
is a calendar table,

148
00:06:28.865 --> 00:06:30.320
this is going to give us date

149
00:06:30.320 --> 00:06:33.380
information and it's going
to make it easier for us

150
00:06:33.380 --> 00:06:35.825
to do the Time
Intelligence Analysis

151
00:06:35.825 --> 00:06:38.660
that we're going to look
at later on this week.

152
00:06:38.660 --> 00:06:43.115
If you already have a calendar
table, you can import it,

153
00:06:43.115 --> 00:06:45.725
but the brilliant thing
about Power Pivot is it will

154
00:06:45.725 --> 00:06:48.725
actually supply you
with a calendar.

155
00:06:48.725 --> 00:06:50.330
To do this, we're
going to come to

156
00:06:50.330 --> 00:06:53.030
our Design tab and

157
00:06:53.030 --> 00:06:55.780
on the right-hand side
you'll see Data Table.

158
00:06:55.780 --> 00:06:58.105
Going to click the
drop-down and select

159
00:06:58.105 --> 00:07:03.925
"New" and how easy was that?

160
00:07:03.925 --> 00:07:06.190
There's our calendar table.

161
00:07:06.190 --> 00:07:08.920
We're going to close
our Power Pivot window

162
00:07:08.920 --> 00:07:09.880
for a moment so I'm just going

163
00:07:09.880 --> 00:07:10.960
to click the little cross at

164
00:07:10.960 --> 00:07:13.960
the top right-hand corner and
back in Excel you'll see we

165
00:07:13.960 --> 00:07:17.350
just have the one query that
we created with Power Query.

166
00:07:17.350 --> 00:07:19.585
But if I click on "Connections",

167
00:07:19.585 --> 00:07:23.860
there are the six connections
to my Power Pivot tables.

168
00:07:23.860 --> 00:07:26.455
We've seen quite
a few methods for

169
00:07:26.455 --> 00:07:28.930
adding data into our data model,

170
00:07:28.930 --> 00:07:31.840
we're not quite finished
with the model yet though,

171
00:07:31.840 --> 00:07:34.570
we still need to add those
relationships between

172
00:07:34.570 --> 00:07:36.860
the datasets and that's exactly

173
00:07:36.860 --> 00:07:40.380
what we're going to look
at in the next video.