WEBVTT

1
00:00:04.430 --> 00:00:07.545
In this video, we're
going to look at

2
00:00:07.545 --> 00:00:11.175
options for visualizing
data using Power Pivot.

3
00:00:11.175 --> 00:00:13.770
I'm in my Sales by year Tab,

4
00:00:13.770 --> 00:00:16.635
and I'd like to show
this data graphically.

5
00:00:16.635 --> 00:00:18.720
In Power Pivot, we can use

6
00:00:18.720 --> 00:00:21.810
pivot charts just like we
can with normal pivot.

7
00:00:21.810 --> 00:00:26.160
Clicking at data, come up to
a PivotTable Analyze ribbon.

8
00:00:26.160 --> 00:00:28.185
We're going to select PivotChart.

9
00:00:28.185 --> 00:00:30.390
I'm just going to click OK,

10
00:00:30.390 --> 00:00:32.625
and that looks terrific.

11
00:00:32.625 --> 00:00:35.585
But one of the limitations
we've seen with

12
00:00:35.585 --> 00:00:37.730
pivot charts is that there are

13
00:00:37.730 --> 00:00:40.020
several chart types
that we can't use.

14
00:00:40.020 --> 00:00:42.470
For example, we can't
use scatter charts or

15
00:00:42.470 --> 00:00:46.090
neither new ones like hierarchy
charts and map charts.

16
00:00:46.090 --> 00:00:48.590
What we're going to see next is

17
00:00:48.590 --> 00:00:51.590
a fabulous workaround that
we get from Power Pivot.

18
00:00:51.590 --> 00:00:55.660
We're going to come to our
Product by Category tab,

19
00:00:55.660 --> 00:00:57.770
and we're going to build
another pivot table.

20
00:00:57.770 --> 00:01:00.560
This time we want to see
how many products were

21
00:01:00.560 --> 00:01:03.895
sold by category and subcategory,

22
00:01:03.895 --> 00:01:05.420
and then we want to
be able to filter

23
00:01:05.420 --> 00:01:07.520
that by country and year.

24
00:01:07.520 --> 00:01:10.565
I'm going to click
Insert, PivotTable,

25
00:01:10.565 --> 00:01:15.420
and OK, and then
in my field list,

26
00:01:15.420 --> 00:01:20.050
under Order Items, I'm
going to select quantity,

27
00:01:20.060 --> 00:01:23.465
and under products,
I'm going to select

28
00:01:23.465 --> 00:01:26.780
Category and Sub Category.

29
00:01:26.780 --> 00:01:28.580
I'm going to make
a couple of little

30
00:01:28.580 --> 00:01:30.140
changes to this pivot.

31
00:01:30.140 --> 00:01:32.395
Coming up to my Design ribbon,

32
00:01:32.395 --> 00:01:35.100
we're going to come
to Report Layout,

33
00:01:35.100 --> 00:01:37.980
and I'm going to change
this to tabular form,

34
00:01:37.980 --> 00:01:39.860
and then in my grand totals,

35
00:01:39.860 --> 00:01:41.090
I'm going to actually switch them

36
00:01:41.090 --> 00:01:43.360
off for rows and columns.

37
00:01:43.360 --> 00:01:45.560
Now the next thing I want
to be able to do is to

38
00:01:45.560 --> 00:01:47.540
actually slice this data to

39
00:01:47.540 --> 00:01:51.655
see it by a combination
of country and year.

40
00:01:51.655 --> 00:01:54.375
To do this, I'm going to
add a couple of slices.

41
00:01:54.375 --> 00:01:56.835
Back on my PivotTable Analyze,

42
00:01:56.835 --> 00:01:59.865
we're going to choose
Insert Slicer,

43
00:01:59.865 --> 00:02:01.840
and by default we're seeing

44
00:02:01.840 --> 00:02:04.955
all the tables that are
in the pivot table.

45
00:02:04.955 --> 00:02:08.630
But if you click the
All tab in Power Pivot,

46
00:02:08.630 --> 00:02:10.355
you can add a slice of them from

47
00:02:10.355 --> 00:02:13.660
absolutely any table
in the data Model.

48
00:02:13.660 --> 00:02:16.475
The first one we want is country,

49
00:02:16.475 --> 00:02:18.320
and I also want a year,

50
00:02:18.320 --> 00:02:20.360
but if you use the
one in the calendar,

51
00:02:20.360 --> 00:02:23.230
we're going to get all
the years from 1961.

52
00:02:23.230 --> 00:02:27.625
We're actually going to scroll
down to our order's table,

53
00:02:27.625 --> 00:02:31.415
and here's that calculated
column we created earlier.

54
00:02:31.415 --> 00:02:34.960
We're going to select
Order Year and say OK.

55
00:02:34.960 --> 00:02:36.810
There are two slices.

56
00:02:36.810 --> 00:02:38.995
I'm going to hold shift
down, select country,

57
00:02:38.995 --> 00:02:40.330
and then I can resize them

58
00:02:40.330 --> 00:02:43.365
both to a better width
at the same time,

59
00:02:43.365 --> 00:02:45.960
and then I'm going
to grab Order Year,

60
00:02:45.960 --> 00:02:47.580
pull that up above,

61
00:02:47.580 --> 00:02:51.010
country, resize slightly and

62
00:02:51.010 --> 00:02:53.440
just make sure you can see
both nice and clearly.

63
00:02:53.440 --> 00:02:57.310
Now if I only wanted to see
sales for Canada in 2018,

64
00:02:57.310 --> 00:02:58.885
I can select Canada,

65
00:02:58.885 --> 00:03:01.110
I can select 2018,

66
00:03:01.110 --> 00:03:04.110
and my data's nicely filtered.

67
00:03:04.110 --> 00:03:06.505
This is one of the
things we love about

68
00:03:06.505 --> 00:03:09.385
pivot tables is that we
get that interactivity,

69
00:03:09.385 --> 00:03:10.600
where we can slice and dice

70
00:03:10.600 --> 00:03:12.605
the data to see the
way we want it.

71
00:03:12.605 --> 00:03:14.185
To remove those filters,

72
00:03:14.185 --> 00:03:17.630
just click the clear filter
at the top of the slicer.

73
00:03:17.630 --> 00:03:21.605
But I now want to show this
data in a hierarchy chart,

74
00:03:21.605 --> 00:03:24.905
and pivot charts simply
don't support that.

75
00:03:24.905 --> 00:03:27.365
Now if we're working
in normal Excel,

76
00:03:27.365 --> 00:03:29.345
what I might decide to do is use

77
00:03:29.345 --> 00:03:32.585
a SUMIFS calculation,
for example.

78
00:03:32.585 --> 00:03:34.670
But one of the things we need to

79
00:03:34.670 --> 00:03:36.320
understand about
the data model is

80
00:03:36.320 --> 00:03:39.530
we cannot access it using
regular Excel functions.

81
00:03:39.530 --> 00:03:41.300
In fact, the only
way we've seen of

82
00:03:41.300 --> 00:03:44.135
accessing it up to now
is by a pivot table.

83
00:03:44.135 --> 00:03:46.120
But there is another method.

84
00:03:46.120 --> 00:03:48.885
It's called a cube function.

85
00:03:48.885 --> 00:03:51.560
Cube functions were
actually introduced in

86
00:03:51.560 --> 00:03:55.495
2007 to allow us to
access OLAP cubes.

87
00:03:55.495 --> 00:03:58.130
They pre-date the data model,

88
00:03:58.130 --> 00:04:00.220
but they've actually been
repurposed, if you like.

89
00:04:00.220 --> 00:04:02.210
We can now use cube functions

90
00:04:02.210 --> 00:04:05.345
to access the data
model directly.

91
00:04:05.345 --> 00:04:10.125
If you come down to F22,

92
00:04:10.125 --> 00:04:12.760
we're going to type equals cub,

93
00:04:12.760 --> 00:04:14.510
you'll see there are actually

94
00:04:14.510 --> 00:04:16.520
seven cube functions in Excel,

95
00:04:16.520 --> 00:04:18.545
but we're just going to
look at one for now,

96
00:04:18.545 --> 00:04:20.600
and that is CUBEVALUE,

97
00:04:20.600 --> 00:04:22.855
so ev and tab.

98
00:04:22.855 --> 00:04:27.265
CUBEVALUE allows you to get
a value from the data model.

99
00:04:27.265 --> 00:04:29.690
In this case, I
would like to find

100
00:04:29.690 --> 00:04:33.185
out how many vests
have been ordered.

101
00:04:33.185 --> 00:04:36.260
The first thing I need to
provide is a connection.

102
00:04:36.260 --> 00:04:37.380
This is really easy.

103
00:04:37.380 --> 00:04:38.945
If you type the double quotes,

104
00:04:38.945 --> 00:04:40.355
it gives you one option,

105
00:04:40.355 --> 00:04:43.415
ThisWorkBookDataModel, and
that's exactly what we want.

106
00:04:43.415 --> 00:04:47.165
Just press tab, close the
double-quotes and type a comma.

107
00:04:47.165 --> 00:04:49.730
The next thing we need
to tell it is that

108
00:04:49.730 --> 00:04:52.115
we want to add up
our order quantity.

109
00:04:52.115 --> 00:04:54.140
Now there are a couple
of ways of doing this,

110
00:04:54.140 --> 00:04:56.900
but the easiest way
is using a measure.

111
00:04:56.900 --> 00:04:59.260
We haven't really talked
about measures yet.

112
00:04:59.260 --> 00:05:00.950
That's coming in the next video.

113
00:05:00.950 --> 00:05:04.160
But for now, I'll just
explain that a measure is

114
00:05:04.160 --> 00:05:08.570
basically an aggregation of
some data within the model.

115
00:05:08.570 --> 00:05:10.310
In this case, the
data we're trying to

116
00:05:10.310 --> 00:05:12.770
aggregate is our order quantity.

117
00:05:12.770 --> 00:05:15.185
We're going to open
up double quotes,

118
00:05:15.185 --> 00:05:17.660
we're going to select Measures,

119
00:05:17.660 --> 00:05:20.475
then type of dot,

120
00:05:20.475 --> 00:05:23.825
and what we're looking for
is our order quantity.

121
00:05:23.825 --> 00:05:26.270
I'm going to tab to select that,

122
00:05:26.270 --> 00:05:30.710
close my double quotes and
then type another comma.

123
00:05:30.710 --> 00:05:33.950
The last thing I need
to do is specify that I

124
00:05:33.950 --> 00:05:36.890
want to filter this
by subcategory,

125
00:05:36.890 --> 00:05:40.190
and the subcategory I'm
filtering by is vests.

126
00:05:40.190 --> 00:05:43.480
Again, open your double quotes.

127
00:05:43.480 --> 00:05:46.460
We're going to get category
from our lookup products.

128
00:05:46.460 --> 00:05:48.935
I'm going to select that, dot,

129
00:05:48.935 --> 00:05:51.444
open my square brackets,

130
00:05:51.444 --> 00:05:54.645
and I'm looking for
subcategories, su,

131
00:05:54.645 --> 00:05:57.900
and tab to select Sub
Category, and finally,

132
00:05:57.900 --> 00:06:00.570
which subcategory, another dot,

133
00:06:00.570 --> 00:06:03.940
my square brackets, and
I'm looking for Vests.

134
00:06:03.940 --> 00:06:05.800
Close the square brackets,

135
00:06:05.800 --> 00:06:07.265
close your double quotes,

136
00:06:07.265 --> 00:06:10.860
close the round bracket and
there's your cube function.

137
00:06:10.860 --> 00:06:15.300
When I press enter, there's
the correct answer.

138
00:06:15.300 --> 00:06:17.840
We've now seen how we can access

139
00:06:17.840 --> 00:06:20.320
data directly in the data model.

140
00:06:20.320 --> 00:06:23.104
The downside was that function

141
00:06:23.104 --> 00:06:25.020
was actually an MDX function.

142
00:06:25.020 --> 00:06:26.990
It's a whole new language
and it's going to

143
00:06:26.990 --> 00:06:29.960
take a little bit
of effort to learn.

144
00:06:29.960 --> 00:06:33.160
The great news is
you don't have to.

145
00:06:33.160 --> 00:06:35.720
In Power Pivot, we can take

146
00:06:35.720 --> 00:06:40.400
a regular pivot table and
convert it to cube functions.

147
00:06:40.400 --> 00:06:42.530
Click into the data.
We're going to come

148
00:06:42.530 --> 00:06:44.905
up to our PivotTable
Analyze ribbon,

149
00:06:44.905 --> 00:06:47.330
and the OLAP tools button,

150
00:06:47.330 --> 00:06:48.665
which is normally grayed out.

151
00:06:48.665 --> 00:06:50.420
If you click the drop-down,

152
00:06:50.420 --> 00:06:53.030
there's an option to
convert to formulas.

153
00:06:53.030 --> 00:06:57.375
When I click on that, job done.

154
00:06:57.375 --> 00:06:59.715
This is no longer pivot table.

155
00:06:59.715 --> 00:07:01.880
This is now getting
the data directly

156
00:07:01.880 --> 00:07:04.355
from the data model
using cube formulas,

157
00:07:04.355 --> 00:07:06.500
and the benefit of that is

158
00:07:06.500 --> 00:07:08.735
I can use all my regular charts.

159
00:07:08.735 --> 00:07:11.735
Just make sure you clicked
somewhere in the data,

160
00:07:11.735 --> 00:07:13.625
come to your Insert ribbon,

161
00:07:13.625 --> 00:07:16.430
come to Charts, and I'd
like a hierarchy charts.

162
00:07:16.430 --> 00:07:17.600
I'm going to click
the drop-down by

163
00:07:17.600 --> 00:07:20.815
hierarchy and I'm going
to go for a Sunburst.

164
00:07:20.815 --> 00:07:24.720
I'm then going to make
this really nice and big,

165
00:07:25.960 --> 00:07:29.370
and I'm going to move
the chart title.

166
00:07:31.250 --> 00:07:34.500
But here is the added bonus.

167
00:07:34.500 --> 00:07:37.170
The slices still work.

168
00:07:37.170 --> 00:07:41.050
If I were to choose sales
for 2018, for example,

169
00:07:41.050 --> 00:07:42.835
you'll see it has

170
00:07:42.835 --> 00:07:45.835
filtered my data and of
course filtered my chart,

171
00:07:45.835 --> 00:07:49.295
and there are my sales
for Canada in 2018.

172
00:07:49.295 --> 00:07:51.210
Two-thirds of them are bikes.

173
00:07:51.210 --> 00:07:54.250
2019, I introduced a
whole additional range

174
00:07:54.250 --> 00:07:57.050
and only a third of my
sales were actually bikes.

175
00:07:57.050 --> 00:08:00.250
We've seen that cube
functions can help us

176
00:08:00.250 --> 00:08:04.915
address limitations with
pivot charts or pivot tables.

177
00:08:04.915 --> 00:08:07.990
They can also allow
us to pull data from

178
00:08:07.990 --> 00:08:09.850
multiple data models and

179
00:08:09.850 --> 00:08:12.040
integrate that in
a single report.

180
00:08:12.040 --> 00:08:14.050
Now it's important to note

181
00:08:14.050 --> 00:08:17.855
that these are working
like normal functions.

182
00:08:17.855 --> 00:08:21.190
So far, if I added
another subcategory,

183
00:08:21.190 --> 00:08:22.750
it's not going to suddenly appear

184
00:08:22.750 --> 00:08:25.120
here where it would
with a pivot table.

185
00:08:25.120 --> 00:08:26.890
It's not that cube functions

186
00:08:26.890 --> 00:08:28.850
don't have their own limitations.

187
00:08:28.850 --> 00:08:31.405
But if you want to address

188
00:08:31.405 --> 00:08:34.465
limitations with pivot
charts or pivot tables,

189
00:08:34.465 --> 00:08:37.090
or if you want to pull data

190
00:08:37.090 --> 00:08:39.925
and integrate it from
multiple data models,

191
00:08:39.925 --> 00:08:42.070
cube functions may give

192
00:08:42.070 --> 00:08:44.275
you the solution
you're looking for.

193
00:08:44.275 --> 00:08:47.230
For a little more information
on the cube functions,

194
00:08:47.230 --> 00:08:49.850
check out this week's toolbox.