WEBVTT

1
00:00:00.000 --> 00:00:05.478
[MUSIC]

2
00:00:05.478 --> 00:00:11.320
In this video, we're going to complete our
data model by relating all our datasets.

3
00:00:11.320 --> 00:00:15.109
And we're also going to start using
that data to perform some analysis.

4
00:00:16.310 --> 00:00:19.200
I've clicked into the Sales by Year tab.

5
00:00:19.200 --> 00:00:24.951
And what we'd like to do here is using our
data in data model, create a pivot table,

6
00:00:24.951 --> 00:00:29.910
showing the total number of
items sold by category and year.

7
00:00:29.910 --> 00:00:33.937
But with the data in the data model,
how do I create a pivot table?

8
00:00:33.937 --> 00:00:36.290
And it's actually really easy.

9
00:00:36.290 --> 00:00:39.240
We're going to come to our Insert tab.

10
00:00:39.240 --> 00:00:40.750
We're going to select pivot table.

11
00:00:42.380 --> 00:00:46.699
And you'll notice that the option
Use this workbook's Data Model is

12
00:00:46.699 --> 00:00:48.420
automatically selected.

13
00:00:49.510 --> 00:00:55.440
This easy to ignore option unlocks
a whole parallel universe in Excel.

14
00:00:55.440 --> 00:00:56.942
We're going to click OK.

15
00:00:58.813 --> 00:01:02.757
Now first thing you'll notice
is instead of just one table,

16
00:01:02.757 --> 00:01:07.060
we have all the tables in our
data model to choose from.

17
00:01:07.060 --> 00:01:09.250
And this is what makes Power Pivot so

18
00:01:09.250 --> 00:01:13.150
powerful that we can pull
data from multiple sources.

19
00:01:13.150 --> 00:01:17.795
When you start working in Power Pivot
you may find it easier to change your

20
00:01:17.795 --> 00:01:19.150
field view.

21
00:01:19.150 --> 00:01:21.996
So I'm coming to the little
cog at the top right.

22
00:01:21.996 --> 00:01:24.468
And I'm going to choose the second option,

23
00:01:24.468 --> 00:01:28.580
which puts the fields section on
the left and the areas on the right.

24
00:01:28.580 --> 00:01:31.480
And that just means I can
see more of my fields.

25
00:01:32.560 --> 00:01:37.180
Now what we want to do is see
our total order item quantity.

26
00:01:37.180 --> 00:01:39.960
So coming to order items,
I'm going to click the drop down.

27
00:01:41.040 --> 00:01:43.670
I can now see all
the fields on their table.

28
00:01:43.670 --> 00:01:45.698
And I need all the quantities.

29
00:01:45.698 --> 00:01:47.570
So I'm just going to select that.

30
00:01:47.570 --> 00:01:52.240
And as expected it's added it to
the values section and added it up.

31
00:01:52.240 --> 00:01:56.320
But I now want to get
the breakdown by product category.

32
00:01:56.320 --> 00:02:00.240
And I don't actually have category
anywhere in my order items table.

33
00:02:00.240 --> 00:02:03.273
So in traditional Excel,
we would use a VLOOKUP or

34
00:02:03.273 --> 00:02:06.830
an index match to pull
that information through.

35
00:02:06.830 --> 00:02:10.314
But in Power Pivot,
we don't need to do that.

36
00:02:10.314 --> 00:02:12.840
We are going to come to
our look up products.

37
00:02:12.840 --> 00:02:15.340
So this is the information
about all our products.

38
00:02:15.340 --> 00:02:19.521
And as well as product ID and Name,
you will see it also has a category.

39
00:02:19.521 --> 00:02:20.610
So we are going to select that.

40
00:02:22.780 --> 00:02:24.840
Now that didn't quite work.

41
00:02:24.840 --> 00:02:29.499
And the reason is at this point there
is no relationship between the lookup

42
00:02:29.499 --> 00:02:32.390
products and our order quantity.

43
00:02:32.390 --> 00:02:37.709
So what it's doing is it's just giving us
each category and the total next to it.

44
00:02:38.770 --> 00:02:42.360
So we have to somehow
connect those data sets.

45
00:02:42.360 --> 00:02:47.028
If you have a look on the right hand side,
you'll see Excel's even suggesting there's

46
00:02:47.028 --> 00:02:49.440
a problem, and
you may need a relationship.

47
00:02:50.740 --> 00:02:53.750
It's even offering to create
that relationship for you.

48
00:02:53.750 --> 00:02:59.153
So we're going to click Auto-Detect And
then just click the Close button,

49
00:02:59.153 --> 00:03:02.460
and you'll see it has
created the relationship.

50
00:03:02.460 --> 00:03:07.310
And now we have a breakdown
of items ordered by category.

51
00:03:07.310 --> 00:03:09.780
Let's go and
have a look at that relationship.

52
00:03:09.780 --> 00:03:13.665
So back into our Power Pivot
ribbon we're going to click

53
00:03:13.665 --> 00:03:19.000
Manage And what we're looking at
at the moment is our data view.

54
00:03:19.000 --> 00:03:21.963
When we want to see our
relationships however,

55
00:03:21.963 --> 00:03:24.430
a better view is the Diagram View.

56
00:03:24.430 --> 00:03:27.000
So on the Home ribbon,
just select Diagram View.

57
00:03:29.200 --> 00:03:32.338
And here's our order items and
our look our products and

58
00:03:32.338 --> 00:03:36.230
you can see it has created
a one to many relationship.

59
00:03:36.230 --> 00:03:41.040
Now to see which fields it has related,
we're going to double click on the line,

60
00:03:41.040 --> 00:03:43.740
double click on that relationship.

61
00:03:43.740 --> 00:03:46.747
And you can see it's actually
linked ProductID to ProductID,

62
00:03:46.747 --> 00:03:48.630
which is exactly what we want.

63
00:03:48.630 --> 00:03:52.550
If it had made a mistake, we could
actually just go and correct it at

64
00:03:52.550 --> 00:03:56.820
this point, but we're going to leave
it as ProductID and then just say OK.

65
00:03:58.010 --> 00:04:02.649
If you wanted to remove the relationship,
you can right click on the line, and

66
00:04:02.649 --> 00:04:04.910
you have the option to delete or edit.

67
00:04:07.160 --> 00:04:10.490
What we want to do now, though,
is create our own relationships.

68
00:04:10.490 --> 00:04:12.172
I mean, that worked really well,

69
00:04:12.172 --> 00:04:16.790
but it's better practice to actually
put the relationships in yourself.

70
00:04:16.790 --> 00:04:19.680
The first thing we're going to
do is reorganize our tables.

71
00:04:19.680 --> 00:04:23.382
At the bottom of the window, I'm going to
click the zoom slider to zoom in a little

72
00:04:23.382 --> 00:04:27.420
bit, and you'll see our calendar tables
actually hanging off the edge there.

73
00:04:27.420 --> 00:04:31.563
So I'm just going to grab that and
pull that across.

74
00:04:31.563 --> 00:04:34.496
And I'm actually going to put it
near the top left hand corner.

75
00:04:34.496 --> 00:04:38.319
And then I'm going to move orders
down a little bit underneath.

76
00:04:38.319 --> 00:04:40.668
The recommended layout for

77
00:04:40.668 --> 00:04:46.630
your data model is to have all
your lookup tables in the top row.

78
00:04:46.630 --> 00:04:50.314
So I'm actually going to move
lookup products up a little bit,

79
00:04:50.314 --> 00:04:52.851
and I'm going to move
the order items down.

80
00:04:52.851 --> 00:04:55.390
And then I'm just going to move these
two across a little bit as well.

81
00:04:55.390 --> 00:04:59.490
So, just pop that in there.

82
00:05:00.810 --> 00:05:03.632
So what we've got is our lookup tables,

83
00:05:03.632 --> 00:05:07.699
the tables that create context for
our data in the top row.

84
00:05:07.699 --> 00:05:12.044
And the fact tables or
the data tables that have all the numbers,

85
00:05:12.044 --> 00:05:14.710
the actual sales transactions.

86
00:05:14.710 --> 00:05:16.180
They are in the bottom row.

87
00:05:17.230 --> 00:05:18.670
And there's two reasons for this.

88
00:05:18.670 --> 00:05:21.150
First of all, think of it as looking up.

89
00:05:21.150 --> 00:05:24.150
So we're going to look up
to see our lookup data.

90
00:05:24.150 --> 00:05:28.245
But more importantly,
if you have a look at the relationship,

91
00:05:28.245 --> 00:05:31.270
it flows if you like,
from the one to the many.

92
00:05:32.440 --> 00:05:36.600
And that has implications for
when we start filtering the data.

93
00:05:36.600 --> 00:05:40.753
I can filter my order items by any
of the fields in my lookup products,

94
00:05:40.753 --> 00:05:44.840
because that's the direction
of the relationship.

95
00:05:44.840 --> 00:05:47.670
It doesn't automatically
work the other way around.

96
00:05:47.670 --> 00:05:51.700
So I can't filter my lookup products
by values in my order items.

97
00:05:51.700 --> 00:05:55.135
And that's why it's quite important
to get this structure right.

98
00:05:55.135 --> 00:05:58.400
All right,
let's add some more relationships.

99
00:05:58.400 --> 00:06:02.661
So one order could potentially
have many order items and

100
00:06:02.661 --> 00:06:06.921
the field that will allow us
to relate these two tables,

101
00:06:06.921 --> 00:06:10.930
the matching field is our sales order ID.

102
00:06:10.930 --> 00:06:13.232
This is also called the primary key.

103
00:06:13.232 --> 00:06:15.810
Now, we're going to start in the ones.

104
00:06:15.810 --> 00:06:17.630
We're going to start in the Orders.

105
00:06:17.630 --> 00:06:24.320
Click on SalesOrderID and
drag to SalesOrderID in the Order_Items.

106
00:06:24.320 --> 00:06:27.180
And that creates a one
to many relationship.

107
00:06:28.890 --> 00:06:31.960
Now I have a lot of other
relationships on Orders.

108
00:06:31.960 --> 00:06:35.469
If you need to make the table a little
bigger, you can come to the bottom of it

109
00:06:35.469 --> 00:06:39.350
and just click and drag down so
we can see the rest of the fields.

110
00:06:39.350 --> 00:06:43.210
Now I also want to be able to see
which customer bought the item.

111
00:06:44.450 --> 00:06:45.356
In this case,

112
00:06:45.356 --> 00:06:50.580
I'm going to match the ID in the customer
table to the customer ID in my orders.

113
00:06:50.580 --> 00:06:54.262
So repeating the process we're
going to click ID drag and

114
00:06:54.262 --> 00:06:56.030
hook it on to CustomerID.

115
00:06:57.590 --> 00:07:00.510
Let's do the same for our sales person.

116
00:07:00.510 --> 00:07:03.134
So, from Staff,
I'm going to grab EmployeeID and

117
00:07:03.134 --> 00:07:05.310
I'm going to link that to SalesPersonID.

118
00:07:06.390 --> 00:07:11.630
And, finally, I'm going to grab Date in
my Calendar and link that to OrderDate.

119
00:07:12.850 --> 00:07:16.830
We have now completed our data model
by putting in the relationships.

120
00:07:16.830 --> 00:07:22.970
And we can now create pivot tables that
pull data from any of these sources.

121
00:07:22.970 --> 00:07:24.910
Let's go and test it out.

122
00:07:24.910 --> 00:07:27.381
We don't actually have to
close our pivot window,

123
00:07:27.381 --> 00:07:30.970
you can just press Alt Tab to
jump back into the spreadsheet.

124
00:07:30.970 --> 00:07:35.250
And what we want to do now
is add out year information.

125
00:07:35.250 --> 00:07:39.600
So coming to our pivot field list,
I'm going to expand the Calendar.

126
00:07:39.600 --> 00:07:43.580
And you'll see I can either go to
Date Hierarchy or More Fields.

127
00:07:43.580 --> 00:07:45.948
The Date Hierarchy was added for
us automatically and

128
00:07:45.948 --> 00:07:48.480
we're going to look at hierarchies
more in the next video.

129
00:07:48.480 --> 00:07:53.145
But what it allows us to do is basically
add a hierarchy rather than just

130
00:07:53.145 --> 00:07:54.600
a single field.

131
00:07:54.600 --> 00:07:55.630
So let's see how it works.

132
00:07:55.630 --> 00:07:59.357
I'm going to select hierarchy and
drop it into Columns.

133
00:07:59.357 --> 00:08:04.233
And you'll see it's added each of
the years, but I can actually expand

134
00:08:04.233 --> 00:08:09.260
2018 to see it by month, and
I could expand March to see it by day.

135
00:08:09.260 --> 00:08:12.332
So these hierarchies offer
you the ability to expand and

136
00:08:12.332 --> 00:08:14.300
collapse fields within the pivot.

137
00:08:14.300 --> 00:08:18.940
It's a little bit like a grouping,
but without the same limitations.

138
00:08:18.940 --> 00:08:23.404
So what we've seen in this video
is how we can start creating

139
00:08:23.404 --> 00:08:27.604
pivot tables using fields
from multiple different data

140
00:08:27.604 --> 00:08:32.357
sets without needing to actually
use VLOOKUPS or index match.

141
00:08:32.357 --> 00:08:36.697
This is probably one of the most
important reasons for using Power Pivot.

142
00:08:36.697 --> 00:08:38.807
But there are a lot of other advantages,
and

143
00:08:38.807 --> 00:08:41.786
we're going to start looking at
some of those in the next video.