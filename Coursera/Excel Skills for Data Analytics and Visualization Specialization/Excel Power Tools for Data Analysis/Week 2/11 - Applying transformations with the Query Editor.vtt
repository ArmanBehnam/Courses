WEBVTT

1
00:00:04.760 --> 00:00:08.190
In this video, we're going
to get more familiar with

2
00:00:08.190 --> 00:00:11.850
the Query Editor and apply
a range of transformations.

3
00:00:11.850 --> 00:00:14.610
Some of them revision
and some of them new.

4
00:00:14.610 --> 00:00:18.540
Last week, the focus was
very much on getting data

5
00:00:18.540 --> 00:00:20.415
from a variety of
different sources

6
00:00:20.415 --> 00:00:22.290
and integrating that data.

7
00:00:22.290 --> 00:00:24.710
This week, the focus will more be

8
00:00:24.710 --> 00:00:27.930
on transforming and
cleaning our data.

9
00:00:27.930 --> 00:00:30.660
We're still helping out
in the HR department.

10
00:00:30.660 --> 00:00:33.570
Our first challenge
this week is to help

11
00:00:33.570 --> 00:00:37.840
produce reports for the
course evaluations.

12
00:00:38.930 --> 00:00:43.490
Currently, the evaluations
come in, in this format,

13
00:00:43.490 --> 00:00:44.960
but we need to produce

14
00:00:44.960 --> 00:00:48.905
a nice summary report showing
what the feedback was like.

15
00:00:48.905 --> 00:00:52.265
That summary report needs
to look more like this.

16
00:00:52.265 --> 00:00:55.100
This involves a lot of
manual manipulation of

17
00:00:55.100 --> 00:00:58.475
the data and it has to be
done for every single course.

18
00:00:58.475 --> 00:01:00.740
So we're looking for a
more automated solution

19
00:01:00.740 --> 00:01:03.800
and that's what Power
Query will give us.

20
00:01:03.800 --> 00:01:05.705
If you haven't already,

21
00:01:05.705 --> 00:01:07.420
please open up the 321

22
00:01:07.420 --> 00:01:09.615
applying transformations
with book.

23
00:01:09.615 --> 00:01:11.030
The first thing we're
going to need to

24
00:01:11.030 --> 00:01:12.590
do is get our data.

25
00:01:12.590 --> 00:01:16.860
So come to your data
ribbon, in 2016,

26
00:01:16.860 --> 00:01:18.965
we're looking for the
New Query button,

27
00:01:18.965 --> 00:01:20.525
but we're going to come to

28
00:01:20.525 --> 00:01:25.500
Get Data from File
and from Workbook.

29
00:01:26.470 --> 00:01:29.210
If you get a
compatibility warning,

30
00:01:29.210 --> 00:01:31.645
don't worry, just click "Close."

31
00:01:31.645 --> 00:01:33.290
Now navigate to where you

32
00:01:33.290 --> 00:01:34.940
downloaded your
workbooks and you're

33
00:01:34.940 --> 00:01:38.375
looking for Course
Evaluations, MS project.

34
00:01:38.375 --> 00:01:40.130
Make sure its MS Project,

35
00:01:40.130 --> 00:01:43.170
and then double-click or import.

36
00:01:44.900 --> 00:01:47.660
The navigator will
show you that there's

37
00:01:47.660 --> 00:01:50.480
one sheet in the workbook,
that's the one we want.

38
00:01:50.480 --> 00:01:52.400
So click "Evals" and then

39
00:01:52.400 --> 00:01:54.860
come down to edit
or Transform Data.

40
00:01:54.860 --> 00:01:58.920
Click the button to open
up your Query Editor.

41
00:02:00.560 --> 00:02:02.840
We've already spent
a little bit of

42
00:02:02.840 --> 00:02:05.125
time in the Query Editor.

43
00:02:05.125 --> 00:02:07.310
But I'd just like to
point out that as well

44
00:02:07.310 --> 00:02:09.335
as all the tools on the ribbon,

45
00:02:09.335 --> 00:02:12.425
if you come to one of the
columns and right-click,

46
00:02:12.425 --> 00:02:14.060
you get a contextual menu that

47
00:02:14.060 --> 00:02:16.860
gives you a lot of tools as well.

48
00:02:17.080 --> 00:02:20.780
On the right-hand side
is our query settings.

49
00:02:20.780 --> 00:02:23.540
You can change the
name of your query in

50
00:02:23.540 --> 00:02:27.395
the properties and
as we make changes,

51
00:02:27.395 --> 00:02:29.720
each change is applied
as a step which

52
00:02:29.720 --> 00:02:32.585
we can then navigate
through and modify.

53
00:02:32.585 --> 00:02:34.790
In the newer version, Power Query

54
00:02:34.790 --> 00:02:36.050
is trying to get
a little bit more

55
00:02:36.050 --> 00:02:37.820
intelligent and you'll see it has

56
00:02:37.820 --> 00:02:39.830
added a few additional
steps for me.

57
00:02:39.830 --> 00:02:41.900
You'll see a lot of
these changed types,

58
00:02:41.900 --> 00:02:44.974
which is where it automatically
change the datatype.

59
00:02:44.974 --> 00:02:47.525
But these can be
really problematic.

60
00:02:47.525 --> 00:02:50.450
Actually, I'd encourage
you to remove them and add

61
00:02:50.450 --> 00:02:51.470
your own changes to

62
00:02:51.470 --> 00:02:54.690
data types towards the
end of the process.

63
00:02:54.690 --> 00:02:56.060
I'm actually going to remove

64
00:02:56.060 --> 00:02:58.645
that change type by
clicking on the cross.

65
00:02:58.645 --> 00:03:00.260
The other thing that's happened

66
00:03:00.260 --> 00:03:01.670
is it's automatically taken

67
00:03:01.670 --> 00:03:05.780
the first row and promoted
it to be my column headings.

68
00:03:05.780 --> 00:03:07.640
Now again, that is not correct.

69
00:03:07.640 --> 00:03:10.720
So I'm going to remove
that step as well.

70
00:03:10.720 --> 00:03:12.750
Now whichever version you're in,

71
00:03:12.750 --> 00:03:15.305
we should be at about
the same place.

72
00:03:15.305 --> 00:03:19.835
The first thing I need
to do is to remove

73
00:03:19.835 --> 00:03:21.860
the first six rows
because they're

74
00:03:21.860 --> 00:03:24.235
not actually part of the data.

75
00:03:24.235 --> 00:03:27.620
We're going to do this by
coming to our Home ribbon,

76
00:03:27.620 --> 00:03:29.840
finding the Remove Rows button

77
00:03:29.840 --> 00:03:32.480
and clicking "Remove Top Rows."

78
00:03:32.480 --> 00:03:34.370
There are six rows
we want to remove,

79
00:03:34.370 --> 00:03:37.850
so I'm going to type six
and press "OK." We now

80
00:03:37.850 --> 00:03:41.435
have the actual column headings
sitting in our top row.

81
00:03:41.435 --> 00:03:43.460
So we can now promote those to be

82
00:03:43.460 --> 00:03:45.590
our headers and we
do that by coming to

83
00:03:45.590 --> 00:03:50.635
the Home ribbon and selecting
"Use First Row as Headers."

84
00:03:50.635 --> 00:03:54.695
We need the course name to repeat

85
00:03:54.695 --> 00:03:55.790
down and we need

86
00:03:55.790 --> 00:03:58.495
the evaluation number
to actually repeat up.

87
00:03:58.495 --> 00:04:00.410
While the Home tab has a lot

88
00:04:00.410 --> 00:04:02.135
of tools for doing
transformations,

89
00:04:02.135 --> 00:04:03.600
it doesn't have all of them.

90
00:04:03.600 --> 00:04:05.420
So if you can't see
the tool you want,

91
00:04:05.420 --> 00:04:08.230
try coming to the Transform tab

92
00:04:08.230 --> 00:04:11.510
and the tool we're looking
for here is the Fill.

93
00:04:11.510 --> 00:04:13.760
So make sure you've
got course selected,

94
00:04:13.760 --> 00:04:18.410
come to Fill, I'm going
to choose "Fill, Down."

95
00:04:18.410 --> 00:04:21.290
Then for the evaluation
number column,

96
00:04:21.290 --> 00:04:24.750
we're going to choose
"Fill" and "Up."

97
00:04:25.090 --> 00:04:28.970
We still have a lot of
rows that don't actually

98
00:04:28.970 --> 00:04:32.720
contain data and we'd
like to get rid of those.

99
00:04:32.720 --> 00:04:34.730
What you need to do is look for

100
00:04:34.730 --> 00:04:37.880
a consistent pattern
and the pattern here,

101
00:04:37.880 --> 00:04:39.020
if you look at Questions,

102
00:04:39.020 --> 00:04:41.540
for example, there are
a whole bunch of nulls,

103
00:04:41.540 --> 00:04:42.770
we want to get rid of those.

104
00:04:42.770 --> 00:04:44.840
You'll also notice
that the headings for

105
00:04:44.840 --> 00:04:46.880
the other evaluations
are being repeated.

106
00:04:46.880 --> 00:04:48.785
So where we see the
word questions,

107
00:04:48.785 --> 00:04:51.030
we also want to remove it.

108
00:04:51.030 --> 00:04:53.230
We can do that by simply
filtering them out.

109
00:04:53.230 --> 00:04:55.010
So coming to our
questions column,

110
00:04:55.010 --> 00:04:56.525
I'm going to click the drop-down.

111
00:04:56.525 --> 00:05:00.860
We can unselect null and
unselect questions and click

112
00:05:00.860 --> 00:05:05.525
"OK." The data is now
looking much better,

113
00:05:05.525 --> 00:05:07.850
but we still have
a small problem.

114
00:05:07.850 --> 00:05:09.380
If you scroll down to the bottom,

115
00:05:09.380 --> 00:05:11.410
you'll see that the evals 1039

116
00:05:11.410 --> 00:05:14.125
and 1040 have been duplicated.

117
00:05:14.125 --> 00:05:17.675
Fortunately, it's also very
easy to remove duplicates.

118
00:05:17.675 --> 00:05:20.600
To do this, we're going to
come back to the Home tab.

119
00:05:20.600 --> 00:05:22.970
If you're working in 2016,

120
00:05:22.970 --> 00:05:25.730
you'll actually notice
a button directly on

121
00:05:25.730 --> 00:05:28.790
the ribbon that will allow
you to remove duplicates.

122
00:05:28.790 --> 00:05:30.335
In the newer versions, however,

123
00:05:30.335 --> 00:05:33.320
it's actually been tucked
behind the Remove Rows button.

124
00:05:33.320 --> 00:05:36.140
Now before we can actually
remove the duplicates,

125
00:05:36.140 --> 00:05:38.300
we have to identify the columns

126
00:05:38.300 --> 00:05:40.475
that we wanted to
check are duplicated.

127
00:05:40.475 --> 00:05:43.120
In this case, it's
all of the columns.

128
00:05:43.120 --> 00:05:45.485
But here's a great
little keyboard shortcut

129
00:05:45.485 --> 00:05:47.285
that translates from Excel.

130
00:05:47.285 --> 00:05:50.330
If you click somewhere
into your grid and

131
00:05:50.330 --> 00:05:53.480
then press "Control
A" to select all,

132
00:05:53.480 --> 00:05:55.430
it highlights all the columns.

133
00:05:55.430 --> 00:05:57.680
Now we're going to remove
our duplicates either

134
00:05:57.680 --> 00:05:59.825
click the "Remove Duplicates"
button on the ribbon

135
00:05:59.825 --> 00:06:02.240
or come to remove
rows and we're going

136
00:06:02.240 --> 00:06:05.490
to say, "Remove Duplicates."

137
00:06:07.190 --> 00:06:10.260
All fixed. One last thing,

138
00:06:10.260 --> 00:06:12.260
we would like to sort the data by

139
00:06:12.260 --> 00:06:15.320
question number and
then evaluation number.

140
00:06:15.320 --> 00:06:18.065
So I'm going to start
by coming to questions.

141
00:06:18.065 --> 00:06:21.830
Click my drop down and
say "Sort Ascending."

142
00:06:21.830 --> 00:06:25.015
You'll see that it sorted
the entire dataset.

143
00:06:25.015 --> 00:06:27.080
Now in Excel, if I were to now

144
00:06:27.080 --> 00:06:28.985
come and sort by
evaluation number,

145
00:06:28.985 --> 00:06:31.370
I would lose my
sort on questions.

146
00:06:31.370 --> 00:06:33.080
But here we see the Query Editor

147
00:06:33.080 --> 00:06:34.745
behaves quite differently.

148
00:06:34.745 --> 00:06:37.400
If we click eval
number and choose,

149
00:06:37.400 --> 00:06:41.540
"Sort Ascending", it
retains the initial sort.

150
00:06:41.540 --> 00:06:42.935
You can see that's got a one

151
00:06:42.935 --> 00:06:45.125
and it adds a sort within it,

152
00:06:45.125 --> 00:06:46.865
which is sort level two.

153
00:06:46.865 --> 00:06:48.740
So you can have multi-sort

154
00:06:48.740 --> 00:06:51.785
levels just by using your
autofill for buttons.

155
00:06:51.785 --> 00:06:54.515
Really cool. All right,
that's looking great.

156
00:06:54.515 --> 00:06:55.940
We're ready to close and load.

157
00:06:55.940 --> 00:06:57.470
So back to the drop-down,

158
00:06:57.470 --> 00:07:02.420
"Close and Load to," we
want to load it into

159
00:07:02.420 --> 00:07:04.610
the existing worksheet
and we're going to click

160
00:07:04.610 --> 00:07:09.545
"OK." That is looking
so much better.

161
00:07:09.545 --> 00:07:13.030
But it's not a 100 percent yet.

162
00:07:13.030 --> 00:07:15.500
The way the data is laid out,

163
00:07:15.500 --> 00:07:18.125
the ratings are shown
as column headings

164
00:07:18.125 --> 00:07:21.245
rather than as values
within a single column.

165
00:07:21.245 --> 00:07:23.150
This is going to
make it still quite

166
00:07:23.150 --> 00:07:25.630
tricky to do the analysis.

167
00:07:25.630 --> 00:07:28.545
But that's your challenge.

168
00:07:28.545 --> 00:07:32.195
Using this data and
conventional Excel tools,

169
00:07:32.195 --> 00:07:35.630
I'd like you to try and
create a chart that shows

170
00:07:35.630 --> 00:07:37.070
the average rating for

171
00:07:37.070 --> 00:07:39.640
the three questions
about trainers.

172
00:07:39.640 --> 00:07:41.450
In the next video,

173
00:07:41.450 --> 00:07:43.250
I'll show you how to do it really

174
00:07:43.250 --> 00:07:46.140
quickly using Power Query.