WEBVTT

1
00:00:04.670 --> 00:00:07.200
In this video, we're
going to look at

2
00:00:07.200 --> 00:00:09.240
some very exciting new
features that have been

3
00:00:09.240 --> 00:00:12.390
added to Power Query
for Managing columns.

4
00:00:12.390 --> 00:00:14.985
If you have a slightly
older version,

5
00:00:14.985 --> 00:00:17.175
it might not support
these newer features.

6
00:00:17.175 --> 00:00:19.770
We'd encourage you to
watch the video anyway and

7
00:00:19.770 --> 00:00:22.320
then we have another
video called Working

8
00:00:22.320 --> 00:00:25.230
with columns alternate which
will show you how to solve

9
00:00:25.230 --> 00:00:28.605
very similar problems using
alternative features.

10
00:00:28.605 --> 00:00:30.300
In the previous video,

11
00:00:30.300 --> 00:00:32.670
we created a query
to work out how

12
00:00:32.670 --> 00:00:35.145
much we'd spent on
training in June.

13
00:00:35.145 --> 00:00:37.140
What we want to do now is use

14
00:00:37.140 --> 00:00:40.855
that information along with
our training budget data

15
00:00:40.855 --> 00:00:43.010
to work out our total spend for

16
00:00:43.010 --> 00:00:47.185
our second quarter and whether
or not we are over budget.

17
00:00:47.185 --> 00:00:49.085
The first thing we're
going to need to do

18
00:00:49.085 --> 00:00:51.110
is get our training budget data.

19
00:00:51.110 --> 00:00:52.895
This is what it looks like,

20
00:00:52.895 --> 00:00:56.980
but we're going to start off
in our regular Workbook.

21
00:00:56.980 --> 00:01:00.775
Just make sure you're on the
budget sheet, and in A3.

22
00:01:00.775 --> 00:01:03.345
Then we've got to
come to our Data tab,

23
00:01:03.345 --> 00:01:08.025
Get data or new query
from File from Workbook

24
00:01:08.025 --> 00:01:09.860
and you're going to find

25
00:01:09.860 --> 00:01:11.495
the training budget worksheet

26
00:01:11.495 --> 00:01:14.670
and double-click to open that.

27
00:01:14.900 --> 00:01:17.850
The budget data is in a table,

28
00:01:17.850 --> 00:01:19.785
so we're going to
select budget one

29
00:01:19.785 --> 00:01:23.590
and then we're going to
click Transform or Edit.

30
00:01:27.380 --> 00:01:30.760
As you've probably guessed,
we're going to need to

31
00:01:30.760 --> 00:01:33.890
merge this data with
our June's spend query,

32
00:01:33.890 --> 00:01:35.800
but we can't do it

33
00:01:35.800 --> 00:01:38.110
yet because we're
going to need to match

34
00:01:38.110 --> 00:01:40.210
branch and department and
at the moment they're

35
00:01:40.210 --> 00:01:42.970
sitting in a single column
with the cost center code.

36
00:01:42.970 --> 00:01:44.890
The first thing we have to do is

37
00:01:44.890 --> 00:01:46.955
somehow split out this data.

38
00:01:46.955 --> 00:01:49.660
There were actually quite a
lot of options for doing this

39
00:01:49.660 --> 00:01:52.610
and I'd like to show you
some of the newer ones.

40
00:01:52.610 --> 00:01:55.300
Make sure you've got cost
center selected and we're

41
00:01:55.300 --> 00:01:58.090
going to come to the
add column ribbon.

42
00:01:58.090 --> 00:02:00.940
I'm going to show you
my most favorite tool.

43
00:02:00.940 --> 00:02:03.640
This is column from examples.

44
00:02:03.640 --> 00:02:06.230
It's quite new and
it's quite brilliant.

45
00:02:06.230 --> 00:02:07.650
I'm going to click on column from

46
00:02:07.650 --> 00:02:10.420
examples and It's
going to now ask

47
00:02:10.420 --> 00:02:15.370
me to help it by showing it
what data I want to extract.

48
00:02:15.370 --> 00:02:17.980
It's a little bit like
Flash Fill in Excel,

49
00:02:17.980 --> 00:02:21.215
but of course it uses a
query and it's automated.

50
00:02:21.215 --> 00:02:23.305
What I want to do
is I want to get

51
00:02:23.305 --> 00:02:25.950
the branch name but
with a capital letter.

52
00:02:25.950 --> 00:02:30.625
I'm going to type in
Sydney and press Enter.

53
00:02:30.625 --> 00:02:32.740
It's gone and looked
for a patent,

54
00:02:32.740 --> 00:02:35.005
but it hasn't guessed
the right one.

55
00:02:35.005 --> 00:02:37.750
You'll see it says
text before delimiter.

56
00:02:37.750 --> 00:02:40.960
What it thinks I want to do
is split it before I find

57
00:02:40.960 --> 00:02:42.715
an S and that's why I've got

58
00:02:42.715 --> 00:02:45.360
Bri and here it
didn't find any S's.

59
00:02:45.360 --> 00:02:47.590
I haven't given it
quite enough for it

60
00:02:47.590 --> 00:02:49.820
to take the right
pattern, that's okay.

61
00:02:49.820 --> 00:02:50.570
I'm going to click in

62
00:02:50.570 --> 00:02:53.640
the fourth row and I'm
going to type Brisbane.

63
00:02:54.370 --> 00:02:58.145
Now it's worked it out. If you
have a look at the M code,

64
00:02:58.145 --> 00:03:00.275
it's actually saying
split the text

65
00:03:00.275 --> 00:03:02.585
when it transitions
from a lowercase

66
00:03:02.585 --> 00:03:07.410
to uppercase and the second
bit is saying Text.Proper,

67
00:03:07.410 --> 00:03:09.570
that's converting
it to proper case,

68
00:03:09.570 --> 00:03:12.430
in other words, capitalizing
the first letter.

69
00:03:12.430 --> 00:03:16.320
Absolutely brilliant. If I
click okay, there's my column.

70
00:03:16.320 --> 00:03:18.275
That's a great way

71
00:03:18.275 --> 00:03:20.780
of transforming data that's

72
00:03:20.780 --> 00:03:22.705
in a slightly trickier format.

73
00:03:22.705 --> 00:03:24.110
All right. That was one option.

74
00:03:24.110 --> 00:03:25.430
We're not actually
going to use that one.

75
00:03:25.430 --> 00:03:26.540
On the right-hand side,

76
00:03:26.540 --> 00:03:28.160
can you delete that last step

77
00:03:28.160 --> 00:03:30.590
and delete the change
type while we're at it.

78
00:03:30.590 --> 00:03:33.380
Let's have a look at
some other options.

79
00:03:33.380 --> 00:03:35.840
If you wanted to use
something equivalent to

80
00:03:35.840 --> 00:03:38.420
the Left - Right - Mid
functions in Excel,

81
00:03:38.420 --> 00:03:41.315
we have an option called extract.

82
00:03:41.315 --> 00:03:43.100
You'll find this option on

83
00:03:43.100 --> 00:03:46.635
the Add Column ribbon and
on the Transform ribbon,

84
00:03:46.635 --> 00:03:48.905
but they are actually
slightly different.

85
00:03:48.905 --> 00:03:53.749
This group of tools when used
from the Transform ribbon,

86
00:03:53.749 --> 00:03:56.140
will actually transform
the existing column.

87
00:03:56.140 --> 00:03:57.710
In other words, if I extract,

88
00:03:57.710 --> 00:04:00.050
I'll just be left with
the extracted data.

89
00:04:00.050 --> 00:04:03.200
If on the other hand I do it
on the Add column ribbon,

90
00:04:03.200 --> 00:04:05.060
then it will leave
the original column

91
00:04:05.060 --> 00:04:08.785
intact and add another one
with the extracted data.

92
00:04:08.785 --> 00:04:11.140
For this example, that's
the option I want,

93
00:04:11.140 --> 00:04:12.995
so I'm selecting Cost Center.

94
00:04:12.995 --> 00:04:15.980
I'm going to come to Extract
and let's say I want to get

95
00:04:15.980 --> 00:04:19.130
the 5-digit cost center code,

96
00:04:19.130 --> 00:04:21.350
that's the last characters,

97
00:04:21.350 --> 00:04:23.440
so I select last,

98
00:04:23.440 --> 00:04:29.250
type five, and press enter
and there's my cost center.

99
00:04:29.250 --> 00:04:33.640
Another really easy way
of separating data sets.

100
00:04:33.640 --> 00:04:35.990
Again, that's not actually
option we're going to use,

101
00:04:35.990 --> 00:04:37.945
so I'm just going to
remove that step.

102
00:04:37.945 --> 00:04:40.230
Now let's do it for real.

103
00:04:40.230 --> 00:04:42.815
We are going to come to
the Transform ribbon again

104
00:04:42.815 --> 00:04:46.010
and the option we're going
to use is Split Column.

105
00:04:46.010 --> 00:04:49.700
If I click the drop down as
well as the normal options,

106
00:04:49.700 --> 00:04:52.175
there's some really
exciting new ones.

107
00:04:52.175 --> 00:04:56.190
The one we need is
lowercase to uppercase.

108
00:04:56.190 --> 00:04:58.700
This is effectively going
to do exactly what we

109
00:04:58.700 --> 00:05:01.870
did with our first example,

110
00:05:01.870 --> 00:05:05.010
but we're not telling
it what the pattern is.

111
00:05:05.010 --> 00:05:06.610
I'm going to click
my lowercase to

112
00:05:06.610 --> 00:05:08.910
uppercase and you can see it

113
00:05:08.910 --> 00:05:10.830
has split it out
perfectly and all I

114
00:05:10.830 --> 00:05:12.930
need to do is rename this column.

115
00:05:12.930 --> 00:05:14.450
Coming into my M code,

116
00:05:14.450 --> 00:05:16.400
I'm going to select Cost
Center one and call

117
00:05:16.400 --> 00:05:20.890
that Branch and press Enter.

118
00:05:20.890 --> 00:05:23.645
Costs Center two, this column,

119
00:05:23.645 --> 00:05:25.260
I need to split it again.

120
00:05:25.260 --> 00:05:29.165
Let's select It. We're going
to come to Split Column.

121
00:05:29.165 --> 00:05:35.220
This time I want to go
from non-digit to digit.

122
00:05:35.270 --> 00:05:37.605
Again, too easy.

123
00:05:37.605 --> 00:05:39.400
Lets us give those
columns sensible names,

124
00:05:39.400 --> 00:05:40.615
so I'm expanding that.

125
00:05:40.615 --> 00:05:44.450
We'll call Cost Center
2.1 department.

126
00:05:45.650 --> 00:05:48.420
This last one, we'll call

127
00:05:48.420 --> 00:05:52.020
Cost Center Code and press

128
00:05:52.020 --> 00:05:55.180
"Enter" and then I'm just
going to tuck that away again,

129
00:05:55.180 --> 00:06:00.420
and now, we are ready to
merge our two queries.

130
00:06:00.890 --> 00:06:03.450
Coming to our "Home" ribbon,

131
00:06:03.450 --> 00:06:05.580
we're going to find
"Merge Queries" and we

132
00:06:05.580 --> 00:06:07.845
are going to just
change this query.

133
00:06:07.845 --> 00:06:09.810
So we're going to click
on the main part of

134
00:06:09.810 --> 00:06:13.440
the button and it's put my
budget one on the left,

135
00:06:13.440 --> 00:06:15.945
which is great, and if
you click the "Dropdown",

136
00:06:15.945 --> 00:06:19.215
the other query we
need is "Enrollments".

137
00:06:19.215 --> 00:06:21.780
It is a left outer and join.

138
00:06:21.780 --> 00:06:24.195
We actually need to
match two columns,

139
00:06:24.195 --> 00:06:26.040
so I'm going to
select "Branch" and

140
00:06:26.040 --> 00:06:28.830
"Branch" and then holding
my "Control" key,

141
00:06:28.830 --> 00:06:31.755
I'm going to select
"Department" and "Department",

142
00:06:31.755 --> 00:06:34.510
and I'm going to click "Okay".

143
00:06:34.760 --> 00:06:37.260
Remember we need to
expand that out,

144
00:06:37.260 --> 00:06:38.745
so coming to the
Enrollments column,

145
00:06:38.745 --> 00:06:40.515
I'm going to click
the "Expand" button.

146
00:06:40.515 --> 00:06:42.180
I don't want all the columns,

147
00:06:42.180 --> 00:06:45.630
I just want Jun spend and
I don't want it prefixed,

148
00:06:45.630 --> 00:06:47.940
and then click "Okay".

149
00:06:47.940 --> 00:06:49.935
Small problem.

150
00:06:49.935 --> 00:06:53.025
Doesn't seem to have
found any matches.

151
00:06:53.025 --> 00:06:55.350
The reason for that is that

152
00:06:55.350 --> 00:06:58.755
the case for both branch
and department don't match.

153
00:06:58.755 --> 00:07:03.090
Be aware a merge query
is case sensitive.

154
00:07:03.090 --> 00:07:05.940
Somehow I need to
change the case for

155
00:07:05.940 --> 00:07:07.530
these two columns
and I need to do

156
00:07:07.530 --> 00:07:09.510
it before I do the merge.

157
00:07:09.510 --> 00:07:11.130
On the right-hand side,

158
00:07:11.130 --> 00:07:14.790
can you click the step
above the merge queries?

159
00:07:14.790 --> 00:07:16.920
We're then going to
select "Branch",

160
00:07:16.920 --> 00:07:17.970
hold that "Shift" key down

161
00:07:17.970 --> 00:07:20.385
and select "Department" as well.

162
00:07:20.385 --> 00:07:23.460
Then coming to our
Transform ribbon,

163
00:07:23.460 --> 00:07:25.590
we don't want new columns,

164
00:07:25.590 --> 00:07:27.570
we want to keep these
two existing ones,

165
00:07:27.570 --> 00:07:29.400
but we want to change the Format.

166
00:07:29.400 --> 00:07:31.065
So I'm going to select "Format"

167
00:07:31.065 --> 00:07:34.320
and we're going to
capitalize each word.

168
00:07:34.320 --> 00:07:36.630
It's warning us about
the insert step.

169
00:07:36.630 --> 00:07:39.360
That's fine. We're going
to click "Insert".

170
00:07:39.360 --> 00:07:41.550
Columns converted.

171
00:07:41.550 --> 00:07:43.680
If you click back
on your last step,

172
00:07:43.680 --> 00:07:45.660
"Expanded Enrollments", it has

173
00:07:45.660 --> 00:07:48.240
now found the match,
which is great.

174
00:07:48.240 --> 00:07:49.650
You will notice where it didn't

175
00:07:49.650 --> 00:07:51.210
find the match,
it's put the null,

176
00:07:51.210 --> 00:07:53.010
and sometimes we can ignore this,

177
00:07:53.010 --> 00:07:54.900
but I want to do arithmetic now.

178
00:07:54.900 --> 00:07:56.775
I want to add up
April, May and June,

179
00:07:56.775 --> 00:07:59.655
and null does not
behave like a zero.

180
00:07:59.655 --> 00:08:01.500
If I try and add these values,

181
00:08:01.500 --> 00:08:03.285
I'm actually going to
end up with a null.

182
00:08:03.285 --> 00:08:05.700
Here again, I'm going to need
to make a little change,

183
00:08:05.700 --> 00:08:08.415
I'm going to need to replace
all the nulls with zeros.

184
00:08:08.415 --> 00:08:11.625
We'll do it for all three of
these columns just in case.

185
00:08:11.625 --> 00:08:13.350
So from April to June,

186
00:08:13.350 --> 00:08:15.780
we're then going to
come up to "Transform",

187
00:08:15.780 --> 00:08:18.880
we're going to find
"Replace Values",

188
00:08:19.070 --> 00:08:21.945
and we're going to replace nulls

189
00:08:21.945 --> 00:08:25.620
with zero and click "Okay".

190
00:08:25.620 --> 00:08:28.365
We're now ready to add up

191
00:08:28.365 --> 00:08:30.945
our monthly spent to get
our quarterly spend.

192
00:08:30.945 --> 00:08:33.225
For this we're going to
need another new column.

193
00:08:33.225 --> 00:08:34.965
Coming to our "Add column",

194
00:08:34.965 --> 00:08:36.810
we're going to choose "Custom

195
00:08:36.810 --> 00:08:42.345
Column" and custom columns
allow us to do calculations.

196
00:08:42.345 --> 00:08:43.950
So we're going to call this Q2

197
00:08:43.950 --> 00:08:48.630
Spend and in the Formula box,

198
00:08:48.630 --> 00:08:51.510
we're going to double
click "April Spend",

199
00:08:51.510 --> 00:08:54.045
then plus, double-click "May",

200
00:08:54.045 --> 00:08:55.845
plus, double-click "June",

201
00:08:55.845 --> 00:08:58.560
and don't put another
plus or it will error,

202
00:08:58.560 --> 00:09:01.470
and then we'll click "Okay".

203
00:09:01.470 --> 00:09:03.825
We've now got our total spend.

204
00:09:03.825 --> 00:09:05.505
One last thing to do,

205
00:09:05.505 --> 00:09:08.820
and that's to work out if
we've gone over budget.

206
00:09:08.820 --> 00:09:10.650
Now, we could still use

207
00:09:10.650 --> 00:09:13.545
custom column with
an if statement,

208
00:09:13.545 --> 00:09:15.180
but we have a newer and

209
00:09:15.180 --> 00:09:18.900
even easier option called
a conditional column.

210
00:09:18.900 --> 00:09:21.075
We're going to click on
the "Conditional Column",

211
00:09:21.075 --> 00:09:24.105
and what this does is
an if statement for us.

212
00:09:24.105 --> 00:09:26.565
We can't use this
to do arithmetic,

213
00:09:26.565 --> 00:09:29.535
but it's brilliant
for conditions.

214
00:09:29.535 --> 00:09:32.710
We're going to call
this Over Budget

215
00:09:34.070 --> 00:09:39.779
and we're going to
check if our Q2 Spend,

216
00:09:39.779 --> 00:09:43.560
and then for operator we
want is greater than.

217
00:09:43.560 --> 00:09:46.515
Now, I could type a
value in here or,

218
00:09:46.515 --> 00:09:49.260
and this is what we
want, select a "Column".

219
00:09:49.260 --> 00:09:53.010
The column we want is
our Quarterly Budget.

220
00:09:53.010 --> 00:09:54.900
If it is over,

221
00:09:54.900 --> 00:09:57.450
then we actually want
to see the text over.

222
00:09:57.450 --> 00:10:00.150
Now, you could add
another clause and

223
00:10:00.150 --> 00:10:02.790
you can even specify what
to do if it's not true.

224
00:10:02.790 --> 00:10:05.415
If you don't specify
this, it puts a null.

225
00:10:05.415 --> 00:10:09.660
If you click "Okay", you'll
see wherever we've gone over,

226
00:10:09.660 --> 00:10:12.150
and otherwise, we get a null.

227
00:10:12.150 --> 00:10:14.055
That's a completed query.

228
00:10:14.055 --> 00:10:16.095
We now ready to close and load.

229
00:10:16.095 --> 00:10:18.930
Back to our "Home"
ribbon, close and load,

230
00:10:18.930 --> 00:10:21.000
close and load too.

231
00:10:21.000 --> 00:10:23.550
We're going to choose "Existing

232
00:10:23.550 --> 00:10:26.800
Worksheet" and click "Okay".

233
00:10:27.590 --> 00:10:30.360
There's our completed budget.

234
00:10:30.360 --> 00:10:34.080
That completes our section
on power query but

235
00:10:34.080 --> 00:10:35.340
next week we'll look at

236
00:10:35.340 --> 00:10:38.955
some other really exciting
topics with Power Pivot,

237
00:10:38.955 --> 00:10:41.100
the data model and DEX.

238
00:10:41.100 --> 00:10:43.660
Look forward to seeing you there.