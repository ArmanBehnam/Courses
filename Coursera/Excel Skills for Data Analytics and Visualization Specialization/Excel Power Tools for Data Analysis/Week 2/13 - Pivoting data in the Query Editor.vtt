WEBVTT

1
00:00:00.138 --> 00:00:05.758
[MUSIC]

2
00:00:05.758 --> 00:00:11.953
In this video, we're going to see how we
can pivot data using the Query Editor.

3
00:00:11.953 --> 00:00:17.021
When we talk about pivoting data,
we generally mean restructuring and

4
00:00:17.021 --> 00:00:19.813
summarizing data to produce a report.

5
00:00:19.813 --> 00:00:23.207
We usually do this using a pivot table,
and to be honest,

6
00:00:23.207 --> 00:00:25.199
that's generally the best way.

7
00:00:25.199 --> 00:00:28.811
But we can also pivot data
in the Query Editor, and

8
00:00:28.811 --> 00:00:31.310
it does have certain advantages.

9
00:00:31.310 --> 00:00:36.157
For example, if you are trying to
pivot that data as part of a clean or

10
00:00:36.157 --> 00:00:41.619
append operation, it'd be better to do
it right there in the Query Editor.

11
00:00:41.619 --> 00:00:47.460
The Query Editor also offers us one
feature that regular pivots don't.

12
00:00:47.460 --> 00:00:53.078
For example, looking at our data here,
we have a list of training rooms and

13
00:00:53.078 --> 00:00:56.124
what facilities are available in each.

14
00:00:56.124 --> 00:00:59.336
Now, this data is well laid out for
performing analytics, but

15
00:00:59.336 --> 00:01:01.941
it's actually quite hard
to glance at this data and

16
00:01:01.941 --> 00:01:04.750
quickly see which feature's
available in each room.

17
00:01:04.750 --> 00:01:08.479
So we would actually
like to pivot this data.

18
00:01:08.479 --> 00:01:12.252
In other words,
we'd like to take each unique facility and

19
00:01:12.252 --> 00:01:16.789
make it a column heading, and
then list the availability underneath.

20
00:01:16.789 --> 00:01:21.662
Now, the problem with trying to do this
with a regular pivot table is regular

21
00:01:21.662 --> 00:01:25.483
pivots are designed for
summarizing or aggregating data.

22
00:01:25.483 --> 00:01:31.741
In other words, it's going to try and
sum or count, in this case, my features.

23
00:01:31.741 --> 00:01:33.227
And that's not really what I want.

24
00:01:33.227 --> 00:01:37.926
I want to be able to actually see
the values, I want to see fixture or

25
00:01:37.926 --> 00:01:38.872
on request.

26
00:01:38.872 --> 00:01:44.041
A regular pivot table can't help me
with this, but Query Editor can.

27
00:01:44.041 --> 00:01:45.144
Let's see how it's done.

28
00:01:45.144 --> 00:01:49.180
We're going to click into our data,
we're going to come to our data ribbon,

29
00:01:49.180 --> 00:01:51.638
and we're going to click From Table/Range.

30
00:01:55.499 --> 00:01:59.979
The next thing we need to do is decide
which column it is we're trying to pivot.

31
00:01:59.979 --> 00:02:04.357
In other words, which column are we
going to turn into our column headings?

32
00:02:04.357 --> 00:02:05.816
And that's going to be our facility.

33
00:02:05.816 --> 00:02:07.562
So we're just going to select it.

34
00:02:07.562 --> 00:02:11.389
We're then going to come
to our transform ribbon and

35
00:02:11.389 --> 00:02:15.681
we're going to find
the Pivot Column button and click.

36
00:02:15.681 --> 00:02:19.897
This is telling us that it's going to use
the names in the column Facility to create

37
00:02:19.897 --> 00:02:22.232
new columns,
which is exactly what we want.

38
00:02:22.232 --> 00:02:27.141
But it's going to put the location in
as values, and that's not what we want.

39
00:02:27.141 --> 00:02:31.032
So we're going to click the drop down and
choose Available.

40
00:02:31.032 --> 00:02:35.720
Now, by default, this is still going
to do an aggregation or summary.

41
00:02:35.720 --> 00:02:37.376
And I'd like you to see
what that looks like.

42
00:02:37.376 --> 00:02:39.862
So we're going to click OK.

43
00:02:39.862 --> 00:02:44.998
And you can see it's actually counted
whether that facility is available or not.

44
00:02:44.998 --> 00:02:49.198
And that's not really helpful because
I need to see if it's a fixture or

45
00:02:49.198 --> 00:02:50.885
only available on request.

46
00:02:50.885 --> 00:02:52.577
So let's go and change that step.

47
00:02:52.577 --> 00:02:54.880
We're going to come to
the right-hand side and

48
00:02:54.880 --> 00:02:57.374
you'll see a little cog
next to Pivoted Column.

49
00:02:57.374 --> 00:03:02.504
We're going to click on that cog, and
that brings us back into our dialogue.

50
00:03:02.504 --> 00:03:05.266
Now, this time,
we're going to come to Advanced options.

51
00:03:05.266 --> 00:03:07.388
You'll see a little white
triangle to the left.

52
00:03:07.388 --> 00:03:09.445
If you click on that, it will expand.

53
00:03:09.445 --> 00:03:13.278
And you can see here's the problem,
it's doing count all.

54
00:03:13.278 --> 00:03:18.116
If we click the drop down, however,
here's the amazing feature that

55
00:03:18.116 --> 00:03:22.549
we don't have in regular pivots,
the option to not aggregate.

56
00:03:22.549 --> 00:03:25.317
In other words, return the actual values.

57
00:03:25.317 --> 00:03:29.938
We're going to select that and
then say OK.

58
00:03:29.938 --> 00:03:32.858
And there is our pivoted data.

59
00:03:32.858 --> 00:03:34.402
We're now ready to close and load.

60
00:03:34.402 --> 00:03:38.346
So I'm going to click my
Home ribbon > Close & Load.

61
00:03:38.346 --> 00:03:40.190
We'll just put it into a new worksheet.

62
00:03:40.190 --> 00:03:41.691
Let's give the sheet sensible name.

63
00:03:41.691 --> 00:03:45.352
So I'm going to double-click and
we're going to call this Room Facilities.

64
00:03:52.019 --> 00:03:56.988
And what we've seen there is how
we can use the Query Editor to

65
00:03:56.988 --> 00:04:00.016
pivot data without aggregating it.

66
00:04:00.016 --> 00:04:02.616
In the next video,
we're going to see another way of

67
00:04:02.616 --> 00:04:05.526
summarizing data in the Query Editor,
called grouping.