WEBVTT

1
00:00:04.820 --> 00:00:08.070
In this video, we're
going to see how we can

2
00:00:08.070 --> 00:00:11.115
use Power Query to group data.

3
00:00:11.115 --> 00:00:14.055
Very often, we need
to summarize data

4
00:00:14.055 --> 00:00:17.880
without necessarily
applying a pivot operation.

5
00:00:17.880 --> 00:00:20.910
For example, to help
with our budgeting,

6
00:00:20.910 --> 00:00:22.710
we need to work out how much

7
00:00:22.710 --> 00:00:24.945
we've spent on
training this month.

8
00:00:24.945 --> 00:00:27.660
We need to take our
enrollment data

9
00:00:27.660 --> 00:00:30.170
and actually add up the number of

10
00:00:30.170 --> 00:00:32.795
days we've spent on training by

11
00:00:32.795 --> 00:00:36.010
each department
within each branch.

12
00:00:36.010 --> 00:00:38.490
We can do this using the group

13
00:00:38.490 --> 00:00:41.035
by function in the Query Editor.

14
00:00:41.035 --> 00:00:44.000
Let's start by clicking
into our data.

15
00:00:44.000 --> 00:00:45.680
We're then going to come to

16
00:00:45.680 --> 00:00:49.980
our "data tab and
from table or range.

17
00:00:51.620 --> 00:00:54.500
The first thing we
need to do is select

18
00:00:54.500 --> 00:00:57.785
the column or columns
that we want to group by.

19
00:00:57.785 --> 00:00:59.480
Now we're going to start by just

20
00:00:59.480 --> 00:01:01.010
selecting the branch column,

21
00:01:01.010 --> 00:01:03.685
although we could select
department as well.

22
00:01:03.685 --> 00:01:06.080
I'm then going to come
up to my home ribbon

23
00:01:06.080 --> 00:01:08.670
and click "Group By".

24
00:01:10.550 --> 00:01:13.425
If you have the newer version,

25
00:01:13.425 --> 00:01:15.050
you will notice that it gives you

26
00:01:15.050 --> 00:01:17.330
the option to do
a basic grouping,

27
00:01:17.330 --> 00:01:20.075
which only allows you
to group on one field.

28
00:01:20.075 --> 00:01:22.325
If you want to group
by multiple fields,

29
00:01:22.325 --> 00:01:24.260
just click the advanced button

30
00:01:24.260 --> 00:01:26.135
and we can now add a grouping.

31
00:01:26.135 --> 00:01:28.805
In older versions, you'll
see a little plus,

32
00:01:28.805 --> 00:01:30.620
which will also allow you to add

33
00:01:30.620 --> 00:01:32.780
another group level.
Let's do that.

34
00:01:32.780 --> 00:01:34.780
Click "The plus" or
the "Add Grouping"

35
00:01:34.780 --> 00:01:38.325
and we also want
group by department.

36
00:01:38.325 --> 00:01:40.100
Come down to the next section.

37
00:01:40.100 --> 00:01:42.020
We want to call our new column,

38
00:01:42.020 --> 00:01:44.400
add days training,

39
00:01:45.080 --> 00:01:48.450
and then we need to
choose our operation,

40
00:01:48.450 --> 00:01:51.155
and the selection is
quite interesting.

41
00:01:51.155 --> 00:01:53.770
For one thing, we
can use a median.

42
00:01:53.770 --> 00:01:57.035
Now that's not available in
traditional pivot tables.

43
00:01:57.035 --> 00:01:59.240
The other one that's
very interesting,

44
00:01:59.240 --> 00:02:01.415
is the count distinct.

45
00:02:01.415 --> 00:02:05.255
This allows you to count
unique values only.

46
00:02:05.255 --> 00:02:07.715
For example, if I
wanted to find out

47
00:02:07.715 --> 00:02:08.960
how many people had

48
00:02:08.960 --> 00:02:11.105
attended training
for each department,

49
00:02:11.105 --> 00:02:14.045
I wouldn't want to
count Adrianna twice.

50
00:02:14.045 --> 00:02:16.880
The count distinct
can help with this.

51
00:02:16.880 --> 00:02:19.445
Now for our problem,
we need a sum.

52
00:02:19.445 --> 00:02:21.185
We're going to select "Sum",

53
00:02:21.185 --> 00:02:25.260
and the column which want
to add up, is our days.

54
00:02:25.260 --> 00:02:27.905
We're now going to click "Okay",

55
00:02:27.905 --> 00:02:30.300
and there's our groups data.

56
00:02:30.300 --> 00:02:33.075
Hang on though,
one small problem.

57
00:02:33.075 --> 00:02:36.540
We seem to have
Sidney sales twice.

58
00:02:36.540 --> 00:02:38.655
Now why would that happen?

59
00:02:38.655 --> 00:02:40.280
It's unlikely to be an error

60
00:02:40.280 --> 00:02:42.190
with the group operation itself.

61
00:02:42.190 --> 00:02:44.435
It's more likely that actually

62
00:02:44.435 --> 00:02:47.165
one of these values
isn't just sales,

63
00:02:47.165 --> 00:02:49.670
but sales followed by
another character.

64
00:02:49.670 --> 00:02:52.700
If I click the "Little drop
down" next to department,

65
00:02:52.700 --> 00:02:54.290
you'll see there're
two instances,

66
00:02:54.290 --> 00:02:57.755
which tells me that although
both looks like sales to us,

67
00:02:57.755 --> 00:02:59.535
clearly to the Query Editor,

68
00:02:59.535 --> 00:03:01.575
one of these values is different.

69
00:03:01.575 --> 00:03:04.730
Now you can check it out
in the query editor.

70
00:03:04.730 --> 00:03:07.010
If I actually click onto the cell

71
00:03:07.010 --> 00:03:08.420
and then come down to where to

72
00:03:08.420 --> 00:03:10.085
sales and click just after,

73
00:03:10.085 --> 00:03:12.800
you can see my cursor is directly

74
00:03:12.800 --> 00:03:16.170
against the S. That tells me
that actually says sales.

75
00:03:16.170 --> 00:03:18.810
But if I click into this value,

76
00:03:18.810 --> 00:03:21.960
and click after, you can
see there's a gap there.

77
00:03:21.960 --> 00:03:24.435
So, it's probably a space.

78
00:03:24.435 --> 00:03:26.030
That's the most common reason,

79
00:03:26.030 --> 00:03:27.830
but it could be something else.

80
00:03:27.830 --> 00:03:29.390
Now how do we get rid of it?

81
00:03:29.390 --> 00:03:30.770
Because we can't
just delete it here.

82
00:03:30.770 --> 00:03:32.285
We can't edit the data.

83
00:03:32.285 --> 00:03:36.415
But there is an option
to replace values.

84
00:03:36.415 --> 00:03:38.180
We are going to have to do this,

85
00:03:38.180 --> 00:03:40.640
however, before we
do the grouping.

86
00:03:40.640 --> 00:03:42.410
In our plight steps,

87
00:03:42.410 --> 00:03:44.810
we're going to come
back to changed type,

88
00:03:44.810 --> 00:03:47.995
which was the last step
before we group the data.

89
00:03:47.995 --> 00:03:51.560
Now we're going to select the
department column because

90
00:03:51.560 --> 00:03:55.190
that's the only column we want
to replace the values in.

91
00:03:55.190 --> 00:03:59.245
Then we're going to come
to "Replace values",

92
00:03:59.245 --> 00:04:02.360
and it's going to warn us
that we inserting a step.

93
00:04:02.360 --> 00:04:03.950
Now do keep an eye
on that because

94
00:04:03.950 --> 00:04:05.525
you don't want to
do this by mistake.

95
00:04:05.525 --> 00:04:07.730
But this is exactly
what we want to do,

96
00:04:07.730 --> 00:04:10.015
so we are going to
click "Insert".

97
00:04:10.015 --> 00:04:12.645
I'm looking for a space,

98
00:04:12.645 --> 00:04:14.925
and I want to replace
that with nothing.

99
00:04:14.925 --> 00:04:16.190
I'm just going to leave that box

100
00:04:16.190 --> 00:04:18.845
empty and I'm going
to click "Okay".

101
00:04:18.845 --> 00:04:21.125
Now let's check if
that has worked.

102
00:04:21.125 --> 00:04:26.575
Clicking back on are grouped
rows step, it has not.

103
00:04:26.575 --> 00:04:29.445
It was a good guess
but it wasn't correct.

104
00:04:29.445 --> 00:04:31.280
At this stage, I'll probably go

105
00:04:31.280 --> 00:04:33.230
back to the data and use some of

106
00:04:33.230 --> 00:04:35.000
the data cleaning tools we looked

107
00:04:35.000 --> 00:04:37.370
at in the first course
in the specialization,

108
00:04:37.370 --> 00:04:40.715
to identify what
that character was.

109
00:04:40.715 --> 00:04:42.740
In this scenario, however,

110
00:04:42.740 --> 00:04:44.705
we have had this problem before,

111
00:04:44.705 --> 00:04:47.885
and usually it's a
non breaking space.

112
00:04:47.885 --> 00:04:50.495
We're going to give
that a trial instead.

113
00:04:50.495 --> 00:04:53.855
Coming back to our
replaced value step,

114
00:04:53.855 --> 00:04:55.595
we are going to click
on the little cog

115
00:04:55.595 --> 00:04:57.860
to open up the dialogue again.

116
00:04:57.860 --> 00:05:00.260
We've decided not to do a space.

117
00:05:00.260 --> 00:05:02.255
I'm going to backspace, instead,

118
00:05:02.255 --> 00:05:04.100
we need a non breaking space.

119
00:05:04.100 --> 00:05:08.135
But how do we go about typing
in a non breaking space?

120
00:05:08.135 --> 00:05:11.070
This is where the advanced
options can help us.

121
00:05:11.070 --> 00:05:12.080
I'm going to click

122
00:05:12.080 --> 00:05:15.215
the little white arrow
to expand those.

123
00:05:15.215 --> 00:05:16.700
Then we're going to select

124
00:05:16.700 --> 00:05:19.150
replace using special characters.

125
00:05:19.150 --> 00:05:21.530
If you look at the
drop down list,

126
00:05:21.530 --> 00:05:24.470
there are couple
of usual suspects

127
00:05:24.470 --> 00:05:27.635
and the one we want is
our non breaking space.

128
00:05:27.635 --> 00:05:31.285
We are going to select
that, and click "Okay".

129
00:05:31.285 --> 00:05:34.860
Now if I come back
to my grouped rows,

130
00:05:34.860 --> 00:05:37.665
the problem has been fixed.

131
00:05:37.665 --> 00:05:39.920
Final step, let's do

132
00:05:39.920 --> 00:05:41.360
the calculation to work out

133
00:05:41.360 --> 00:05:43.525
how much that is
actually costing us.

134
00:05:43.525 --> 00:05:47.400
It is $550 per day of training.

135
00:05:47.400 --> 00:05:48.990
But unlike Excel, I can't

136
00:05:48.990 --> 00:05:50.820
just come in here
and start typing.

137
00:05:50.820 --> 00:05:52.550
What I can do however,

138
00:05:52.550 --> 00:05:54.095
is add a column.

139
00:05:54.095 --> 00:05:56.615
Coming to our "Add
column ribbon",

140
00:05:56.615 --> 00:05:59.115
we're going to choose
"Custom column",

141
00:05:59.115 --> 00:06:02.380
which is ideal for
doing calculation.

142
00:06:02.970 --> 00:06:06.655
We're going to call a
new column June spend.

143
00:06:06.655 --> 00:06:09.230
I'm just going to
abbreviate June.

144
00:06:09.320 --> 00:06:12.230
Then we're going to click
in the "Formula box",

145
00:06:12.230 --> 00:06:13.930
and to do our calculation,

146
00:06:13.930 --> 00:06:15.835
we're going to
select days training

147
00:06:15.835 --> 00:06:18.560
from the available columns.
That's a double click.

148
00:06:18.560 --> 00:06:22.485
Then I'm going to
multiply by 550.

149
00:06:22.485 --> 00:06:25.120
When I click "Okay",

150
00:06:25.140 --> 00:06:30.275
there is my total June spend
by department within branch.

151
00:06:30.275 --> 00:06:32.905
We are going to use this data

152
00:06:32.905 --> 00:06:35.650
in the next video to
complete our budget.

153
00:06:35.650 --> 00:06:38.575
But we don't actually need
to load it back into Excel.

154
00:06:38.575 --> 00:06:41.270
Coming back to the "Home ribbon",

155
00:06:41.390 --> 00:06:44.820
we're going to click the drop
down for "Close and Load",

156
00:06:44.820 --> 00:06:46.955
"Close and Load to",

157
00:06:46.955 --> 00:06:50.495
and we're going to create
a connection only,

158
00:06:50.495 --> 00:06:53.160
and then click "Okay".

159
00:06:53.810 --> 00:06:57.080
In this video, we
saw not only how

160
00:06:57.080 --> 00:06:59.675
to use the group by
tool and Query Editor,

161
00:06:59.675 --> 00:07:02.435
but also how to add
a custom column.

162
00:07:02.435 --> 00:07:03.920
In the next video,

163
00:07:03.920 --> 00:07:05.420
we're going to focus on

164
00:07:05.420 --> 00:07:09.870
transforming and adding
columns in the Query Editor.