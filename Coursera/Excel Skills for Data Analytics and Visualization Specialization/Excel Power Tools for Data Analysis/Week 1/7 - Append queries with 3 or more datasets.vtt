WEBVTT

1
00:00:04.850 --> 00:00:09.300
In this video, we're going to
create an Append Query that

2
00:00:09.300 --> 00:00:13.785
pulls data from three or
more external data sources.

3
00:00:13.785 --> 00:00:16.350
One of the more
common issues we run

4
00:00:16.350 --> 00:00:18.090
into with Excel is when

5
00:00:18.090 --> 00:00:21.990
the dataset has been split
over multiple worksheet tabs.

6
00:00:21.990 --> 00:00:23.610
This may make sense from

7
00:00:23.610 --> 00:00:25.200
the organizational point of view,

8
00:00:25.200 --> 00:00:26.940
but it does make
it very difficult

9
00:00:26.940 --> 00:00:28.980
to work with the data as a whole.

10
00:00:28.980 --> 00:00:30.990
We're going to look
at how we can solve

11
00:00:30.990 --> 00:00:33.850
that problem using Power Query.

12
00:00:35.300 --> 00:00:38.420
In this scenario, we

13
00:00:38.420 --> 00:00:40.640
have a brand new online
training system,

14
00:00:40.640 --> 00:00:45.760
but it produces the weekly
training report as a PDF file.

15
00:00:45.760 --> 00:00:48.485
Now previously, this
would have been

16
00:00:48.485 --> 00:00:51.995
a fairly tricky problem to
get that data into Excel.

17
00:00:51.995 --> 00:00:53.540
But in the newer versions,

18
00:00:53.540 --> 00:00:57.950
you can actually pull data
into Excel from a PDF.

19
00:00:57.950 --> 00:01:01.445
If however that PDF is
over multiple pages,

20
00:01:01.445 --> 00:01:04.235
you will need to
append those queries,

21
00:01:04.235 --> 00:01:06.430
and that's what we're
going to do now.

22
00:01:06.430 --> 00:01:08.685
I'm going to minimize that,

23
00:01:08.685 --> 00:01:11.120
and back in our
original workbook,

24
00:01:11.120 --> 00:01:13.240
we're going to get data.

25
00:01:13.240 --> 00:01:14.270
In the older version,

26
00:01:14.270 --> 00:01:15.725
you're going to click New Query,

27
00:01:15.725 --> 00:01:17.090
and in the new aversion,

28
00:01:17.090 --> 00:01:20.240
you're going to click
Get Data and from file.

29
00:01:20.240 --> 00:01:22.400
Now, if you have
the option to get

30
00:01:22.400 --> 00:01:24.440
from PDF, please choose that.

31
00:01:24.440 --> 00:01:26.450
If you don't not a problem,

32
00:01:26.450 --> 00:01:28.100
you can choose from workbook and

33
00:01:28.100 --> 00:01:30.050
go through almost exactly
the same process,

34
00:01:30.050 --> 00:01:31.190
except you're going
to pull it from

35
00:01:31.190 --> 00:01:33.685
different tabs in a workbook.

36
00:01:33.685 --> 00:01:36.495
Choose whichever
option is appropriate,

37
00:01:36.495 --> 00:01:38.820
and navigate to your workbooks.

38
00:01:38.820 --> 00:01:40.950
You have two online
training reports,

39
00:01:40.950 --> 00:01:42.395
and again, if you're
working with PDF,

40
00:01:42.395 --> 00:01:43.640
make sure you get the PDF.

41
00:01:43.640 --> 00:01:44.975
If you're working with Excel,

42
00:01:44.975 --> 00:01:48.630
choose the Excel and
double-click to select.

43
00:01:49.760 --> 00:01:54.525
If you're getting data from
an external Excel file,

44
00:01:54.525 --> 00:01:58.010
it will show you each of the
sheets within that file.

45
00:01:58.010 --> 00:01:59.885
But if you've created tables,

46
00:01:59.885 --> 00:02:01.100
it will give you the option to

47
00:02:01.100 --> 00:02:02.855
import it direct from the table,

48
00:02:02.855 --> 00:02:04.985
which is usually a clean option.

49
00:02:04.985 --> 00:02:07.700
With the PDF, we have
a similar scenario,

50
00:02:07.700 --> 00:02:10.100
it's showing me
each of the pages,

51
00:02:10.100 --> 00:02:12.530
but the pages contain headers and

52
00:02:12.530 --> 00:02:15.365
footers and a lot of
information I don't want.

53
00:02:15.365 --> 00:02:17.480
Amazingly, it also has

54
00:02:17.480 --> 00:02:20.755
recognized that they're
tables within those sheets,

55
00:02:20.755 --> 00:02:22.840
and so it allows maybe option

56
00:02:22.840 --> 00:02:24.735
to just import the table data.

57
00:02:24.735 --> 00:02:26.570
Whichever option you going with,

58
00:02:26.570 --> 00:02:28.640
we need to select multiple items.

59
00:02:28.640 --> 00:02:31.700
Please check the select
multiple items box,

60
00:02:31.700 --> 00:02:35.400
and then we're going to
select the three tables.

61
00:02:36.650 --> 00:02:39.840
We do need to make a
small transformation,

62
00:02:39.840 --> 00:02:43.000
so click Transform Data or Edit.

63
00:02:45.230 --> 00:02:47.670
In the Power Query Editor,

64
00:02:47.670 --> 00:02:51.575
what I'm seeing is a
preview of my first query,

65
00:02:51.575 --> 00:02:54.245
it hasn't appended the data yet.

66
00:02:54.245 --> 00:02:56.260
There is another step to go.

67
00:02:56.260 --> 00:02:57.830
I could close and load and do

68
00:02:57.830 --> 00:02:59.360
it the same way we
did it last time,

69
00:02:59.360 --> 00:03:02.990
but you can actually append
from within the Query Editor.

70
00:03:02.990 --> 00:03:06.265
I'm hoping you're looking for
the Append Queries button,

71
00:03:06.265 --> 00:03:08.180
I'm going to click
the dropdown and

72
00:03:08.180 --> 00:03:10.865
choose Append Queries as New.

73
00:03:10.865 --> 00:03:12.920
If I chose a Append Queries,

74
00:03:12.920 --> 00:03:15.140
it would actually change
my Table 1 query,

75
00:03:15.140 --> 00:03:16.415
which is not what I want.

76
00:03:16.415 --> 00:03:19.560
I'm going to create
a brand new query,

77
00:03:19.610 --> 00:03:23.450
and I need to get the data
from three or more tables,

78
00:03:23.450 --> 00:03:24.805
so I'm going to select three.

79
00:03:24.805 --> 00:03:28.470
It's already added in your
first query is a Table 1 then.

80
00:03:28.470 --> 00:03:32.055
To add Table 2, select
Table 2 and click Add.

81
00:03:32.055 --> 00:03:33.750
Alternatively, and
I'll do this with

82
00:03:33.750 --> 00:03:36.135
Table 3, you can
just double-click.

83
00:03:36.135 --> 00:03:38.280
When you've got all
your tables listed,

84
00:03:38.280 --> 00:03:40.840
you can click Okay.

85
00:03:41.330 --> 00:03:44.735
But something has gone
a little bit wrong.

86
00:03:44.735 --> 00:03:48.005
Remember we saw in the
previous video that it uses

87
00:03:48.005 --> 00:03:51.410
the column headings to choose
how to stack the data.

88
00:03:51.410 --> 00:03:53.675
Because these column
headings were different,

89
00:03:53.675 --> 00:03:55.550
it's created additional columns

90
00:03:55.550 --> 00:03:58.225
and padded out the
gaps with nulls.

91
00:03:58.225 --> 00:04:01.010
Fortunately, this is
really easily fixed.

92
00:04:01.010 --> 00:04:03.020
All we need to do is rename

93
00:04:03.020 --> 00:04:05.410
our column headings
in our other queries.

94
00:04:05.410 --> 00:04:08.070
Let's come to Table 2 first,

95
00:04:08.070 --> 00:04:10.020
and you'll see
there's the problem.

96
00:04:10.020 --> 00:04:15.255
We're going to change
Column 1 to be staff ID,

97
00:04:15.255 --> 00:04:21.940
and I'm going to change
Column 2 to be staff name,

98
00:04:22.340 --> 00:04:30.945
and Column 3 is going to be
status, and press enter.

99
00:04:30.945 --> 00:04:33.200
Having a look in
your formula bar,

100
00:04:33.200 --> 00:04:35.420
you can see a line
of M-code has been

101
00:04:35.420 --> 00:04:39.235
created to change all
the column headings.

102
00:04:39.235 --> 00:04:41.180
Now, wouldn't it be nice if

103
00:04:41.180 --> 00:04:42.875
rather than going through
this whole process,

104
00:04:42.875 --> 00:04:46.205
we could just copy that
line of code, well we can.

105
00:04:46.205 --> 00:04:48.170
Clicking into our formula bar,

106
00:04:48.170 --> 00:04:50.735
we're going to select
all of the code.

107
00:04:50.735 --> 00:04:53.905
I'm going to press
Control C to copy.

108
00:04:53.905 --> 00:04:57.480
They're not going
to come to Table 3,

109
00:04:57.480 --> 00:05:00.920
and I don't want to change
any of the existing steps,

110
00:05:00.920 --> 00:05:02.905
I need to add a new step.

111
00:05:02.905 --> 00:05:05.855
Making sure I have the
last step selected,

112
00:05:05.855 --> 00:05:07.385
which it will be by default.

113
00:05:07.385 --> 00:05:08.630
I'm going to come to

114
00:05:08.630 --> 00:05:11.390
my effects just to the
left of the formula bar,

115
00:05:11.390 --> 00:05:14.550
and single clicking on
that adds a new step.

116
00:05:14.550 --> 00:05:17.570
Now I can just
replace what's there

117
00:05:17.570 --> 00:05:21.450
Control V with my step to
change the column headings,

118
00:05:21.450 --> 00:05:22.685
and when I press Enter,

119
00:05:22.685 --> 00:05:24.770
you'll see that
it's done the job.

120
00:05:24.770 --> 00:05:26.390
We're starting to see how

121
00:05:26.390 --> 00:05:27.830
getting little more familiar with

122
00:05:27.830 --> 00:05:31.685
the M-code can help us work
a little more efficiently.

123
00:05:31.685 --> 00:05:34.220
Let's go back to
our Append Queries.

124
00:05:34.220 --> 00:05:35.480
On the left you can select

125
00:05:35.480 --> 00:05:38.550
your Append Query, all
beautifully fixed.

126
00:05:38.550 --> 00:05:41.510
Let's give it a sensible
names instead of Append,

127
00:05:41.510 --> 00:05:43.670
I'm going to call that report,

128
00:05:43.670 --> 00:05:45.860
and now I'm ready
to close and load.

129
00:05:45.860 --> 00:05:47.615
Back to close and load,

130
00:05:47.615 --> 00:05:49.625
close and load to.

131
00:05:49.625 --> 00:05:52.800
It's going to apply

132
00:05:52.800 --> 00:05:55.095
whatever I choose here
to all four tables.

133
00:05:55.095 --> 00:05:57.765
I'm going to choose
only create connection,

134
00:05:57.765 --> 00:06:00.405
and then I'm going to say, okay.

135
00:06:00.405 --> 00:06:03.915
Now on the right-hand side in
my Queries and Connections,

136
00:06:03.915 --> 00:06:06.855
you'll see here are
four new queries.

137
00:06:06.855 --> 00:06:10.430
But the report, I actually
want to come back into Excel.

138
00:06:10.430 --> 00:06:12.640
Good news is you can change

139
00:06:12.640 --> 00:06:15.160
your load options at any point.

140
00:06:15.160 --> 00:06:16.615
Coming back to our report,

141
00:06:16.615 --> 00:06:17.980
we're going to right-click,

142
00:06:17.980 --> 00:06:20.395
we're going to choose Load to,

143
00:06:20.395 --> 00:06:26.190
and I'm going to say
table in a new worksheet.

144
00:06:26.190 --> 00:06:28.965
Then we're going to click Okay,

145
00:06:28.965 --> 00:06:32.000
and there is our online
training report.

146
00:06:32.000 --> 00:06:35.675
The best part is when the new
report comes in next week,

147
00:06:35.675 --> 00:06:38.165
I just save it over
the old report,

148
00:06:38.165 --> 00:06:40.040
hit the refresh button,

149
00:06:40.040 --> 00:06:42.570
and this is up to date.

150
00:06:42.590 --> 00:06:45.045
We've had a look
at how we can use

151
00:06:45.045 --> 00:06:48.920
Append Queries to stack
datasets on top of each other.

152
00:06:48.920 --> 00:06:50.510
In the next video,

153
00:06:50.510 --> 00:06:52.760
we're going to have a look at
a different way of joining

154
00:06:52.760 --> 00:06:56.280
dataset called Emerge Query.