WEBVTT

1
00:00:05.679 --> 00:00:09.257
Earlier this week, we connected
to our online training report,

2
00:00:09.257 --> 00:00:12.963
which shows us which staff have taken
part in the online training and

3
00:00:12.963 --> 00:00:15.714
the online trainings
available to all the staff.

4
00:00:15.714 --> 00:00:20.090
But it is a requirement that
sales staff participate.

5
00:00:20.090 --> 00:00:24.599
We've been asked to create a report
that shows us all the sales staff who

6
00:00:24.599 --> 00:00:27.998
have participated and
what their current status is.

7
00:00:27.998 --> 00:00:31.538
We're going to create this
report using a merge query.

8
00:00:31.538 --> 00:00:36.380
But first we're going to need to create
a query that only shows sales staff.

9
00:00:36.380 --> 00:00:43.231
So coming to our staff tab, we're going
to click somewhere into the table.

10
00:00:43.231 --> 00:00:45.586
We're going to come up
to our data ribbon and

11
00:00:45.586 --> 00:00:48.089
we're going to select from table or range.

12
00:00:53.346 --> 00:00:56.730
At the moment,
this query is showing us All the staff and

13
00:00:56.730 --> 00:00:58.538
we only want the sales staff.

14
00:00:58.538 --> 00:01:01.576
So we're going to come to
the department column and

15
00:01:01.576 --> 00:01:04.977
we're going to filter out
everyone who's not in sales.

16
00:01:04.977 --> 00:01:07.171
We're going to uncheck select all.

17
00:01:07.171 --> 00:01:08.940
We're going to click sales.

18
00:01:08.940 --> 00:01:10.030
And we can say ok.

19
00:01:10.030 --> 00:01:13.396
Now we also don't need the start date or
the email.

20
00:01:13.396 --> 00:01:18.007
So I'm going to select the start
date column, hold my shift key down,

21
00:01:18.007 --> 00:01:22.870
click email, and just press Delete to
remove the columns from the query.

22
00:01:22.870 --> 00:01:26.158
I should probably also give
the query a good name.

23
00:01:26.158 --> 00:01:31.210
So over on the right under properties,
I'm going to call this sales stuff.

24
00:01:31.210 --> 00:01:34.520
And then I'm ready to close and load.

25
00:01:34.520 --> 00:01:37.934
But I want to create a connection only.

26
00:01:37.934 --> 00:01:43.945
So choose Close and Load to only
create connection and then click OK.

27
00:01:43.945 --> 00:01:46.437
I'm just going to click into a blank cell.

28
00:01:46.437 --> 00:01:50.680
And what I need to do now is create
a merge query between sales staff and

29
00:01:50.680 --> 00:01:52.448
my online training report.

30
00:01:52.448 --> 00:01:56.111
But I have to make a decision
about which type of join to use.

31
00:01:56.111 --> 00:01:58.383
Now I don't want all my sales staff.

32
00:01:58.383 --> 00:02:03.067
I only want those who have participated
in the training And I don't want

33
00:02:03.067 --> 00:02:08.623
everybody's participate in the training
only the people in the sales department.

34
00:02:08.623 --> 00:02:13.757
So what I'm looking for is to only return
the records where there is a match.

35
00:02:13.757 --> 00:02:17.366
For this, I need an inner
join clicks on a blank cell.

36
00:02:17.366 --> 00:02:19.822
We're going to come to our data tab,

37
00:02:19.822 --> 00:02:24.590
we're going to come to get data on
new query, combine queries and merge

38
00:02:28.413 --> 00:02:34.108
My left table or my top table
is going to be my sales start.

39
00:02:34.108 --> 00:02:38.927
And my bottom table or my right,
if you prefer, is going to be my report.

40
00:02:38.927 --> 00:02:40.166
And then don't forget,

41
00:02:40.166 --> 00:02:44.073
you actually have to match the two columns
that it's going to link the data on.

42
00:02:44.073 --> 00:02:46.350
And that's ID and staff ID.

43
00:02:46.350 --> 00:02:51.699
You may recall from the last video
that the default join is a left outer.

44
00:02:51.699 --> 00:02:53.927
And that's not what we want.

45
00:02:53.927 --> 00:02:58.121
So if you have the newer version
with the drop down list,

46
00:02:58.121 --> 00:03:03.220
please select the drop down and
choose inner or only matching rows.

47
00:03:03.220 --> 00:03:08.019
If you have the older version,
you won't have the drop down.

48
00:03:08.019 --> 00:03:13.183
But you will have a checkbox that
says only include matching rows,

49
00:03:13.183 --> 00:03:15.773
which is exactly the same thing.

50
00:03:15.773 --> 00:03:17.618
So just check that box.

51
00:03:17.618 --> 00:03:20.600
And then we're all ready to click OK.

52
00:03:20.600 --> 00:03:25.496
If you plan to the bottom, you can
see that 41 rows have been selected.

53
00:03:25.496 --> 00:03:29.351
So we can see the 41 sales
staff who have participated.

54
00:03:29.351 --> 00:03:32.081
But we'd also like to see their status.

55
00:03:32.081 --> 00:03:36.597
So one more step, we're going to
come up to the report column, and

56
00:03:36.597 --> 00:03:39.110
we're going to expand that column.

57
00:03:39.110 --> 00:03:43.843
We don't want to see everything,
we just want to see the status.

58
00:03:43.843 --> 00:03:46.899
And we don't want the table name
to prefix the column heading.

59
00:03:46.899 --> 00:03:50.615
So we're just going to untick that and
select okay.

60
00:03:53.882 --> 00:03:55.809
There is our completed report.

61
00:03:55.809 --> 00:03:58.219
Let's give it a sensible name.

62
00:03:58.219 --> 00:04:03.398
So on the right, we're going to call
this sales otif online training.

63
00:04:03.398 --> 00:04:04.094
Yes.
And

64
00:04:04.094 --> 00:04:07.388
then we're going to come back
to our clothes and load.

65
00:04:07.388 --> 00:04:11.683
And we're very happy for this to go
into a new table in our spreadsheet.

66
00:04:11.683 --> 00:04:14.260
So we're just going to click the top part.

67
00:04:14.260 --> 00:04:17.546
And there is our completed
query using an inner join and

68
00:04:17.546 --> 00:04:19.773
we'll give the sheet a better name.

69
00:04:19.773 --> 00:04:24.812
So at the bottom where says sheet one,
let's double click in there, and

70
00:04:24.812 --> 00:04:33.599
we're going to call this sales Yes, We've
been asked to create one final report.

71
00:04:33.599 --> 00:04:37.507
We need to find out which sales staff
have not participate in the training so

72
00:04:37.507 --> 00:04:39.504
we can follow up with their managers.

73
00:04:39.504 --> 00:04:44.427
Here we're looking to get all
the records in the sales staff query

74
00:04:44.427 --> 00:04:47.300
that do not have a match in the report.

75
00:04:47.300 --> 00:04:52.615
This is an anti join, and
in this case it's a left anti join.

76
00:04:52.615 --> 00:04:54.908
Let's see how we do this.

77
00:04:54.908 --> 00:04:57.619
Again, choose an empty cell.

78
00:04:57.619 --> 00:05:04.607
We're going to come up to our data ribbon,
get data, combine queries and merge.

79
00:05:04.607 --> 00:05:07.736
Our queries are the same as before.

80
00:05:07.736 --> 00:05:11.318
Our left Query is going
to be our sales staff.

81
00:05:11.318 --> 00:05:14.392
And our right is going
to be our report and

82
00:05:14.392 --> 00:05:17.387
then again need to match staff ID to ID.

83
00:05:17.387 --> 00:05:22.549
If you have the drop down list in
your version, click the drop down.

84
00:05:22.549 --> 00:05:24.642
And what we're looking for

85
00:05:24.642 --> 00:05:29.200
is a left anti join rows that
only appear in the first table.

86
00:05:29.200 --> 00:05:32.603
If you don't have the drop down,
don't worry,

87
00:05:32.603 --> 00:05:36.006
I'm going to show you
a really neat workaround.

88
00:05:36.006 --> 00:05:38.828
So if you don't have it, don't worry.

89
00:05:38.828 --> 00:05:41.401
I'm going to leave it as left outer.

90
00:05:41.401 --> 00:05:43.786
But obviously if you do have it,
please select left empty, and

91
00:05:43.786 --> 00:05:44.957
then we're going to click OK.

92
00:05:49.769 --> 00:05:53.165
At the moment, my query is
showing me all the sales staff.

93
00:05:53.165 --> 00:05:57.180
And if you have a look at the M
code inside my formula bar,

94
00:05:57.180 --> 00:05:59.925
you can see my join kind is left outer.

95
00:05:59.925 --> 00:06:03.263
The good news is you can
manually change this.

96
00:06:03.263 --> 00:06:06.015
So if you don't have all the options or

97
00:06:06.015 --> 00:06:10.920
even if you've just made a mistake,
you can come in and rectify it.

98
00:06:10.920 --> 00:06:13.666
So I'm just going to click into my code,
and

99
00:06:13.666 --> 00:06:18.457
I'm going to remove left outer that
leave the dot there and you'll see it.

100
00:06:18.457 --> 00:06:22.685
Actually gives me a drop down list
with all the join options, and

101
00:06:22.685 --> 00:06:24.658
the one we want is left empty.

102
00:06:24.658 --> 00:06:29.839
If you don't get that autocomplete,
you can literally just type left empty.

103
00:06:29.839 --> 00:06:33.980
And when I now press Enter It
has updated my query to

104
00:06:33.980 --> 00:06:37.935
show only the 38 rows
that do not have a match.

105
00:06:37.935 --> 00:06:40.140
Let's change the name.

106
00:06:40.140 --> 00:06:44.445
So on the left,
we're going to call this sales ot.

107
00:06:44.445 --> 00:06:46.533
No.

108
00:06:46.533 --> 00:06:50.099
And then we're just going to
click a top part of closing mode.

109
00:06:53.220 --> 00:06:58.095
And there is my final report using
a left anti-join showing me all

110
00:06:58.095 --> 00:07:02.810
the sales staff who have not yet
participated in the training.

111
00:07:02.810 --> 00:07:05.771
We renamed the worksheet tab, so

112
00:07:05.771 --> 00:07:11.600
just double clicking the bottom,
we going to call this sales OT No.

113
00:07:11.600 --> 00:07:13.387
For your optional practice,

114
00:07:13.387 --> 00:07:18.173
why not try creating a right anti join to
get all the people who have participated

115
00:07:18.173 --> 00:07:21.397
in the training who aren't
in the sales department?

116
00:07:21.397 --> 00:07:23.184
Well, it's been a big week.

117
00:07:23.184 --> 00:07:28.349
We've learned quite a lot about how Power
Query can get data from different sources,

118
00:07:28.349 --> 00:07:30.800
upended merge it and even transform it.

119
00:07:30.800 --> 00:07:36.595
We've got a great practice challenge
to help you revise all of these skills.

120
00:07:36.595 --> 00:07:41.493
And next week we continue our
exciting journey with Power Query,

121
00:07:41.493 --> 00:07:46.585
but with more of a focus on its
powerful data transformation tools.

122
00:07:46.585 --> 00:07:49.380
So look forward to seeing you there.