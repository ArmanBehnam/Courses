WEBVTT

1
00:00:04.880 --> 00:00:07.680
In this video, we're going to use

2
00:00:07.680 --> 00:00:12.340
Power Query to get several
files from a folder.

3
00:00:12.860 --> 00:00:16.065
The next thing we
need to do is get

4
00:00:16.065 --> 00:00:17.775
all the enrollment information

5
00:00:17.775 --> 00:00:19.770
into our original spreadsheet.

6
00:00:19.770 --> 00:00:21.500
There is a little
bit of a challenge

7
00:00:21.500 --> 00:00:22.670
with enrollments though.

8
00:00:22.670 --> 00:00:24.860
We actually have three branches,

9
00:00:24.860 --> 00:00:27.604
and every week they download

10
00:00:27.604 --> 00:00:30.875
a text file to a folder
called enrollments.

11
00:00:30.875 --> 00:00:33.950
If you have a look in
your downloaded files,

12
00:00:33.950 --> 00:00:35.555
you should see a folder
called enrollments,

13
00:00:35.555 --> 00:00:37.340
and if I double-click
to open that,

14
00:00:37.340 --> 00:00:38.930
there are three files on them,

15
00:00:38.930 --> 00:00:41.215
one from each of our branches.

16
00:00:41.215 --> 00:00:43.550
Now, what would typically happen,

17
00:00:43.550 --> 00:00:44.870
is each of these would have to be

18
00:00:44.870 --> 00:00:46.340
imported and then they need

19
00:00:46.340 --> 00:00:48.410
to be stacked
underneath each other.

20
00:00:48.410 --> 00:00:50.945
The good news is
with Power Query,

21
00:00:50.945 --> 00:00:55.735
we can totally automate this
process. Let's take a look.

22
00:00:55.735 --> 00:00:57.710
Back in our spreadsheet,

23
00:00:57.710 --> 00:01:00.515
I'm going to come
to my Data ribbon.

24
00:01:00.515 --> 00:01:02.525
I'm going to come to Get Data.

25
00:01:02.525 --> 00:01:04.670
We're going to come to From File,

26
00:01:04.670 --> 00:01:08.340
and we're going to
choose From Folder.

27
00:01:09.370 --> 00:01:11.570
The first thing we
need to do is tell

28
00:01:11.570 --> 00:01:12.830
it where this folder is.

29
00:01:12.830 --> 00:01:15.725
Now, if you've put your
Workbooks on the desktop,

30
00:01:15.725 --> 00:01:17.030
that will make your life a little

31
00:01:17.030 --> 00:01:19.205
easier because all folders

32
00:01:19.205 --> 00:01:23.210
on the desktop appear at
the bottom, over here.

33
00:01:23.210 --> 00:01:24.770
If yours has been put in

34
00:01:24.770 --> 00:01:26.150
your documents or somewhere else,

35
00:01:26.150 --> 00:01:27.770
just come to this PC,

36
00:01:27.770 --> 00:01:29.780
you see Documents, and
you should be able

37
00:01:29.780 --> 00:01:31.740
to navigate to it from there.

38
00:01:31.740 --> 00:01:33.290
I'm going to just
come to Workbooks on

39
00:01:33.290 --> 00:01:34.670
my desktop and I'm going to

40
00:01:34.670 --> 00:01:36.665
select the Enrollments folder.

41
00:01:36.665 --> 00:01:38.540
Make sure you've got
the enrollments folder,

42
00:01:38.540 --> 00:01:41.045
and we're going to click "Okay".

43
00:01:41.045 --> 00:01:44.430
Now, we're going to
click "Okay" again,

44
00:01:44.900 --> 00:01:49.910
and this is going to show
me the files selected.

45
00:01:49.910 --> 00:01:52.094
In the newer version,

46
00:01:52.094 --> 00:01:54.680
there's combined
button which totally

47
00:01:54.680 --> 00:01:57.170
automates the process,
so that's terrific,

48
00:01:57.170 --> 00:01:58.745
and I'm going to
show you that first,

49
00:01:58.745 --> 00:02:01.370
but if you don't have the
combined button, don't worry,

50
00:02:01.370 --> 00:02:02.870
I'm going to come back and show

51
00:02:02.870 --> 00:02:06.100
you the operation that
requires a couple more steps.

52
00:02:06.100 --> 00:02:08.310
We're going to click
"Combine", and

53
00:02:08.310 --> 00:02:11.140
I'm going to combine
and transform.

54
00:02:11.870 --> 00:02:15.610
It's just giving me a
preview on the first file,

55
00:02:15.610 --> 00:02:17.260
so I'm going to click "Okay".

56
00:02:17.260 --> 00:02:19.025
Now, what it's
going to do is take

57
00:02:19.025 --> 00:02:23.000
all three files and stack
them on top of each other.

58
00:02:23.000 --> 00:02:24.950
Click "Control Shift Plus"

59
00:02:24.950 --> 00:02:26.665
a few times, so you can see it.

60
00:02:26.665 --> 00:02:28.280
Now, what it's done it is

61
00:02:28.280 --> 00:02:30.605
actually matched the
column headings.

62
00:02:30.605 --> 00:02:32.120
For this to work,
it's a good idea

63
00:02:32.120 --> 00:02:34.330
if you have the same
column headings.

64
00:02:34.330 --> 00:02:37.040
It is also included a column

65
00:02:37.040 --> 00:02:38.960
showing me where
the data came from.

66
00:02:38.960 --> 00:02:40.730
In this case, I don't need it.

67
00:02:40.730 --> 00:02:43.610
I'm going to select Source
column and to remove it,

68
00:02:43.610 --> 00:02:45.670
you can click the
Remove columns button

69
00:02:45.670 --> 00:02:48.020
or just press your
"Delete button".

70
00:02:48.020 --> 00:02:50.550
There's our data already,

71
00:02:50.550 --> 00:02:52.080
and we're just going
to close and load.

72
00:02:52.080 --> 00:02:54.420
We're just going to put
it in a new Workbook,

73
00:02:54.420 --> 00:02:56.985
so how good was that?

74
00:02:56.985 --> 00:02:59.810
Now, I'm just going to go
through that process again

75
00:02:59.810 --> 00:03:02.300
for people who don't
have the newest version,

76
00:03:02.300 --> 00:03:05.810
so joining us when you get
to the same step as me,

77
00:03:05.810 --> 00:03:07.735
I'm going to come
back to my Data tab.

78
00:03:07.735 --> 00:03:09.465
I'm going to come to Get Data.

79
00:03:09.465 --> 00:03:13.680
I'm going to choose From
File and From Folder.

80
00:03:13.680 --> 00:03:17.240
Once again, I'm going to need
to go and find that folder,

81
00:03:17.240 --> 00:03:19.280
which is my Enrollments
and I'm going to

82
00:03:19.280 --> 00:03:22.450
say Okay, and Okay.

83
00:03:22.450 --> 00:03:25.895
Now, if you don't have
the combined button,

84
00:03:25.895 --> 00:03:27.230
what you're going to do is use

85
00:03:27.230 --> 00:03:29.720
the transformed data
or the edit button,

86
00:03:29.720 --> 00:03:32.040
so we're going to click on that,

87
00:03:33.200 --> 00:03:36.080
and what it's showing us now,

88
00:03:36.080 --> 00:03:39.280
I'll just zoom in a little
bit so you can see.

89
00:03:39.280 --> 00:03:41.680
What it's showing us, are

90
00:03:41.680 --> 00:03:44.330
the three files we're
trying to combine.

91
00:03:44.330 --> 00:03:46.250
Now, the first column,

92
00:03:46.250 --> 00:03:47.810
the one that says Binary,

93
00:03:47.810 --> 00:03:51.350
that actually contains the
contents of the files.

94
00:03:51.350 --> 00:03:53.720
The other columns are
just information about

95
00:03:53.720 --> 00:03:56.200
the files and we don't
actually need those,

96
00:03:56.200 --> 00:03:58.415
so I'm going to select
my Name column,

97
00:03:58.415 --> 00:03:59.885
hold my shift key down,

98
00:03:59.885 --> 00:04:01.520
and select Folder Path,

99
00:04:01.520 --> 00:04:03.200
and then I'm just going
to press "Delete"

100
00:04:03.200 --> 00:04:05.110
or Remove columns.

101
00:04:05.110 --> 00:04:07.445
Now, here's the interesting bit.

102
00:04:07.445 --> 00:04:09.680
If you come to the
Content folder,

103
00:04:09.680 --> 00:04:11.960
you'll see two little arrows,

104
00:04:11.960 --> 00:04:13.340
and if you over roll it,

105
00:04:13.340 --> 00:04:16.745
it tells you that that's
the Combined Files button.

106
00:04:16.745 --> 00:04:18.785
That's what we're going
to need to click now.

107
00:04:18.785 --> 00:04:21.540
We're going to click
"Combined Files".

108
00:04:21.820 --> 00:04:25.265
Again, it's giving you a
preview of the first file.

109
00:04:25.265 --> 00:04:27.780
We're just going to say Okay,

110
00:04:28.230 --> 00:04:31.190
and it has done the same job.

111
00:04:31.190 --> 00:04:34.030
If however you're working
some of the older versions,

112
00:04:34.030 --> 00:04:37.100
it doesn't always automate
as many of the steps.

113
00:04:37.100 --> 00:04:38.465
You may find, for example,

114
00:04:38.465 --> 00:04:39.770
that your column headings are

115
00:04:39.770 --> 00:04:41.225
not actually column headings.

116
00:04:41.225 --> 00:04:43.640
Sometimes what happens is the
column headings end up as

117
00:04:43.640 --> 00:04:46.400
a first row of data and
the columns go Column 1,

118
00:04:46.400 --> 00:04:47.510
Column 2, Column 3.

119
00:04:47.510 --> 00:04:50.630
Now, this can actually
be really easily fixed.

120
00:04:50.630 --> 00:04:52.190
I'm just going to demonstrate

121
00:04:52.190 --> 00:04:54.450
what the problem looks like.

122
00:04:57.350 --> 00:05:00.670
If it says Column 1,
Column 2, Column 3,

123
00:05:00.670 --> 00:05:02.860
you're going to come
up to the Home ribbon,

124
00:05:02.860 --> 00:05:04.950
and you're going to find
the button that says

125
00:05:04.950 --> 00:05:07.410
Use First Row as Headers.

126
00:05:07.410 --> 00:05:09.545
When you click on it, it

127
00:05:09.545 --> 00:05:11.930
promotes first row
up to being Headers.

128
00:05:11.930 --> 00:05:14.420
Now, the other thing that
happened automatically,

129
00:05:14.420 --> 00:05:18.365
was all the headers from the
other files were removed.

130
00:05:18.365 --> 00:05:20.060
If that hasn't happened for you,

131
00:05:20.060 --> 00:05:22.265
so if you still seeing
Staff ID, Stuff Name,

132
00:05:22.265 --> 00:05:24.110
as the headings from
the other files,

133
00:05:24.110 --> 00:05:26.885
we can fairly easily
filter those out.

134
00:05:26.885 --> 00:05:29.555
All you need to do
is come to Staff ID,

135
00:05:29.555 --> 00:05:31.715
click the "Auto Filter button",

136
00:05:31.715 --> 00:05:34.325
and where you see
Staff ID in this list,

137
00:05:34.325 --> 00:05:35.720
you just going to untake it,

138
00:05:35.720 --> 00:05:38.190
and click "Okay",

139
00:05:38.190 --> 00:05:41.080
and that will remove all
the other heading rose.

140
00:05:41.080 --> 00:05:42.230
A couple more steps,

141
00:05:42.230 --> 00:05:43.850
but still really easy to do,

142
00:05:43.850 --> 00:05:45.890
and you only need to do it once.

143
00:05:45.890 --> 00:05:47.660
If you've done it this way, it

144
00:05:47.660 --> 00:05:48.925
will too close Home button.

145
00:05:48.925 --> 00:05:51.485
If you've just been
refreshing with me,

146
00:05:51.485 --> 00:05:53.720
I'm just going to
close this query apps.

147
00:05:53.720 --> 00:05:55.790
I'm going to hit the
top right-hand corner.

148
00:05:55.790 --> 00:05:57.260
When you do that, it gives you

149
00:05:57.260 --> 00:05:59.990
the option to keep or
discard the query.

150
00:05:59.990 --> 00:06:01.550
I'm going to discard
this one because

151
00:06:01.550 --> 00:06:03.805
I already have the data loaded.

152
00:06:03.805 --> 00:06:05.940
Now, I should just point out in

153
00:06:05.940 --> 00:06:07.620
our Queries and Connections,

154
00:06:07.620 --> 00:06:10.590
we do have our Enrollments
query which has been added,

155
00:06:10.590 --> 00:06:12.500
but there were quite
a few helper queries

156
00:06:12.500 --> 00:06:13.730
created along the way,

157
00:06:13.730 --> 00:06:16.135
and that's all the staff
at the top of the file is.

158
00:06:16.135 --> 00:06:17.795
You don't need to do
anything with it,

159
00:06:17.795 --> 00:06:19.700
but don't remove it
because those are

160
00:06:19.700 --> 00:06:22.490
the queries needed at
creating enrollments query.

161
00:06:22.490 --> 00:06:24.920
You can collapse this
information by hitting

162
00:06:24.920 --> 00:06:28.105
the little black twisty,
so you can hide it away.

163
00:06:28.105 --> 00:06:31.870
Now, let's just demonstrate
what's actually going

164
00:06:31.870 --> 00:06:35.335
to happen when we change
the contents of the folder.

165
00:06:35.335 --> 00:06:37.000
Obviously if we change
into individual

166
00:06:37.000 --> 00:06:38.540
files, this will update,

167
00:06:38.540 --> 00:06:40.450
but if you change the
contents of the folder,

168
00:06:40.450 --> 00:06:41.945
this updates as well.

169
00:06:41.945 --> 00:06:43.320
You don't need to do this, but

170
00:06:43.320 --> 00:06:44.775
you welcome to if you'd like to.

171
00:06:44.775 --> 00:06:47.775
I'm back in my File Explorer.

172
00:06:47.775 --> 00:06:50.320
I'm going to come into
Workbooks and I've actually

173
00:06:50.320 --> 00:06:51.580
just got a couple of

174
00:06:51.580 --> 00:06:53.660
last minute enrollments
from Melbourne,

175
00:06:53.660 --> 00:06:57.215
so I'm going to grab this
Enrollments Melbourne_2 file,

176
00:06:57.215 --> 00:07:00.550
and I'm going to drop it
into my Enrollments folder.

177
00:07:00.550 --> 00:07:03.760
I now actually have
four files in here,

178
00:07:03.760 --> 00:07:05.290
and there are two
additional ones from

179
00:07:05.290 --> 00:07:07.690
Melbourne. Back in Excel.

180
00:07:07.690 --> 00:07:11.120
I'm going to right-click
and refresh,

181
00:07:11.840 --> 00:07:15.395
and there are my two
additional enrollments.

182
00:07:15.395 --> 00:07:19.000
If I remove the file from the
folder and hit "Refresh",

183
00:07:19.000 --> 00:07:21.540
same thing, that date
will be removed.

184
00:07:21.540 --> 00:07:24.500
You can actually keep
Excel completely up today

185
00:07:24.500 --> 00:07:27.815
just by adding and removing
files from the folder.

186
00:07:27.815 --> 00:07:30.110
Those files, they need
to be at the same type,

187
00:07:30.110 --> 00:07:33.985
but they can be CSV
text, you name it.

188
00:07:33.985 --> 00:07:37.665
There's a really exciting
automation option,

189
00:07:37.665 --> 00:07:39.050
and we're starting to see how

190
00:07:39.050 --> 00:07:42.420
Power Query can save
us heaps of time.