WEBVTT

1
00:00:04.850 --> 00:00:09.345
In this video, We're going
to introduce Power Query,

2
00:00:09.345 --> 00:00:11.910
also known as Get and Transform.

3
00:00:11.910 --> 00:00:14.820
Excel is an amazing
efficiency tool.

4
00:00:14.820 --> 00:00:17.100
But there's still some operations

5
00:00:17.100 --> 00:00:18.975
like importing and cleaning data,

6
00:00:18.975 --> 00:00:21.810
which can be extremely
time-consuming.

7
00:00:21.810 --> 00:00:25.515
Take this dataset, for
example, it's got gaps.

8
00:00:25.515 --> 00:00:27.510
Now there are some
clever little tools

9
00:00:27.510 --> 00:00:29.175
and tricks for
filling those gaps,

10
00:00:29.175 --> 00:00:32.280
but if you have to do it
regularly with larger data sets,

11
00:00:32.280 --> 00:00:34.525
it can be quite time-consuming.

12
00:00:34.525 --> 00:00:36.710
Here's another example.

13
00:00:36.710 --> 00:00:38.790
Here we've got our course code

14
00:00:38.790 --> 00:00:40.530
and description in
a single column.

15
00:00:40.530 --> 00:00:44.570
We want that core data to
stay exactly as it is.

16
00:00:44.570 --> 00:00:46.265
But there are times
where we need to

17
00:00:46.265 --> 00:00:48.440
work with those as
separate entities.

18
00:00:48.440 --> 00:00:50.270
Power Query can solve

19
00:00:50.270 --> 00:00:52.895
these problems and
a whole bunch more.

20
00:00:52.895 --> 00:00:55.460
What is Power Query?

21
00:00:55.460 --> 00:00:57.740
First of all, Power Query is only

22
00:00:57.740 --> 00:00:59.990
available for Windows not Mac.

23
00:00:59.990 --> 00:01:02.510
It was first introduced
as an add-in for

24
00:01:02.510 --> 00:01:06.395
2010 and was also available
as an add in for 2013.

25
00:01:06.395 --> 00:01:09.065
But from 2016 onwards,

26
00:01:09.065 --> 00:01:11.210
it has been integrated into

27
00:01:11.210 --> 00:01:15.460
the Data ribbon in the Get
and Transform section.

28
00:01:15.460 --> 00:01:18.380
Power Query allows
us to pull data from

29
00:01:18.380 --> 00:01:21.335
a huge variety of sources.

30
00:01:21.335 --> 00:01:23.165
These can be databases,

31
00:01:23.165 --> 00:01:26.915
Oracle, SQL Server, even SAP.

32
00:01:26.915 --> 00:01:29.524
You can get it from
online services,

33
00:01:29.524 --> 00:01:32.425
Facebook, just an amazing array.

34
00:01:32.425 --> 00:01:35.105
Then having pulled
that data into memory,

35
00:01:35.105 --> 00:01:37.220
Power Query allows you to perform

36
00:01:37.220 --> 00:01:39.830
cleaning and transformation
operations to

37
00:01:39.830 --> 00:01:43.315
get that data into exactly
the format you need.

38
00:01:43.315 --> 00:01:46.010
But the best part is, as you go

39
00:01:46.010 --> 00:01:48.520
through the process of
transforming the data,

40
00:01:48.520 --> 00:01:51.380
it records each
operation as a step,

41
00:01:51.380 --> 00:01:53.495
a little bit like a macro,

42
00:01:53.495 --> 00:01:55.340
which means that
when the underlying

43
00:01:55.340 --> 00:01:57.500
data changes or is replaced,

44
00:01:57.500 --> 00:01:58.760
all you have to do is hit

45
00:01:58.760 --> 00:02:00.215
the refresh button and

46
00:02:00.215 --> 00:02:02.405
all those transformations
happen again.

47
00:02:02.405 --> 00:02:05.455
A very powerful automation tool.

48
00:02:05.455 --> 00:02:08.175
Let's see it in action.

49
00:02:08.175 --> 00:02:10.625
The first example, really simple.

50
00:02:10.625 --> 00:02:12.890
We're just going to
create a query

51
00:02:12.890 --> 00:02:15.570
that splits our Course
Code and Description.

52
00:02:15.570 --> 00:02:18.775
We're going to start by
clicking somewhere in the data.

53
00:02:18.775 --> 00:02:21.090
Then we're going to come
to our Data ribbon.

54
00:02:21.090 --> 00:02:23.970
We're going to come to our
Get and Transform Data group,

55
00:02:23.970 --> 00:02:25.370
and when the data is

56
00:02:25.370 --> 00:02:27.695
coming from the workbook
you're working in,

57
00:02:27.695 --> 00:02:30.560
you just choose From
Table or Range.

58
00:02:30.560 --> 00:02:32.140
We're going to click on that.

59
00:02:32.140 --> 00:02:34.020
First thing Power
Query is going to

60
00:02:34.020 --> 00:02:37.755
do is convert your
data to a Table.

61
00:02:37.755 --> 00:02:39.560
Now this doesn't
give you much chance

62
00:02:39.560 --> 00:02:41.300
to change the name of the Table.

63
00:02:41.300 --> 00:02:44.525
It's probably better to do
it yourself beforehand,

64
00:02:44.525 --> 00:02:46.250
but this will still work,

65
00:02:46.250 --> 00:02:48.550
so we're going to click OK.

66
00:02:48.550 --> 00:02:51.335
The date has been
converted to a Table

67
00:02:51.335 --> 00:02:54.500
and welcome to the
Power Query Editor.

68
00:02:54.500 --> 00:02:57.770
At first glance, it looks
quite similar to Excel.

69
00:02:57.770 --> 00:03:00.440
We've got our data organized
in rows and columns,

70
00:03:00.440 --> 00:03:02.470
and we've got our ribbon.

71
00:03:02.470 --> 00:03:04.370
If you have a look at
the Ribbon though,

72
00:03:04.370 --> 00:03:07.520
you'll see it's got some
really exciting tools.

73
00:03:07.520 --> 00:03:10.850
What we want to do is
split this column.

74
00:03:10.850 --> 00:03:12.835
Making sure you've
got it selected,

75
00:03:12.835 --> 00:03:14.940
come to the Home
ribbon, and we're going

76
00:03:14.940 --> 00:03:17.280
to look for the
Split Column tool.

77
00:03:17.280 --> 00:03:19.399
When I click the dropdown,

78
00:03:19.399 --> 00:03:21.380
it's got quite a few options

79
00:03:21.380 --> 00:03:23.695
and some of these are awesome.

80
00:03:23.695 --> 00:03:27.835
Digit to Non-digit,
Uppercase to Lowercase.

81
00:03:27.835 --> 00:03:30.020
These are the kinds of
problems that solving with

82
00:03:30.020 --> 00:03:32.555
traditional Excel
is really tricky.

83
00:03:32.555 --> 00:03:35.030
But in Power Query, really easy.

84
00:03:35.030 --> 00:03:38.654
The option we want is By
Delimiter or Separator,

85
00:03:38.654 --> 00:03:43.470
so we're going to click on
that, and it's identified,

86
00:03:43.470 --> 00:03:45.230
we probably want to use a space,

87
00:03:45.230 --> 00:03:46.805
but there are lots
of other options

88
00:03:46.805 --> 00:03:49.055
or even a Custom delimiter.

89
00:03:49.055 --> 00:03:51.080
Here's the best part though.

90
00:03:51.080 --> 00:03:55.410
Text to Columns would split
it by each space it found.

91
00:03:55.410 --> 00:03:58.410
But here we can choose
to use Each occurrence,

92
00:03:58.410 --> 00:04:00.780
Right-most, or the one
we actually want,

93
00:04:00.780 --> 00:04:02.700
which is Left-most delimiter.

94
00:04:02.700 --> 00:04:06.525
Make sure you've chosen
that, and click OK.

95
00:04:06.525 --> 00:04:09.150
Too easy. Now let's

96
00:04:09.150 --> 00:04:11.390
give our columns
slightly better names.

97
00:04:11.390 --> 00:04:13.700
So I'm going to double-click
on the first one,

98
00:04:13.700 --> 00:04:17.400
and I'm going to change
that to just Course Code.

99
00:04:19.480 --> 00:04:21.890
Then on the second one
we're going to change

100
00:04:21.890 --> 00:04:24.300
that to Course Description.

101
00:04:27.740 --> 00:04:31.085
Now if you have a look
on the right-hand side,

102
00:04:31.085 --> 00:04:35.650
each step we've been doing
is being recorded as a step.

103
00:04:35.650 --> 00:04:37.820
Query also has a name,

104
00:04:37.820 --> 00:04:41.330
is normally named after the
table you created it from.

105
00:04:41.330 --> 00:04:43.130
So our's hasn't got
a really good name,

106
00:04:43.130 --> 00:04:44.780
so we're just going
change that to

107
00:04:44.780 --> 00:04:50.525
Course List, and now we're done.

108
00:04:50.525 --> 00:04:52.685
We're going to Close and Load.

109
00:04:52.685 --> 00:04:54.680
That's how we save our Query.

110
00:04:54.680 --> 00:04:56.450
Coming across to the left,

111
00:04:56.450 --> 00:04:58.190
I'm going to click
the dropdown and

112
00:04:58.190 --> 00:05:00.005
choose "Close and Load To",

113
00:05:00.005 --> 00:05:04.250
so you can see all the
options. By default.

114
00:05:04.250 --> 00:05:07.655
It will load it to a new
table in a new worksheet.

115
00:05:07.655 --> 00:05:10.190
But you could actually
load it directly to

116
00:05:10.190 --> 00:05:11.225
a PivotTable or a

117
00:05:11.225 --> 00:05:12.740
PivotChart if you're working

118
00:05:12.740 --> 00:05:14.245
with one of the newer versions.

119
00:05:14.245 --> 00:05:17.300
You can also choose to
just create a connection.

120
00:05:17.300 --> 00:05:19.100
That means you have
the query data

121
00:05:19.100 --> 00:05:20.585
available for you to work with,

122
00:05:20.585 --> 00:05:22.925
but it doesn't load
it back into Excel,

123
00:05:22.925 --> 00:05:25.395
or you could load it to
an existing worksheet.

124
00:05:25.395 --> 00:05:27.140
We want to go with the default,

125
00:05:27.140 --> 00:05:28.185
so we're just going to click OK

126
00:05:28.185 --> 00:05:33.290
and there's our
clean transformed data

127
00:05:33.290 --> 00:05:35.645
sitting in its own worksheet.

128
00:05:35.645 --> 00:05:36.860
We'll give this a better name,

129
00:05:36.860 --> 00:05:39.990
so I'm just going to
rename this Course List.

130
00:05:40.780 --> 00:05:44.930
But now what happens when we
change the original data?

131
00:05:44.930 --> 00:05:47.505
Let's go and see. I'm going
to come to Training Courses,

132
00:05:47.505 --> 00:05:49.840
and you can see we forgot
to fill the category here,

133
00:05:49.840 --> 00:05:51.470
so I'm just going
to copy Microsoft

134
00:05:51.470 --> 00:05:53.555
down because it is
a Microsoft course.

135
00:05:53.555 --> 00:05:55.580
When I come back
to my Course List,

136
00:05:55.580 --> 00:05:58.010
it has not immediately updated.

137
00:05:58.010 --> 00:06:00.065
One thing to be aware
of with queries,

138
00:06:00.065 --> 00:06:01.969
they do need to be refreshed.

139
00:06:01.969 --> 00:06:06.340
That's really easy to do,
right-click and "Refresh".

140
00:06:06.340 --> 00:06:09.435
Whenever the Training
Course data changes,

141
00:06:09.435 --> 00:06:11.060
if we refresh this,

142
00:06:11.060 --> 00:06:13.115
it will automatically update.

143
00:06:13.115 --> 00:06:16.160
That was just a quick
introductions to give you

144
00:06:16.160 --> 00:06:18.980
an idea of some of the
things Power Query can do.

145
00:06:18.980 --> 00:06:20.480
But over this week we're going to

146
00:06:20.480 --> 00:06:22.490
see some amazing features.

147
00:06:22.490 --> 00:06:29.200
Keep watching. [NOISE]