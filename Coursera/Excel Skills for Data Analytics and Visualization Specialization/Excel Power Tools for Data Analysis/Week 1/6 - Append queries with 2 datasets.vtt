WEBVTT

1
00:00:00.000 --> 00:00:05.809
[MUSIC]

2
00:00:05.809 --> 00:00:06.862
In this video,

3
00:00:06.862 --> 00:00:11.490
we're going to look at creating
append queries with two data sets.

4
00:00:12.780 --> 00:00:15.511
And append query is when we take two or
more data sets,

5
00:00:15.511 --> 00:00:19.275
and basically stack them on top of each
other, very much like what we did in

6
00:00:19.275 --> 00:00:23.060
the previous video, but we're going
to look at how we can do it manually.

7
00:00:24.710 --> 00:00:26.620
Having a look at our training schedule.

8
00:00:26.620 --> 00:00:30.344
We have the instructor codes for
who will be teaching these courses, but

9
00:00:30.344 --> 00:00:33.050
we'd really like to see
the instructor names.

10
00:00:33.050 --> 00:00:36.450
So we need a way of pulling
that information through.

11
00:00:36.450 --> 00:00:40.508
We do actually have the instructor list
on the instructors tab, but you can see,

12
00:00:40.508 --> 00:00:42.210
we also have a problem.

13
00:00:42.210 --> 00:00:47.080
We have two separate lists of instructors
making it very difficult to look them up.

14
00:00:47.080 --> 00:00:50.230
What we want to do is
combine these two datasets.

15
00:00:50.230 --> 00:00:52.360
So we have one list of instructors.

16
00:00:53.840 --> 00:00:57.490
You will notice that the structure of
the two data sets is not identical.

17
00:00:57.490 --> 00:00:59.293
The columns are in different sequences,

18
00:00:59.293 --> 00:01:01.620
and the other instructors
has an additional column.

19
00:01:02.620 --> 00:01:06.593
This is not going to be a problem for
the append query, as long as the column

20
00:01:06.593 --> 00:01:11.640
headings are the same, and the append
query will match the data correctly.

21
00:01:11.640 --> 00:01:15.036
And we're going to have a look at how
we can actually add a location to

22
00:01:15.036 --> 00:01:16.000
the Sydney query.

23
00:01:17.180 --> 00:01:21.452
In the first video, we mentioned that
when you create your query from data in

24
00:01:21.452 --> 00:01:25.500
the current workbook,
it automatically converted to a table.

25
00:01:25.500 --> 00:01:27.920
So you should probably do this yourself.

26
00:01:27.920 --> 00:01:30.460
Now this table has already been created.

27
00:01:30.460 --> 00:01:33.160
But we haven't done the one
that set the instructors.

28
00:01:33.160 --> 00:01:36.230
So we're going to click
somewhere into that dataset,

29
00:01:36.230 --> 00:01:39.250
come to our insert ribbon and click table.

30
00:01:39.250 --> 00:01:41.119
Table shortcut, CTRL + T.

31
00:01:41.119 --> 00:01:45.110
Our tables dose of headers,
so just click OK.

32
00:01:46.120 --> 00:01:48.790
Now, we should give our
table a sensible name.

33
00:01:48.790 --> 00:01:51.875
So coming on to our table design or
Table Tools design,

34
00:01:51.875 --> 00:01:54.940
we're going to find a table
name on the far left.

35
00:01:54.940 --> 00:02:02.190
And we're going to call this instructors,
Sydney, And press Enter.

36
00:02:02.190 --> 00:02:04.840
We're now ready to create our queries.

37
00:02:04.840 --> 00:02:09.573
Starting with the Sydney instructors,
we're going to come to our data ribbon,

38
00:02:09.573 --> 00:02:12.490
and it's coming from the current workbook.

39
00:02:12.490 --> 00:02:14.430
So we're going to choose from table or
range.

40
00:02:20.524 --> 00:02:24.669
Now we do actually want to know when
we join our two queries that these

41
00:02:24.669 --> 00:02:27.620
instructors are the Sydney instructors.

42
00:02:27.620 --> 00:02:30.190
So we actually want to
add an additional column.

43
00:02:30.190 --> 00:02:32.650
And we can do that right
here in Power Query.

44
00:02:32.650 --> 00:02:36.230
We're going to come to
our ad column ribbon.

45
00:02:36.230 --> 00:02:37.929
We're going to add a custom column and

46
00:02:37.929 --> 00:02:40.090
we'll talk a lot more
about these next week.

47
00:02:40.090 --> 00:02:45.770
I'm going to click custom column, and
we want to call this column location.

48
00:02:48.380 --> 00:02:51.540
And we want the value in
the column to be Sydney.

49
00:02:51.540 --> 00:02:55.850
So clicking into the next box opening
double quotes and type Sydney.

50
00:02:57.220 --> 00:02:58.580
And then click OK.

51
00:03:00.160 --> 00:03:04.090
Now because we use a table with a sensible
name, you'll see our query has picked

52
00:03:04.090 --> 00:03:07.390
up the name from the table so
we don't need to change that.

53
00:03:07.390 --> 00:03:09.680
all we need to do is Close and Load.

54
00:03:09.680 --> 00:03:14.114
Back to the Home ribbon, Close and
Load, Close and Load two and

55
00:03:14.114 --> 00:03:18.680
we don't want to put this data
back into the Excel workbook.

56
00:03:18.680 --> 00:03:22.600
So we can say Only Create Connection and
then click OK.

57
00:03:24.000 --> 00:03:26.250
Let's create the query for
other Instructors.

58
00:03:26.250 --> 00:03:30.370
So click into the table,
Data ribbon, From Table Range.

59
00:03:31.730 --> 00:03:36.553
No change is needed here, so
Close & Load, Close & Load two,

60
00:03:36.553 --> 00:03:39.560
and again, only create a connection.

61
00:03:40.600 --> 00:03:44.730
We now have our two queries,
we're going to go and append them.

62
00:03:44.730 --> 00:03:48.720
If you're working with an older version,
and you don't have the Get Data button,

63
00:03:48.720 --> 00:03:50.980
are you going to choose new query?

64
00:03:50.980 --> 00:03:54.590
If you have the current version,
we're going to click get data.

65
00:03:54.590 --> 00:03:58.286
Combine queries, and we're going to use

66
00:03:58.286 --> 00:04:03.540
an append query now we
are trying to join two tables.

67
00:04:03.540 --> 00:04:04.177
Our primary table.

68
00:04:04.177 --> 00:04:08.200
The first data set we'll see
is our instructors, Sydney.

69
00:04:08.200 --> 00:04:12.752
And the table we want to append
is our instructors other, and

70
00:04:12.752 --> 00:04:16.980
we're going to click OK and
there is our complete list.

71
00:04:16.980 --> 00:04:19.416
Instructors along with their location,

72
00:04:19.416 --> 00:04:22.560
let's give this query
a more sensible name.

73
00:04:22.560 --> 00:04:24.511
So where it's got the name of hand one,

74
00:04:24.511 --> 00:04:26.830
we're going to replace
that with instructors.

75
00:04:28.042 --> 00:04:30.540
And then we're going to Close and Load.

76
00:04:31.580 --> 00:04:36.689
And once again, we're going to create
connection only because we're going to use

77
00:04:36.689 --> 00:04:42.630
that data in the query, but we don't need
the list actually sitting in the workbook.

78
00:04:42.630 --> 00:04:43.640
So click, Ok.

79
00:04:45.180 --> 00:04:49.380
So what we saw in this video was
how we could join two data sets.

80
00:04:49.380 --> 00:04:53.450
From within an Excel workbook
using an append query.

81
00:04:53.450 --> 00:04:57.170
In the next video, we're going to
look at how we can join more than two

82
00:04:57.170 --> 00:05:00.010
datasets when pulling data
from external sources.