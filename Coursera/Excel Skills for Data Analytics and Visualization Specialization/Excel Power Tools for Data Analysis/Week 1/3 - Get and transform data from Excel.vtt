WEBVTT

1
00:00:04.790 --> 00:00:07.260
In this video, we're going

2
00:00:07.260 --> 00:00:08.910
to have a look at how
we can use Gets and

3
00:00:08.910 --> 00:00:11.340
Transform to pull data from

4
00:00:11.340 --> 00:00:13.170
another Excel workbook and

5
00:00:13.170 --> 00:00:15.360
make some basic transformations.

6
00:00:15.360 --> 00:00:18.830
In this scenario, we
are trying to help

7
00:00:18.830 --> 00:00:22.505
the HR department sought out
all their training data.

8
00:00:22.505 --> 00:00:25.610
At the moment it resides in
lots of different worksheets,

9
00:00:25.610 --> 00:00:27.080
it's coming from
different departments,

10
00:00:27.080 --> 00:00:29.300
different systems, even
different branches.

11
00:00:29.300 --> 00:00:31.580
We'd like to put
it all together in

12
00:00:31.580 --> 00:00:33.380
one central repository where

13
00:00:33.380 --> 00:00:35.195
we can manage and work with it.

14
00:00:35.195 --> 00:00:37.385
The training schedule is

15
00:00:37.385 --> 00:00:39.815
kept in a master copy
in a separate workbook,

16
00:00:39.815 --> 00:00:41.690
and that is the one that

17
00:00:41.690 --> 00:00:44.170
the people setting up a
schedule still want to use,

18
00:00:44.170 --> 00:00:46.880
but we need to be able
to pull the data from

19
00:00:46.880 --> 00:00:48.110
the training schedule into

20
00:00:48.110 --> 00:00:50.335
this workbook and work with it.

21
00:00:50.335 --> 00:00:52.040
Now, I'll just remind you what

22
00:00:52.040 --> 00:00:53.660
that training
schedule looks like.

23
00:00:53.660 --> 00:00:56.180
So it's the data we looked
at in the last video.

24
00:00:56.180 --> 00:00:58.455
You can see it's got the gaps.

25
00:00:58.455 --> 00:01:00.865
But when we're trying
to work with this data,

26
00:01:00.865 --> 00:01:03.145
we need to actually
fill those gaps,

27
00:01:03.145 --> 00:01:06.385
but the master copy needs
to remain untouched.

28
00:01:06.385 --> 00:01:08.995
So we're not actually going
to change the original file.

29
00:01:08.995 --> 00:01:11.125
We're going to
import, if you like,

30
00:01:11.125 --> 00:01:13.900
into our other Workbook
and change it there.

31
00:01:13.900 --> 00:01:16.030
So let's see how we do this.

32
00:01:16.030 --> 00:01:17.575
Now we're going to
start by clicking

33
00:01:17.575 --> 00:01:19.525
into the training schedule sheet.

34
00:01:19.525 --> 00:01:21.865
We're going to come back
to our Data ribbon,

35
00:01:21.865 --> 00:01:23.935
and we going to come
to get an Transform.

36
00:01:23.935 --> 00:01:25.720
But this time we're
not getting it

37
00:01:25.720 --> 00:01:27.280
from within this Workbook.

38
00:01:27.280 --> 00:01:29.530
So we're going to need
to come to Get data,

39
00:01:29.530 --> 00:01:34.115
and we're going to choose
from file and from workbook.

40
00:01:34.115 --> 00:01:36.250
Now you need to navigate to

41
00:01:36.250 --> 00:01:38.320
find the workbook
you want to link to.

42
00:01:38.320 --> 00:01:40.900
I've got it right here, it's
called training schedule,

43
00:01:40.900 --> 00:01:43.205
so I'm just going to
double-click that.

44
00:01:43.205 --> 00:01:45.725
If there were multiple sheets

45
00:01:45.725 --> 00:01:47.885
inside the workbook
I'd connected to,

46
00:01:47.885 --> 00:01:49.415
they would all be linked here.

47
00:01:49.415 --> 00:01:52.325
We've only got the one and
if you single-click on it,

48
00:01:52.325 --> 00:01:53.965
we do get a preview.

49
00:01:53.965 --> 00:01:56.435
If all you wanted to do
was connect the data,

50
00:01:56.435 --> 00:01:57.580
you could click load.

51
00:01:57.580 --> 00:02:00.320
But we want to make some
transformations first.

52
00:02:00.320 --> 00:02:02.630
So I'm going to click
Transform data.

53
00:02:02.630 --> 00:02:04.685
If you have a slightly
older version,

54
00:02:04.685 --> 00:02:06.820
you'll need to click "Edit".

55
00:02:06.820 --> 00:02:11.610
When I do, we're back in
to the Power Query Editor.

56
00:02:12.310 --> 00:02:15.260
Let's just take a moment
to talk about some of

57
00:02:15.260 --> 00:02:18.905
the differences between
Power Query and Excel.

58
00:02:18.905 --> 00:02:21.470
For one thing, Power Query does

59
00:02:21.470 --> 00:02:23.675
not work at the cell level.

60
00:02:23.675 --> 00:02:26.300
In other words, I
can't come in here and

61
00:02:26.300 --> 00:02:29.765
start editing the data
or formatting the data.

62
00:02:29.765 --> 00:02:31.835
The other thing you
may have noticed

63
00:02:31.835 --> 00:02:33.395
is we're getting these nulls.

64
00:02:33.395 --> 00:02:35.360
So where a cell is empty,

65
00:02:35.360 --> 00:02:37.895
Power Query treats
it as a null value,

66
00:02:37.895 --> 00:02:39.740
which is quite
different to excels

67
00:02:39.740 --> 00:02:42.095
handling of it as a zero.

68
00:02:42.095 --> 00:02:46.240
Power Query also uses much
stronger data typing,

69
00:02:46.240 --> 00:02:47.995
a bit more like a database.

70
00:02:47.995 --> 00:02:49.840
So for example, in Excel

71
00:02:49.840 --> 00:02:52.640
a date is just a number
formatted to look like a date,

72
00:02:52.640 --> 00:02:56.420
but Power Query, it's a
totally different data-type.

73
00:02:56.420 --> 00:02:58.460
It's worth being aware
of these things,

74
00:02:58.460 --> 00:02:59.540
although none of them
are going to cause

75
00:02:59.540 --> 00:03:01.015
us problems as such.

76
00:03:01.015 --> 00:03:02.915
One more thing I'd
like to point out,

77
00:03:02.915 --> 00:03:05.045
if you have a look
at the formula bar,

78
00:03:05.045 --> 00:03:07.475
and if you can't see
the Formula Bar,

79
00:03:07.475 --> 00:03:11.810
come to view tab and just tick
Formula Bar to turn it on.

80
00:03:11.810 --> 00:03:14.660
You will notice some
interesting looking code.

81
00:03:14.660 --> 00:03:18.020
This is actually a
language called M and is

82
00:03:18.020 --> 00:03:21.740
the language that our power
queries are written in.

83
00:03:21.740 --> 00:03:23.390
Now for now, we're just going to

84
00:03:23.390 --> 00:03:25.640
keep it in the background,
keep an eye on it.

85
00:03:25.640 --> 00:03:26.960
But as we go through,

86
00:03:26.960 --> 00:03:28.400
we will jump in and start

87
00:03:28.400 --> 00:03:30.260
editing that language and
getting a little more

88
00:03:30.260 --> 00:03:32.540
familiar with it as
it can help you solve

89
00:03:32.540 --> 00:03:35.615
slightly trickier problems or
be a little more efficient.

90
00:03:35.615 --> 00:03:38.750
Let's now get in and make
those transformations.

91
00:03:38.750 --> 00:03:41.630
So the column we want to
change is our location.

92
00:03:41.630 --> 00:03:42.905
We want to fill those gaps.

93
00:03:42.905 --> 00:03:44.330
So I'm going to click location

94
00:03:44.330 --> 00:03:46.490
and I'm going to
click on Transform.

95
00:03:46.490 --> 00:03:50.275
The button we're looking
for is the Fill button.

96
00:03:50.275 --> 00:03:52.270
When you click on the drop-down,

97
00:03:52.270 --> 00:03:54.635
you can actually choose
to fill up or down.

98
00:03:54.635 --> 00:03:57.785
We want to fill down, so
we're going to click on that.

99
00:03:57.785 --> 00:04:00.785
Problem solved, too easy.

100
00:04:00.785 --> 00:04:03.590
Now once again, let's
load our query.

101
00:04:03.590 --> 00:04:05.020
So we're going to come to home,

102
00:04:05.020 --> 00:04:06.925
we're going to come
to Close and Load.

103
00:04:06.925 --> 00:04:09.380
We're going to choose
Close and Load too,

104
00:04:09.380 --> 00:04:12.230
and we're going to put it
in an existing Worksheet.

105
00:04:12.230 --> 00:04:13.790
Just make sure you've got a three

106
00:04:13.790 --> 00:04:16.760
selected and click "Okay".

107
00:04:16.760 --> 00:04:19.405
There is our completed query.

108
00:04:19.405 --> 00:04:21.860
If you have looked at
the panel on the right,

109
00:04:21.860 --> 00:04:23.510
it is showing all
the queries we've

110
00:04:23.510 --> 00:04:25.715
currently created
in this Workbook.

111
00:04:25.715 --> 00:04:27.740
If the panel gets closed,

112
00:04:27.740 --> 00:04:29.135
I'll just close it
up for a moment.

113
00:04:29.135 --> 00:04:31.490
If you come back to
Data tab and click

114
00:04:31.490 --> 00:04:34.205
queries and connections,
you can reopen it.

115
00:04:34.205 --> 00:04:36.380
You'll notice that I forgot

116
00:04:36.380 --> 00:04:38.100
to give this query
a sensible names,

117
00:04:38.100 --> 00:04:39.785
so at the moment it's
called Sheet one,

118
00:04:39.785 --> 00:04:41.540
which is not really meaningful.

119
00:04:41.540 --> 00:04:44.360
But you can easily go in
and change the name of

120
00:04:44.360 --> 00:04:47.300
the query or update the
query at any point.

121
00:04:47.300 --> 00:04:49.040
Probably the easiest
way to do this is

122
00:04:49.040 --> 00:04:50.690
to right-click on the query on

123
00:04:50.690 --> 00:04:55.050
the query editor panel
and click "Edit".

124
00:04:55.130 --> 00:04:58.505
This takes us back into
our Power Query Editor,

125
00:04:58.505 --> 00:04:59.990
and under properties,

126
00:04:59.990 --> 00:05:01.070
we're going to give
it a better name.

127
00:05:01.070 --> 00:05:03.780
So we're going to call
this Course Schedule.

128
00:05:07.970 --> 00:05:11.030
Then I'm going to click
the top part of close and

129
00:05:11.030 --> 00:05:13.640
load because we've already
chosen what to do with it,

130
00:05:13.640 --> 00:05:16.400
and our query is updated.

131
00:05:16.400 --> 00:05:18.440
Now I'd like to demonstrate what

132
00:05:18.440 --> 00:05:21.755
happens when we change our
master training schedule.

133
00:05:21.755 --> 00:05:26.090
So I'm going to hop back
is mass training schedule.

134
00:05:26.090 --> 00:05:27.500
Let's say for example,

135
00:05:27.500 --> 00:05:28.970
that Excel violence is

136
00:05:28.970 --> 00:05:30.905
actually now going
to run in room one.

137
00:05:30.905 --> 00:05:33.070
So I'm going to change
that to room one,

138
00:05:33.070 --> 00:05:35.090
and I'm going to save
my change Control

139
00:05:35.090 --> 00:05:38.585
S. When I go back to my query,

140
00:05:38.585 --> 00:05:40.685
it has not immediately updated.

141
00:05:40.685 --> 00:05:44.570
So you need to be aware that
queries do not auto refresh.

142
00:05:44.570 --> 00:05:46.275
They will need to be refreshed.

143
00:05:46.275 --> 00:05:47.730
But this is really easy to do.

144
00:05:47.730 --> 00:05:50.360
Just right-click somewhere
in the data and click

145
00:05:50.360 --> 00:05:51.860
the refresh button and you can

146
00:05:51.860 --> 00:05:54.100
see it has picked up our change.

147
00:05:54.100 --> 00:05:57.240
So we've seen how we can
use Power Query to get and

148
00:05:57.240 --> 00:06:00.230
transform data from
another Excel file.

149
00:06:00.230 --> 00:06:03.050
In the next video, we're
going to see how we can get

150
00:06:03.050 --> 00:06:06.900
data for completely
different data sources.