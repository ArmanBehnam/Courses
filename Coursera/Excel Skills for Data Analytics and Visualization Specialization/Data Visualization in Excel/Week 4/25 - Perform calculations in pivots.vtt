WEBVTT

1
00:00:05.000 --> 00:00:08.670
In this video, we can
add some extra power to

2
00:00:08.670 --> 00:00:12.165
our PivotTables by
introducing calculations.

3
00:00:12.165 --> 00:00:14.190
In our next example,

4
00:00:14.190 --> 00:00:16.890
[inaudible] would like to
get a snapshot of what

5
00:00:16.890 --> 00:00:18.360
the investment amount would look

6
00:00:18.360 --> 00:00:20.745
like in Australian dollars.

7
00:00:20.745 --> 00:00:24.120
Now there are three approaches
that he could take: one

8
00:00:24.120 --> 00:00:27.745
is he could go and add another
column into the raw data.

9
00:00:27.745 --> 00:00:30.890
That however is not always
a realistic option,

10
00:00:30.890 --> 00:00:33.065
and if we just want a snapshot,

11
00:00:33.065 --> 00:00:35.980
you don't want to be
updating your raw data.

12
00:00:35.980 --> 00:00:39.560
Another approach would be to
just add a calculation right

13
00:00:39.560 --> 00:00:43.625
here in your worksheet
using data from the pivot.

14
00:00:43.625 --> 00:00:46.400
We could just say equals
and I'm just going

15
00:00:46.400 --> 00:00:50.470
to type in b_4 times 1.45,

16
00:00:50.470 --> 00:00:52.980
and if I copy that down,

17
00:00:52.980 --> 00:00:55.155
I got my answer.

18
00:00:55.155 --> 00:00:58.670
The only problem is if
the PivotTable changes.

19
00:00:58.670 --> 00:01:03.295
So for example I remove my
filter, that's not working.

20
00:01:03.295 --> 00:01:06.725
If I were to add another
field into my columns,

21
00:01:06.725 --> 00:01:10.235
I would end up replacing
this calculation altogether,

22
00:01:10.235 --> 00:01:12.680
so I'm going to undo that change.

23
00:01:12.680 --> 00:01:14.295
That's really not ideal.

24
00:01:14.295 --> 00:01:16.520
Sometimes the best
option is actually

25
00:01:16.520 --> 00:01:20.120
include the calculation
in the Pivot,

26
00:01:20.120 --> 00:01:22.670
and we have two
ways of doing this.

27
00:01:22.670 --> 00:01:27.295
These are called Calculated
Fields and Calculated Items.

28
00:01:27.295 --> 00:01:30.950
We're going to start with
looking at a calculated field.

29
00:01:30.950 --> 00:01:33.635
Adding a calculated
field to Pivot is

30
00:01:33.635 --> 00:01:35.480
almost the equivalent of adding

31
00:01:35.480 --> 00:01:37.940
another column into
your raw data.

32
00:01:37.940 --> 00:01:40.880
The difference is it
doesn't actually take up

33
00:01:40.880 --> 00:01:42.560
any space in your worksheet

34
00:01:42.560 --> 00:01:44.800
like one of these grand totals.

35
00:01:44.800 --> 00:01:47.400
It's calculated on the go.

36
00:01:47.400 --> 00:01:49.580
To create a calculated field,

37
00:01:49.580 --> 00:01:52.565
just click anywhere
into a PivotTable.

38
00:01:52.565 --> 00:01:55.720
Come to a PivotTable Analyze,

39
00:01:55.720 --> 00:01:58.115
and in the calculation section,

40
00:01:58.115 --> 00:02:02.170
we're going to select
fields, items, and sets.

41
00:02:02.170 --> 00:02:06.440
Right at the top is the option
to add a calculated field,

42
00:02:06.440 --> 00:02:08.660
and the first thing
we have to do is

43
00:02:08.660 --> 00:02:11.760
give this new field
a sensible name.

44
00:02:15.770 --> 00:02:19.335
Now we need to provide
it with the calculation.

45
00:02:19.335 --> 00:02:20.630
So we're going to click in

46
00:02:20.630 --> 00:02:23.375
the box and just
remove that zero.

47
00:02:23.375 --> 00:02:25.535
It's a placeholder.

48
00:02:25.535 --> 00:02:27.530
Our formula is going to be

49
00:02:27.530 --> 00:02:30.550
our US dollar amount, multiply,

50
00:02:30.550 --> 00:02:36.155
so asterisk by 1.45 so adjusting
for the exchange rate.

51
00:02:36.155 --> 00:02:39.815
You can use any
arithmetic operations.

52
00:02:39.815 --> 00:02:43.850
You can use aggregation
functions like sum and average.

53
00:02:43.850 --> 00:02:46.010
You can even use the
logical functions

54
00:02:46.010 --> 00:02:48.455
like if, and, and or.

55
00:02:48.455 --> 00:02:52.040
But there are certain limitations
to these calculations.

56
00:02:52.040 --> 00:02:54.155
For one thing you can refer to

57
00:02:54.155 --> 00:02:57.175
any values outside
of the PivotTable.

58
00:02:57.175 --> 00:02:59.090
That's because the
Pivot uses an area

59
00:02:59.090 --> 00:03:00.880
of memory called the Pivot cache.

60
00:03:00.880 --> 00:03:02.780
Where all the data is loaded

61
00:03:02.780 --> 00:03:06.370
into and it actually can
refer to other values.

62
00:03:06.370 --> 00:03:10.025
So if I try to click on
somewhere outside the Pivot,

63
00:03:10.025 --> 00:03:12.350
it's not even going to let me.

64
00:03:12.350 --> 00:03:14.360
This means there
are quite a lot of

65
00:03:14.360 --> 00:03:16.445
Excel functions you can use,

66
00:03:16.445 --> 00:03:18.895
like VLOOKUPs for example.

67
00:03:18.895 --> 00:03:21.335
So while there are
some limitations,

68
00:03:21.335 --> 00:03:23.720
this is still fantastic
if you needed to

69
00:03:23.720 --> 00:03:26.920
calculate something like
just for this example.

70
00:03:26.920 --> 00:03:30.200
There's a calculation,
we're going to click Okay,

71
00:03:30.200 --> 00:03:33.020
and it's added our
additional column and

72
00:03:33.020 --> 00:03:36.080
this time if I were
to remove my filter,

73
00:03:36.080 --> 00:03:38.810
you see it still works.

74
00:03:38.810 --> 00:03:40.970
Now I'm going to undo again

75
00:03:40.970 --> 00:03:43.280
because I do want that filter on.

76
00:03:43.280 --> 00:03:46.025
Once we add a calculated field,

77
00:03:46.025 --> 00:03:48.970
you will see it adds
it to our field list.

78
00:03:48.970 --> 00:03:50.960
So we can work with it

79
00:03:50.960 --> 00:03:53.720
just like we would
any other field.

80
00:03:53.720 --> 00:03:55.700
We could even use this to create

81
00:03:55.700 --> 00:03:58.615
another calculated
field if it wanted to.

82
00:03:58.615 --> 00:04:00.755
To remove a calculated field,

83
00:04:00.755 --> 00:04:02.645
we have to reverse the procedure.

84
00:04:02.645 --> 00:04:05.720
So I'm going to click
somewhere in my Pivot,

85
00:04:05.720 --> 00:04:08.990
come to PivotTable
Analyze, come to fields,

86
00:04:08.990 --> 00:04:12.700
items and sets, and
select calculated field.

87
00:04:12.700 --> 00:04:15.420
Now to find the fields
I've already added,

88
00:04:15.420 --> 00:04:17.495
I come to the drop-down arrow,

89
00:04:17.495 --> 00:04:20.360
and you can see
we've only got one,

90
00:04:20.360 --> 00:04:23.030
and if I select it I now have

91
00:04:23.030 --> 00:04:26.210
the option to modify
it or delete it.

92
00:04:26.210 --> 00:04:28.505
I'm going to click Delete,

93
00:04:28.505 --> 00:04:31.285
and then Okay, and it's gone.

94
00:04:31.285 --> 00:04:33.350
So really useful option,

95
00:04:33.350 --> 00:04:36.085
but it does come with
a small caution.

96
00:04:36.085 --> 00:04:38.950
When we create a standard
Excel calculation,

97
00:04:38.950 --> 00:04:41.555
each uses the cells
we've selected.

98
00:04:41.555 --> 00:04:43.700
But calculated fields actually

99
00:04:43.700 --> 00:04:45.965
use entire columns of data,

100
00:04:45.965 --> 00:04:49.730
and that can sometimes lead
to unexpected results.

101
00:04:49.730 --> 00:04:51.725
Allow me to demonstrate.

102
00:04:51.725 --> 00:04:53.765
So I've got my demo workbook

103
00:04:53.765 --> 00:04:55.535
that we were looking at before,

104
00:04:55.535 --> 00:04:58.160
and I've got a very
simple Pivot here showing

105
00:04:58.160 --> 00:05:01.505
a number of items and
how many were sold.

106
00:05:01.505 --> 00:05:05.015
Now what I would do is
create a calculated field

107
00:05:05.015 --> 00:05:08.660
that will multiply the
quantity by the price,

108
00:05:08.660 --> 00:05:11.675
and to keep it simple they
are all priced at $10.

109
00:05:11.675 --> 00:05:14.365
So we are going to come
to PivotTable Analyze,

110
00:05:14.365 --> 00:05:16.170
fields, items and sets,

111
00:05:16.170 --> 00:05:21.645
calculated field, and this
is going to be my cost.

112
00:05:21.645 --> 00:05:25.870
I'm just going to take
price and multiply that by

113
00:05:25.870 --> 00:05:29.010
quantity and when I say

114
00:05:29.010 --> 00:05:33.580
okay at first glance I seem
to have got the answer right.

115
00:05:33.580 --> 00:05:35.665
But when I look at the total,

116
00:05:35.665 --> 00:05:38.305
something extremely
odd has happened.

117
00:05:38.305 --> 00:05:40.990
Forty two items at $10 each,

118
00:05:40.990 --> 00:05:43.105
I should be getting $420.

119
00:05:43.105 --> 00:05:45.565
In t dollars, so what's going on?

120
00:05:45.565 --> 00:05:48.115
Like I said, the
Calculated Fields are

121
00:05:48.115 --> 00:05:51.280
actually working with
the entire columns.

122
00:05:51.280 --> 00:05:52.810
What's happened here is,

123
00:05:52.810 --> 00:05:55.810
it's added up all
the prices and then

124
00:05:55.810 --> 00:06:01.130
multiply that by the
42 to get our 5,040.

125
00:06:01.130 --> 00:06:03.720
Now we could just
hide the grand total,

126
00:06:03.720 --> 00:06:05.550
make the problem go away.

127
00:06:05.550 --> 00:06:08.055
But we do need to
be a little careful

128
00:06:08.055 --> 00:06:11.085
because if I swap product
out of the category,

129
00:06:11.085 --> 00:06:15.455
you can see those prices
are totally incorrect.

130
00:06:15.455 --> 00:06:17.815
We do need to be a little careful

131
00:06:17.815 --> 00:06:20.365
when working with the
calculated items,

132
00:06:20.365 --> 00:06:22.195
but not to put you off.

133
00:06:22.195 --> 00:06:26.005
They can give you some great
analytical capabilities.

134
00:06:26.005 --> 00:06:27.820
Back in my original workbook,

135
00:06:27.820 --> 00:06:30.505
we're going to look at the
other type of calculation,

136
00:06:30.505 --> 00:06:33.580
which is called a
Calculated Item.

137
00:06:33.580 --> 00:06:36.250
Unlike a calculated field,

138
00:06:36.250 --> 00:06:39.220
calculated items
are the equivalent

139
00:06:39.220 --> 00:06:41.035
of creating another row.

140
00:06:41.035 --> 00:06:42.670
Let's for example say that I

141
00:06:42.670 --> 00:06:44.965
wanted to get my
total for Brazil,

142
00:06:44.965 --> 00:06:47.200
Ecuador, and Italy, and show

143
00:06:47.200 --> 00:06:49.675
that as a row in its own rights.

144
00:06:49.675 --> 00:06:52.870
I could do that using
a calculated item.

145
00:06:52.870 --> 00:06:56.649
There is a restriction however
with calculated items,

146
00:06:56.649 --> 00:06:58.900
you cannot add a
calculated item to

147
00:06:58.900 --> 00:07:02.005
a PivotTable that has
a group field in it.

148
00:07:02.005 --> 00:07:04.420
Now you might recall
that we actually

149
00:07:04.420 --> 00:07:07.525
group our date function
to get our years.

150
00:07:07.525 --> 00:07:10.960
If I click somewhere
into my row labels,

151
00:07:10.960 --> 00:07:12.625
come up to Fields,

152
00:07:12.625 --> 00:07:16.885
Items and Sets, and
select "Calculated Item",

153
00:07:16.885 --> 00:07:19.700
it tells me "No".

154
00:07:19.860 --> 00:07:22.390
Well that's not a problem.

155
00:07:22.390 --> 00:07:25.690
I can just go and create
another PivotTable.

156
00:07:25.690 --> 00:07:28.720
Well there again, you
may run into issues.

157
00:07:28.720 --> 00:07:30.970
In the newer versions of Excel,

158
00:07:30.970 --> 00:07:34.615
when you create a PivotTable
from the same data source,

159
00:07:34.615 --> 00:07:37.645
it automatically shares
the pivot cache.

160
00:07:37.645 --> 00:07:39.640
In other words, when I go

161
00:07:39.640 --> 00:07:41.470
and create a separate PivotTable,

162
00:07:41.470 --> 00:07:44.290
it is still going to
have disuse field.

163
00:07:44.290 --> 00:07:46.495
So I'm still not
going to be able to

164
00:07:46.495 --> 00:07:48.940
add a calculated item.

165
00:07:48.940 --> 00:07:51.820
What we're going to look at
next is a workaround for

166
00:07:51.820 --> 00:07:55.030
creating a PivotTable that
has its own pivot cache.

167
00:07:55.030 --> 00:07:56.860
This does have the downside of

168
00:07:56.860 --> 00:07:59.870
effectively doubling
our PivotTable storage,

169
00:07:59.870 --> 00:08:01.875
but it will give
us the flexibility

170
00:08:01.875 --> 00:08:04.215
to work with it independently.

171
00:08:04.215 --> 00:08:08.175
We're going to come back to
our renewable investments.

172
00:08:08.175 --> 00:08:10.650
Click somewhere in the data,

173
00:08:10.650 --> 00:08:13.230
and a strange keyboard shortcut.

174
00:08:13.230 --> 00:08:15.030
We're going to press Alt,

175
00:08:15.030 --> 00:08:19.360
D and P. This opens up
our PivotChart wizard.

176
00:08:19.360 --> 00:08:21.355
This is actually an old wizard,

177
00:08:21.355 --> 00:08:23.830
which is no longer
available in the ribbon.

178
00:08:23.830 --> 00:08:26.770
But you can customize
your ribbon and edit.

179
00:08:26.770 --> 00:08:29.395
Or you can customize your
Quick Access Toolbar.

180
00:08:29.395 --> 00:08:32.065
I find it easier to just use Alt,

181
00:08:32.065 --> 00:08:35.590
D and P. Now first we're
just going to click "Next."

182
00:08:35.590 --> 00:08:39.505
It is not picking up our
table name automatically.

183
00:08:39.505 --> 00:08:42.640
That's because the
wizard predates tables.

184
00:08:42.640 --> 00:08:46.765
Now we're just going to replace
that with tblinvestment,

185
00:08:46.765 --> 00:08:49.075
and then I'm going
to click "Next."

186
00:08:49.075 --> 00:08:51.460
This wordy dialogue is trying to

187
00:08:51.460 --> 00:08:53.590
persuade you to share a cache,

188
00:08:53.590 --> 00:08:54.895
and if you click "Yes",

189
00:08:54.895 --> 00:08:56.230
that's what will happen.

190
00:08:56.230 --> 00:09:00.475
But we're going to select
"No" and just click "Finish."

191
00:09:00.475 --> 00:09:04.300
Now we've created a new
PivotTable from the same data.

192
00:09:04.300 --> 00:09:06.595
But if we have a look down here,

193
00:09:06.595 --> 00:09:08.605
there's no years field.

194
00:09:08.605 --> 00:09:12.385
We can see this is definitely
using its own cache.

195
00:09:12.385 --> 00:09:14.920
Let's quickly create output.

196
00:09:14.920 --> 00:09:18.474
I'm going to add
region and amount.

197
00:09:18.474 --> 00:09:21.220
What Ron wants to do is rather

198
00:09:21.220 --> 00:09:24.040
than showing these
discrete values,

199
00:09:24.040 --> 00:09:26.050
he would like to see
the percentage of

200
00:09:26.050 --> 00:09:28.825
investment in Europe versus Asia,

201
00:09:28.825 --> 00:09:32.365
and then the percentage of
North America versus Asia.

202
00:09:32.365 --> 00:09:36.805
To do this, we're going to
add two calculated items.

203
00:09:36.805 --> 00:09:40.899
Making sure we've click
somewhere into the row labels,

204
00:09:40.899 --> 00:09:42.880
we're going to come up to Fields,

205
00:09:42.880 --> 00:09:45.040
Items and Sets, and

206
00:09:45.040 --> 00:09:47.530
we're going to choose
"Calculated Item."

207
00:09:47.530 --> 00:09:50.020
You see this dialog looks
a little bit different

208
00:09:50.020 --> 00:09:52.675
because it doesn't just
give you the fields,

209
00:09:52.675 --> 00:09:56.270
it gives you the items
within the field.

210
00:09:56.340 --> 00:09:58.870
The first one we're
going to create is

211
00:09:58.870 --> 00:10:01.610
going to be EU versus Asia.

212
00:10:01.610 --> 00:10:04.380
We're going to replace
the zero by taking

213
00:10:04.380 --> 00:10:06.360
our Europe investment and

214
00:10:06.360 --> 00:10:09.600
dividing it by our
Asia investment,

215
00:10:09.600 --> 00:10:12.335
and then we're going
to click "Add."

216
00:10:12.335 --> 00:10:14.530
Now to add the next one,

217
00:10:14.530 --> 00:10:17.320
we need to first
give it a new name.

218
00:10:17.320 --> 00:10:21.355
This is going to be North
America versus Asia.

219
00:10:21.355 --> 00:10:24.520
Again we need to select region.

220
00:10:24.520 --> 00:10:28.400
This time we're going
to take North America

221
00:10:28.680 --> 00:10:31.795
and divide it by Asia

222
00:10:31.795 --> 00:10:35.210
and then we're going
to click "Okay".

223
00:10:36.570 --> 00:10:40.360
Our two calculated
items have been added.

224
00:10:40.360 --> 00:10:42.100
Now it doesn't really make sense

225
00:10:42.100 --> 00:10:43.675
to compare two different things,

226
00:10:43.675 --> 00:10:45.760
like miles versus liters.

227
00:10:45.760 --> 00:10:48.340
We are going to come to our rows,

228
00:10:48.340 --> 00:10:50.515
we're going to unselect all,

229
00:10:50.515 --> 00:10:54.205
we're just going to
show our two new items.

230
00:10:54.205 --> 00:10:56.275
Then we should probably turn off

231
00:10:56.275 --> 00:10:58.630
our grand totals as well.

232
00:10:58.630 --> 00:11:00.910
In our design tab,

233
00:11:00.910 --> 00:11:02.680
let's flip those off,

234
00:11:02.680 --> 00:11:06.260
and let's convert
these to percentages.

235
00:11:07.020 --> 00:11:10.390
There's our completed PivotTable

236
00:11:10.390 --> 00:11:13.420
using our two calculations.

237
00:11:13.420 --> 00:11:16.660
While there are obviously
a few limitations with

238
00:11:16.660 --> 00:11:19.659
Calculated Fields and
Calculated Items,

239
00:11:19.659 --> 00:11:22.900
they do unlock a wealth
of opportunities.

240
00:11:22.900 --> 00:11:25.450
Make sure that you
download the workbook

241
00:11:25.450 --> 00:11:28.850
and practice these
great new skills.