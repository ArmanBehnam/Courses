WEBVTT

1
00:00:04.820 --> 00:00:09.210
In this video, we're going to
introduce Macros for making

2
00:00:09.210 --> 00:00:11.925
visualizations both
interactive and

3
00:00:11.925 --> 00:00:15.120
automated. What is a macro?

4
00:00:15.120 --> 00:00:18.015
Macro is a small program that can

5
00:00:18.015 --> 00:00:21.345
automate repetitive
or difficult tasks.

6
00:00:21.345 --> 00:00:23.670
They can be coded from scratch.

7
00:00:23.670 --> 00:00:26.795
But Excel comes with
built-in macro recorder,

8
00:00:26.795 --> 00:00:28.550
where you can record
yourself going through

9
00:00:28.550 --> 00:00:31.295
certain steps and then
just play it back.

10
00:00:31.295 --> 00:00:33.895
That's the approach
we're going to take.

11
00:00:33.895 --> 00:00:36.260
Now what Ran wants to do is add

12
00:00:36.260 --> 00:00:40.015
one last conditional
format to the spreadsheet.

13
00:00:40.015 --> 00:00:42.110
But he wants to be able to

14
00:00:42.110 --> 00:00:45.020
select a state or
territory by clicking

15
00:00:45.020 --> 00:00:46.880
in the map and then have

16
00:00:46.880 --> 00:00:50.215
the core waste data for
that territory highlight.

17
00:00:50.215 --> 00:00:53.760
So let's start by doing
the conditional format.

18
00:00:53.760 --> 00:00:55.280
This is a bit different
because we adding

19
00:00:55.280 --> 00:00:57.965
a conditional format
to an entire row.

20
00:00:57.965 --> 00:01:02.430
So we're going to select
our data and come up to

21
00:01:02.430 --> 00:01:05.000
Conditional Formatting and
we're going to need to come

22
00:01:05.000 --> 00:01:08.615
to New Rule because we
need a formula for this.

23
00:01:08.615 --> 00:01:11.450
Then we're going to click
in the bar where we enter

24
00:01:11.450 --> 00:01:14.375
our formula and we're
going to type out equals.

25
00:01:14.375 --> 00:01:16.160
We're going to check
if our states.

26
00:01:16.160 --> 00:01:18.110
We're going to click
on the first state

27
00:01:18.110 --> 00:01:19.430
and we want to see
if that's equal

28
00:01:19.430 --> 00:01:23.260
to K1 but you'll notice it's
put those dollars on again.

29
00:01:23.260 --> 00:01:27.860
Now last time we split this
over to a relative reference,

30
00:01:27.860 --> 00:01:30.325
but this time we need to
do something different.

31
00:01:30.325 --> 00:01:32.670
As it goes down
evaluating the states,

32
00:01:32.670 --> 00:01:36.104
we do want it to change
but as it goes across,

33
00:01:36.104 --> 00:01:39.110
we need it to keep
referring back to column B.

34
00:01:39.110 --> 00:01:42.000
So we're going to press
our F4 function key

35
00:01:42.000 --> 00:01:45.660
twice so we still have the
dollar in front of the B.

36
00:01:45.660 --> 00:01:47.630
We're then going to type equals

37
00:01:47.630 --> 00:01:49.625
and check if it's equal to K1.

38
00:01:49.625 --> 00:01:51.350
Now we need to add a format.

39
00:01:51.350 --> 00:01:53.540
So let's just make
it blue and will

40
00:01:53.540 --> 00:01:56.730
change our font color to white.

41
00:01:56.810 --> 00:02:00.900
We're then going to
say "Okay" and "Okay".

42
00:02:00.900 --> 00:02:03.470
ACTs data is highlighting.

43
00:02:03.470 --> 00:02:05.705
If I come to K1 and change that

44
00:02:05.705 --> 00:02:08.285
to Northern Territories,
that's working.

45
00:02:08.285 --> 00:02:10.910
But you'll notice that
the new format is

46
00:02:10.910 --> 00:02:13.745
actually covering
up the bottom five.

47
00:02:13.745 --> 00:02:15.380
Now we can change this.

48
00:02:15.380 --> 00:02:18.860
So if we click into our data,

49
00:02:18.860 --> 00:02:20.965
come back to
Conditional Formatting

50
00:02:20.965 --> 00:02:23.110
and come to Manage Rules.

51
00:02:23.110 --> 00:02:27.820
From here, you can delete
or edit existing rules.

52
00:02:27.820 --> 00:02:29.630
As we add new ones,

53
00:02:29.630 --> 00:02:31.700
they're added to the top of
the list and these are given

54
00:02:31.700 --> 00:02:34.355
priority over rules
low in the list,

55
00:02:34.355 --> 00:02:36.220
but we can change the sequence.

56
00:02:36.220 --> 00:02:38.395
So I'm going to
click on "Bottom 5",

57
00:02:38.395 --> 00:02:40.090
move it up, say

58
00:02:40.090 --> 00:02:43.830
"Okay" and we can now
see our Bottom 5 rule.

59
00:02:43.830 --> 00:02:47.165
So that was a conditional
formatting taken care of.

60
00:02:47.165 --> 00:02:53.150
Now how do we link up our
map to our dropdown list?

61
00:02:53.150 --> 00:02:55.070
What we're going to
do is we're going to

62
00:02:55.070 --> 00:02:57.035
record a simple macro

63
00:02:57.035 --> 00:03:02.140
where we record ourselves
typing the value ACT into K1.

64
00:03:02.140 --> 00:03:04.445
You then have the option to link

65
00:03:04.445 --> 00:03:06.500
any graphical object to a macro.

66
00:03:06.500 --> 00:03:08.420
So we're going to take
the shape covering

67
00:03:08.420 --> 00:03:10.760
the ACT region and

68
00:03:10.760 --> 00:03:13.960
we're going to hook that
up to our ACT macro.

69
00:03:13.960 --> 00:03:16.620
Before we can record
the macro though,

70
00:03:16.620 --> 00:03:19.025
there are two important
things we need to do.

71
00:03:19.025 --> 00:03:22.040
The first one is
save our workbook as

72
00:03:22.040 --> 00:03:24.290
a macro-enabled workbook because

73
00:03:24.290 --> 00:03:27.790
normal Excel spreadsheets
do not support macros.

74
00:03:27.790 --> 00:03:30.255
So we're going to come to File.

75
00:03:30.255 --> 00:03:33.150
We're going to click "Save As".

76
00:03:33.150 --> 00:03:37.190
We're going to change this
from an Excel workbook to

77
00:03:37.190 --> 00:03:39.875
an Excel macro-enabled workbook

78
00:03:39.875 --> 00:03:42.530
and we're going to click "Save".

79
00:03:42.530 --> 00:03:45.170
The second thing we have to do is

80
00:03:45.170 --> 00:03:47.660
show our Developer
tab in the ribbon.

81
00:03:47.660 --> 00:03:49.370
It doesn't show by default.

82
00:03:49.370 --> 00:03:51.395
So if you haven't used it before,

83
00:03:51.395 --> 00:03:53.030
come to your File tab,

84
00:03:53.030 --> 00:03:54.935
come down to Options,

85
00:03:54.935 --> 00:03:57.205
come to Customize Ribbon

86
00:03:57.205 --> 00:03:59.940
and put a tick next to Developer.

87
00:03:59.940 --> 00:04:01.740
Then just say, "Okay".

88
00:04:01.740 --> 00:04:03.660
The Developer tab should now

89
00:04:03.660 --> 00:04:06.180
appear and we're going
to click on that.

90
00:04:06.180 --> 00:04:07.810
The first group in

91
00:04:07.810 --> 00:04:10.075
the Developer tab is
called the code group.

92
00:04:10.075 --> 00:04:13.090
This gives us all the tools
we need for recording,

93
00:04:13.090 --> 00:04:16.115
editing, and running macros.

94
00:04:16.115 --> 00:04:18.780
Before we hit the
"Record" button though,

95
00:04:18.780 --> 00:04:21.640
we just going to make sure
that we clicked away from

96
00:04:21.640 --> 00:04:23.830
K1 because the first
thing we want to

97
00:04:23.830 --> 00:04:26.675
record ourselves doing
is clicking onto K1.

98
00:04:26.675 --> 00:04:29.565
So do that and then
click "Record Macro".

99
00:04:29.565 --> 00:04:31.210
Now we have to give our macro

100
00:04:31.210 --> 00:04:33.465
a name that's unique
within the workbook.

101
00:04:33.465 --> 00:04:36.080
I'm going to call it ACT

102
00:04:36.950 --> 00:04:39.250
and then you have the option of

103
00:04:39.250 --> 00:04:40.780
giving it a keyboard shortcut,

104
00:04:40.780 --> 00:04:42.310
but Control + A, in fact,

105
00:04:42.310 --> 00:04:45.340
Control A through Z are
already accounted for.

106
00:04:45.340 --> 00:04:48.240
So if you hold your
"Shift" key down,

107
00:04:48.240 --> 00:04:52.010
you can use the keyboard
shortcut Control + Shift + A.

108
00:04:52.010 --> 00:04:54.545
We're then going to say "Okay".

109
00:04:54.545 --> 00:04:57.715
Now anything we do is
going to be recorded.

110
00:04:57.715 --> 00:05:00.180
We're going to start
by clicking into K1.

111
00:05:00.180 --> 00:05:02.160
We're going to type ACT.

112
00:05:02.160 --> 00:05:03.900
Don't use the drop-down.

113
00:05:03.900 --> 00:05:06.770
Then click to wherever you want

114
00:05:06.770 --> 00:05:09.620
the active cell to be when
the macro finishes running.

115
00:05:09.620 --> 00:05:11.935
So I'm going to click on B4.

116
00:05:11.935 --> 00:05:16.575
Now really important, you
must stop the recording.

117
00:05:16.575 --> 00:05:19.140
Let's do another one. So I'm

118
00:05:19.140 --> 00:05:20.725
going to click "Record Macro".

119
00:05:20.725 --> 00:05:23.540
This time I'm going
to call it NSW.

120
00:05:23.540 --> 00:05:25.430
I'm going to make my
keyboard shortcut

121
00:05:25.430 --> 00:05:26.705
Control + Shift + M.

122
00:05:26.705 --> 00:05:30.020
Just hold the Shift not
the Control and say,

123
00:05:30.020 --> 00:05:32.365
"Okay", and now
I'm going to click

124
00:05:32.365 --> 00:05:35.860
into K1 and I'm
going to type NSW.

125
00:05:35.860 --> 00:05:40.225
Again, click away and
press "Stop Recording".

126
00:05:40.225 --> 00:05:43.445
Let's test if those
macros are working.

127
00:05:43.445 --> 00:05:45.930
So we're going to press
Control + Shift + A.

128
00:05:45.930 --> 00:05:49.680
Yeah, that worked beautifully
and now Control +

129
00:05:49.680 --> 00:05:52.740
Shift + N. Fantastic.

130
00:05:52.740 --> 00:05:56.240
So really easy to create
a recorded macro.

131
00:05:56.240 --> 00:05:59.680
Be quite good to see what
these macros look like.

132
00:05:59.680 --> 00:06:01.360
So we're going to come up to

133
00:06:01.360 --> 00:06:04.520
our code group and click
on the "Macros" button.

134
00:06:04.520 --> 00:06:06.670
This dialogue will
allow you to run

135
00:06:06.670 --> 00:06:08.785
the macro if you don't
have a keyboard shortcut.

136
00:06:08.785 --> 00:06:11.140
You can delete it if you've
made a mistake and just start

137
00:06:11.140 --> 00:06:13.555
again or you can edit the macro.

138
00:06:13.555 --> 00:06:15.395
We're going to click "Edit".

139
00:06:15.395 --> 00:06:18.485
Welcome to the VBA editor.

140
00:06:18.485 --> 00:06:20.180
The code we're looking at is

141
00:06:20.180 --> 00:06:22.205
Visual Basic for applications.

142
00:06:22.205 --> 00:06:26.125
This is code that our macros
are written in in Excel.

143
00:06:26.125 --> 00:06:29.030
At first glance, it might
look a little foreign,

144
00:06:29.030 --> 00:06:31.880
but we're just going to take
a moment to break it down.

145
00:06:31.880 --> 00:06:34.415
All recorded macros
begin with the word

146
00:06:34.415 --> 00:06:37.250
Sub and end with End Sub.

147
00:06:37.250 --> 00:06:39.710
Make sure any code you
want to run appears

148
00:06:39.710 --> 00:06:42.460
between those two and that
you don't delete them.

149
00:06:42.460 --> 00:06:45.240
The stuff in green is
what we call a comment.

150
00:06:45.240 --> 00:06:47.780
It's going to be ignored
by the compiler,

151
00:06:47.780 --> 00:06:49.060
so it's not actually
going to run.

152
00:06:49.060 --> 00:06:52.775
But it's useful for giving
information about the macro,

153
00:06:52.775 --> 00:06:56.530
like who wrote it or
when it was changed.

154
00:06:56.530 --> 00:06:59.875
If I wanted to remove
a line of code,

155
00:06:59.875 --> 00:07:01.450
I could just put an apostrophe

156
00:07:01.450 --> 00:07:02.650
and you'll see that comments it

157
00:07:02.650 --> 00:07:06.815
out and if I remove the
apostrophe, it's back.

158
00:07:06.815 --> 00:07:10.680
Getting into the code
itself, Range ("K1").

159
00:07:10.680 --> 00:07:12.480
Select. Well, we can work
out what that's doing,

160
00:07:12.480 --> 00:07:14.130
it's selecting the cell K1.

161
00:07:14.130 --> 00:07:16.110
We're then changing the value

162
00:07:16.110 --> 00:07:18.420
in the active cell to be ACT.

163
00:07:18.420 --> 00:07:20.610
Then we're selecting before.

164
00:07:20.610 --> 00:07:22.840
Not easy to write from scratch,

165
00:07:22.840 --> 00:07:27.550
but very easy to understand
and very easy to change.

166
00:07:27.550 --> 00:07:32.380
So rather than going and
recording my other six macros,

167
00:07:32.380 --> 00:07:35.495
I can just copy paste
this and edit it.

168
00:07:35.495 --> 00:07:37.155
I'm going to select the data,

169
00:07:37.155 --> 00:07:39.390
the macro for New South Wales,

170
00:07:39.390 --> 00:07:44.210
Control + C. Click underneath
the end sub and paste.

171
00:07:44.210 --> 00:07:46.100
Now all I need to do is replace

172
00:07:46.100 --> 00:07:48.320
all the NSW with another state.

173
00:07:48.320 --> 00:07:50.600
So I'm going to go for
Western Australia.

174
00:07:50.600 --> 00:07:52.460
Don't have the
keyboard shortcuts,

175
00:07:52.460 --> 00:07:54.370
so I'll remove that.

176
00:07:54.370 --> 00:07:56.480
Then very important,
make sure that

177
00:07:56.480 --> 00:08:00.200
the active cell is changed to WA.

178
00:08:00.200 --> 00:08:04.130
Now to get back into our
workbook to check this,

179
00:08:04.130 --> 00:08:07.310
you could close this window
or great keyboard shortcut,

180
00:08:07.310 --> 00:08:09.470
Alt + F11, toggles you

181
00:08:09.470 --> 00:08:12.840
between the spreadsheet
and your code.

182
00:08:12.840 --> 00:08:15.340
We're going to test the WA macro,

183
00:08:15.340 --> 00:08:19.090
but we want to now test it
by clicking in the map.

184
00:08:19.090 --> 00:08:21.500
So we're going to
come to the circle,

185
00:08:21.500 --> 00:08:25.070
which is a shape just
over the WA territory,

186
00:08:25.070 --> 00:08:27.625
and shapes are brilliant.

187
00:08:27.625 --> 00:08:30.890
You can hook your macro up
to any graphical object.

188
00:08:30.890 --> 00:08:33.320
But shapes are very
versatile option.

189
00:08:33.320 --> 00:08:36.025
So I'm going to
right-click on that shape.

190
00:08:36.025 --> 00:08:38.625
I'm going to come
to Assign Macro.

191
00:08:38.625 --> 00:08:40.650
I'm going to choose WA,

192
00:08:40.650 --> 00:08:42.685
and then say "Okay".

193
00:08:42.685 --> 00:08:45.870
Now let's repeat that for
the other two we've set up.

194
00:08:45.870 --> 00:08:47.915
So I'm going to come
to New South Wales,

195
00:08:47.915 --> 00:08:57.430
Assign Macro and ACT.

196
00:09:05.150 --> 00:09:07.590
Now let's go and test them.

197
00:09:07.590 --> 00:09:09.615
As I hover over the WA shape,

198
00:09:09.615 --> 00:09:12.150
I get that little hand
icon and when I click

199
00:09:12.150 --> 00:09:15.105
on it, that's worked
fantastically.

200
00:09:15.105 --> 00:09:19.710
Same for New South
Wales and same for ACT.

201
00:09:19.710 --> 00:09:24.110
So we've seen how using
a simple recorded macro,

202
00:09:24.110 --> 00:09:27.230
we can add some fantastic
interactive features

203
00:09:27.230 --> 00:09:29.555
to our visualizations
and our worksheets.

204
00:09:29.555 --> 00:09:31.490
For your optional homework,
try finishing off

205
00:09:31.490 --> 00:09:33.240
the rest macros and
hooking them all

206
00:09:33.240 --> 00:09:36.010
up to the map so it works nicely.