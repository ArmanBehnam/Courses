WEBVTT

1
00:00:04.370 --> 00:00:08.010
In this video, we're going
to start looking at how

2
00:00:08.010 --> 00:00:09.555
Named Ranges can be used to

3
00:00:09.555 --> 00:00:12.060
automate functionality
in Workbooks.

4
00:00:12.060 --> 00:00:13.425
This is actually

5
00:00:13.425 --> 00:00:16.140
the most important
reason for using them.

6
00:00:16.140 --> 00:00:18.180
The example we're going
to look at is how we

7
00:00:18.180 --> 00:00:20.040
can automate data validation,

8
00:00:20.040 --> 00:00:22.740
but that's just one
of many examples.

9
00:00:22.740 --> 00:00:24.690
Now just before we get started,

10
00:00:24.690 --> 00:00:25.980
we're going to create one last

11
00:00:25.980 --> 00:00:27.855
Named Range, so good practice.

12
00:00:27.855 --> 00:00:31.050
We want to name the
locations Named Range,

13
00:00:31.050 --> 00:00:32.910
and the quickest
way to do this is

14
00:00:32.910 --> 00:00:35.145
using our Create from Selection.

15
00:00:35.145 --> 00:00:38.664
So I'm going to select
from A7 down to A9,

16
00:00:38.664 --> 00:00:41.055
and keyboard shortcut,
you might remember,

17
00:00:41.055 --> 00:00:43.755
is "Control+ Shift+ F3".

18
00:00:43.755 --> 00:00:45.630
Top row is what I want,

19
00:00:45.630 --> 00:00:47.805
so I'm just going
to press "Enter."

20
00:00:47.805 --> 00:00:50.430
If I double check my name box,

21
00:00:50.430 --> 00:00:54.880
there is my locations and
here's my two cities.

22
00:00:54.880 --> 00:00:58.360
Let's come back into
our invoice report.

23
00:00:58.360 --> 00:01:02.330
Zara has added
conditional formatting

24
00:01:02.330 --> 00:01:06.830
so that if I come into
K2 and type Sydney,

25
00:01:06.830 --> 00:01:09.229
it'll automatically highlight

26
00:01:09.229 --> 00:01:11.105
all the Sydney rows
and of course,

27
00:01:11.105 --> 00:01:12.770
the same happens for Melbourne.

28
00:01:12.770 --> 00:01:14.915
Now we're going to look
at conditional formatting

29
00:01:14.915 --> 00:01:17.080
a lot more in the next course,

30
00:01:17.080 --> 00:01:20.435
but what we're going to
focus on Zara's problem,

31
00:01:20.435 --> 00:01:23.135
which is she doesn't want
to have to type it in.

32
00:01:23.135 --> 00:01:25.400
She would like a drop
down list where she

33
00:01:25.400 --> 00:01:28.090
can select Sydney or Melbourne.

34
00:01:28.090 --> 00:01:32.285
Now to do this, we use something
called Data Validation.

35
00:01:32.285 --> 00:01:34.250
Just going to delete
that for a moment.

36
00:01:34.250 --> 00:01:36.560
With K2 selected,
we're going to come to

37
00:01:36.560 --> 00:01:41.355
our Data tab and we're going
to click "Data Validation."

38
00:01:41.355 --> 00:01:43.830
Data Validation allows us to

39
00:01:43.830 --> 00:01:45.800
control what users input into

40
00:01:45.800 --> 00:01:48.080
a cell so we can specify that

41
00:01:48.080 --> 00:01:51.035
a number must be within a
certain range, for example.

42
00:01:51.035 --> 00:01:54.380
It also allows us to
create drop down lists,

43
00:01:54.380 --> 00:01:59.455
and to do this we change
the "Any Value" to "List".

44
00:01:59.455 --> 00:02:01.550
In the Source box, we need to

45
00:02:01.550 --> 00:02:03.830
specify what we see in that list.

46
00:02:03.830 --> 00:02:05.930
We could just type values,

47
00:02:05.930 --> 00:02:09.085
but then we would have to
come and manually change it

48
00:02:09.085 --> 00:02:12.520
every time there was a change
and that we don't want,

49
00:02:12.520 --> 00:02:15.429
so we're going to use
a Named Range instead.

50
00:02:15.429 --> 00:02:19.270
You can type the name of
the range or even better,

51
00:02:19.270 --> 00:02:21.590
you can come to
your Formulas tab,

52
00:02:21.590 --> 00:02:25.680
click "Use in Formula"
and choose Locations.

53
00:02:25.680 --> 00:02:29.340
A keyboard shortcut
for this is F3.

54
00:02:29.340 --> 00:02:32.025
Now we're going to click "Okay."

55
00:02:32.025 --> 00:02:34.170
A drop down has appeared

56
00:02:34.170 --> 00:02:35.910
and if I click on that drop-down,

57
00:02:35.910 --> 00:02:38.565
I can choose Sydney or Melbourne.

58
00:02:38.565 --> 00:02:40.815
So that's half of it done,

59
00:02:40.815 --> 00:02:42.785
we've created our data validation

60
00:02:42.785 --> 00:02:45.160
and we've linked it
to a Named Range,

61
00:02:45.160 --> 00:02:50.065
but we would like that named
range to automatically grow.

62
00:02:50.065 --> 00:02:52.534
So back in my Recon Analysis,

63
00:02:52.534 --> 00:02:55.100
if I add another region,

64
00:02:55.100 --> 00:02:57.970
I want it to appear
in my drop down list.

65
00:02:57.970 --> 00:03:00.515
So I have to have
a way of somehow

66
00:03:00.515 --> 00:03:03.500
making my Named
Ranges more dynamic.

67
00:03:03.500 --> 00:03:06.610
We can do this using
a calculation.

68
00:03:06.610 --> 00:03:09.390
The calculation has two parts.

69
00:03:09.390 --> 00:03:11.330
The first part is to work

70
00:03:11.330 --> 00:03:13.690
out how many values
we actually have.

71
00:03:13.690 --> 00:03:15.305
That's quite straightforward,

72
00:03:15.305 --> 00:03:17.885
I'll demonstrate in
this cell over here.

73
00:03:17.885 --> 00:03:21.455
So if I type "=COU",

74
00:03:21.455 --> 00:03:23.255
I want to count,

75
00:03:23.255 --> 00:03:24.650
but I'm not counting numbers,

76
00:03:24.650 --> 00:03:27.080
so I have to actually
use COUNTA function,

77
00:03:27.080 --> 00:03:29.670
which is count alphanumerics.

78
00:03:30.530 --> 00:03:33.360
So I'm going to double
click "COUNTA."

79
00:03:33.360 --> 00:03:36.430
Then assuming I'll never
have more than 10 regions,

80
00:03:36.430 --> 00:03:38.545
I'm going to select A8 down to

81
00:03:38.545 --> 00:03:43.725
A18 and press "Enter" and
that's telling me that too.

82
00:03:43.725 --> 00:03:45.700
If I added another region,

83
00:03:45.700 --> 00:03:47.755
you can see it picks up three.

84
00:03:47.755 --> 00:03:49.685
I'll undo that for now.

85
00:03:49.685 --> 00:03:51.910
So that's the first part,

86
00:03:51.910 --> 00:03:56.560
but the Named Range actually
means the actual values.

87
00:03:56.560 --> 00:03:58.630
To do that, we're
going to need to use

88
00:03:58.630 --> 00:04:02.210
a slightly trickier function
called the OFFSET function.

89
00:04:02.210 --> 00:04:04.085
What the OFFSET does is,

90
00:04:04.085 --> 00:04:05.815
given a starting point,

91
00:04:05.815 --> 00:04:08.605
it will return a block of data,

92
00:04:08.605 --> 00:04:10.975
a certain number
of rows or columns

93
00:04:10.975 --> 00:04:13.570
away from that starting point.

94
00:04:13.570 --> 00:04:17.250
Let's go build the whole
thing in the Name Manager.

95
00:04:17.250 --> 00:04:19.530
So back into my Name Manager,

96
00:04:19.530 --> 00:04:21.585
I'm going to come to Locations

97
00:04:21.585 --> 00:04:23.700
and I'm going to click "Edit."

98
00:04:23.700 --> 00:04:27.035
I'm going to replace
this hard coded

99
00:04:27.035 --> 00:04:30.185
Named Range with something
that is calculated.

100
00:04:30.185 --> 00:04:32.750
I'm going to remove
all of that and I'm

101
00:04:32.750 --> 00:04:35.645
going to use the OFFSET
function to do this.

102
00:04:35.645 --> 00:04:38.585
So I'm going to type offset
and open my brackets.

103
00:04:38.585 --> 00:04:40.775
Now it would has to
have a starting point,

104
00:04:40.775 --> 00:04:43.190
and that is our first location,

105
00:04:43.190 --> 00:04:46.270
so I'm going to click on
A8 and then type a comma.

106
00:04:46.270 --> 00:04:48.080
Then it wants to know

107
00:04:48.080 --> 00:04:49.880
how many rows away

108
00:04:49.880 --> 00:04:51.875
from that starting
point we want to begin.

109
00:04:51.875 --> 00:04:55.475
That is 0 because we're
starting there, then a comma.

110
00:04:55.475 --> 00:04:57.680
Next, it wants to
know how many columns

111
00:04:57.680 --> 00:04:59.770
away we want to start and again,

112
00:04:59.770 --> 00:05:03.360
that is 0, and then
another comma.

113
00:05:03.360 --> 00:05:05.360
Here is where we specify

114
00:05:05.360 --> 00:05:09.260
how many rows we want to
include in our range.

115
00:05:09.260 --> 00:05:12.250
We do this with our
COUNTA, so again,

116
00:05:12.250 --> 00:05:17.415
counta and select A8 down to A18.

117
00:05:17.415 --> 00:05:20.040
Close our brackets
for our COUNTA,

118
00:05:20.040 --> 00:05:23.680
close our brackets
for our OFFSET.

119
00:05:23.810 --> 00:05:29.360
Now you can press
"Okay" and "Close."

120
00:05:29.360 --> 00:05:33.050
Let's go check that our named
range is still working.

121
00:05:33.050 --> 00:05:34.940
So we're going to
click the drop-down

122
00:05:34.940 --> 00:05:37.010
and you can see it's still
Sydney and Melbourne.

123
00:05:37.010 --> 00:05:38.870
But if I now come back into

124
00:05:38.870 --> 00:05:42.330
my Recon Analysis and add Perth,

125
00:05:43.190 --> 00:05:47.190
when I check my
drop-down this time,

126
00:05:47.190 --> 00:05:49.635
Perth has been added.

127
00:05:49.635 --> 00:05:52.035
So what we've seen is how

128
00:05:52.035 --> 00:05:54.590
data validation has automatically

129
00:05:54.590 --> 00:05:59.360
updated by using something
called a dynamic Named Range.

130
00:05:59.360 --> 00:06:03.565
For a long time, this was the
only way we could do this.

131
00:06:03.565 --> 00:06:06.785
But that calculation is
a little bit tricky,

132
00:06:06.785 --> 00:06:08.900
so I have some
great news for you.

133
00:06:08.900 --> 00:06:12.710
Next week we're going to look
at a feature called tables,

134
00:06:12.710 --> 00:06:15.905
which adds all this
automation for us without

135
00:06:15.905 --> 00:06:20.125
actually having to create
that scary OFFSET function.

136
00:06:20.125 --> 00:06:23.825
For this week though,
you've done really well.

137
00:06:23.825 --> 00:06:26.705
Don't forget to check out
our practice challenge,

138
00:06:26.705 --> 00:06:30.210
which will help you
consolidate all your skills.