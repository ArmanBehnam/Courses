WEBVTT

1
00:00:00.000 --> 00:00:06.255
In this video,

2
00:00:06.255 --> 00:00:07.560
we're going to look at two

3
00:00:07.560 --> 00:00:09.660
really versatile lookup functions

4
00:00:09.660 --> 00:00:12.180
called the INDEX and the MATCH.

5
00:00:12.180 --> 00:00:15.525
We are going to help Zara
finish over reconciliation.

6
00:00:15.525 --> 00:00:17.250
But to begin with,
I'd like to start

7
00:00:17.250 --> 00:00:18.840
with a slightly easier example.

8
00:00:18.840 --> 00:00:20.310
So if you'd like to follow on,

9
00:00:20.310 --> 00:00:21.435
please make sure you have

10
00:00:21.435 --> 00:00:25.570
155 index match
examples opened up.

11
00:00:25.880 --> 00:00:28.860
In this example, we
would like to look

12
00:00:28.860 --> 00:00:31.545
up the population for Algeria.

13
00:00:31.545 --> 00:00:34.260
If you have a look at
the population column,

14
00:00:34.260 --> 00:00:35.630
you'll see the population for

15
00:00:35.630 --> 00:00:37.850
Algeria is in the third position.

16
00:00:37.850 --> 00:00:39.980
Now, this gives us a clue as to

17
00:00:39.980 --> 00:00:42.480
how the INDEX function works.

18
00:00:42.480 --> 00:00:44.930
If we come into
B4, we're going to

19
00:00:44.930 --> 00:00:48.110
type "=IN" and tab.

20
00:00:48.110 --> 00:00:50.510
The first argument
the INDEX function

21
00:00:50.510 --> 00:00:52.600
requires is an array.

22
00:00:52.600 --> 00:00:55.640
Now, this array can
be a column or a row,

23
00:00:55.640 --> 00:00:57.050
so the INDEX function will work

24
00:00:57.050 --> 00:00:59.065
both vertically and horizontally.

25
00:00:59.065 --> 00:01:02.210
In this case, our array's
the population column,

26
00:01:02.210 --> 00:01:04.010
and I've named it, so
we're just going to type

27
00:01:04.010 --> 00:01:06.860
"pop" and tab to select.

28
00:01:06.860 --> 00:01:09.380
Then we going to type a comma.

29
00:01:09.380 --> 00:01:14.180
The next argument the INDEX
requires is a row number.

30
00:01:14.180 --> 00:01:17.585
In other words, the
position within that array.

31
00:01:17.585 --> 00:01:19.670
We can see that
Algeria's populations

32
00:01:19.670 --> 00:01:20.945
is in the third position.

33
00:01:20.945 --> 00:01:26.955
So I'm going to type a three
and press "Enter." Too easy.

34
00:01:26.955 --> 00:01:29.415
There's our population
for Algeria.

35
00:01:29.415 --> 00:01:32.055
So pretty straightforward really,

36
00:01:32.055 --> 00:01:34.260
except one small problem.

37
00:01:34.260 --> 00:01:38.060
If I come to Algeria and
I actually changed this,

38
00:01:38.060 --> 00:01:39.920
so we going to drop down
the list, and I say,

39
00:01:39.920 --> 00:01:42.790
actually I want the
population for Angola,

40
00:01:42.790 --> 00:01:45.345
you'll see it's not changing,

41
00:01:45.345 --> 00:01:47.730
and that's because I
actually typed the three in.

42
00:01:47.730 --> 00:01:50.450
So obviously, we need a way of

43
00:01:50.450 --> 00:01:54.700
automating the process of
determining the position.

44
00:01:54.700 --> 00:01:56.970
What I want to do is take

45
00:01:56.970 --> 00:01:59.910
the selected country
and match it into

46
00:01:59.910 --> 00:02:02.210
my country data and return

47
00:02:02.210 --> 00:02:05.395
the position at which
that country is found.

48
00:02:05.395 --> 00:02:07.250
So in other words, I'd like

49
00:02:07.250 --> 00:02:10.085
Angola to be found at position 5.

50
00:02:10.085 --> 00:02:12.110
Now, the function
that can help us with

51
00:02:12.110 --> 00:02:14.765
this is the MATCH function.

52
00:02:14.765 --> 00:02:17.255
Click in to C4, I'm going to type

53
00:02:17.255 --> 00:02:21.010
"=M" and Tab to MATCH.

54
00:02:21.010 --> 00:02:24.015
Now, the MATCH is similar
to a VLOOKUP in a way,

55
00:02:24.015 --> 00:02:27.240
in that the first thing it
wants is a lookup value.

56
00:02:27.240 --> 00:02:29.420
Our lookup value, the
thing we're going to

57
00:02:29.420 --> 00:02:31.415
use to MATCH is our country.

58
00:02:31.415 --> 00:02:34.375
So click on A4 and type comma.

59
00:02:34.375 --> 00:02:37.895
We then need to provide
it with a lookup array.

60
00:02:37.895 --> 00:02:40.880
But unlike VLOOKUP,
with the MATCH,

61
00:02:40.880 --> 00:02:44.285
it can only be a single
column or a single row.

62
00:02:44.285 --> 00:02:47.860
But again, it can work
horizontally or vertically.

63
00:02:47.860 --> 00:02:50.450
Here, we want to match it
into the country column,

64
00:02:50.450 --> 00:02:52.310
and I've called it "ctry",

65
00:02:52.310 --> 00:02:54.425
so I don't need to complete
with those counts,

66
00:02:54.425 --> 00:02:56.335
and then I'm going to type comma.

67
00:02:56.335 --> 00:02:59.280
The last thing we need
to provide is whether

68
00:02:59.280 --> 00:03:01.895
it's range lookup
or an exact match.

69
00:03:01.895 --> 00:03:03.530
Of course this is an exact match,

70
00:03:03.530 --> 00:03:07.860
so we type zero and
then we press "Enter."

71
00:03:08.390 --> 00:03:12.350
As we would expect, it's
found Angola at position 5.

72
00:03:12.350 --> 00:03:14.210
So now all we need
to do is somehow

73
00:03:14.210 --> 00:03:16.745
combine our MATCH with our INDEX,

74
00:03:16.745 --> 00:03:18.425
and will show you
a really easy way.

75
00:03:18.425 --> 00:03:20.585
I'm going to double-click
back into C4,

76
00:03:20.585 --> 00:03:22.985
and select everything
except the equals,

77
00:03:22.985 --> 00:03:26.455
and copy "Ctrl + C",
then press "Escape."

78
00:03:26.455 --> 00:03:29.865
Then come back into
B4, double click,

79
00:03:29.865 --> 00:03:32.240
and we're going to
replace this three,

80
00:03:32.240 --> 00:03:35.825
so I'm going to delete it
with our MATCH, so paste,

81
00:03:35.825 --> 00:03:38.880
"Ctrl + V". What will

82
00:03:38.880 --> 00:03:40.610
happen now is the MATCH will look

83
00:03:40.610 --> 00:03:42.770
up the appropriate row number,

84
00:03:42.770 --> 00:03:45.185
and then the INDEX
will return the value

85
00:03:45.185 --> 00:03:48.005
in that position in
the population column.

86
00:03:48.005 --> 00:03:49.990
So when I press "Enter,"

87
00:03:49.990 --> 00:03:52.245
there's my population for Angola,

88
00:03:52.245 --> 00:03:53.750
and if I come to my country

89
00:03:53.750 --> 00:03:56.510
selection and I choose Australia,

90
00:03:56.510 --> 00:03:59.760
there's my population
for Australia.

91
00:03:59.930 --> 00:04:02.570
So while the INDEX
and MATCH can work

92
00:04:02.570 --> 00:04:03.830
independently and can even

93
00:04:03.830 --> 00:04:05.300
be combined with other functions,

94
00:04:05.300 --> 00:04:08.530
we do typically find
them working together.

95
00:04:08.530 --> 00:04:10.965
But that's not all we can do.

96
00:04:10.965 --> 00:04:13.670
The INDEX will actually
allow us to look

97
00:04:13.670 --> 00:04:16.835
up in two directions
at the same time.

98
00:04:16.835 --> 00:04:20.105
To demonstrate, can I ask you
to come to the next sheet,

99
00:04:20.105 --> 00:04:22.320
which is called "Two"

100
00:04:22.520 --> 00:04:25.890
Here we're going to
extend our example.

101
00:04:25.890 --> 00:04:27.950
Previously, we only worried

102
00:04:27.950 --> 00:04:29.600
about returning the population,

103
00:04:29.600 --> 00:04:31.610
but it's possible we
could want to also

104
00:04:31.610 --> 00:04:33.725
get back the capital
or the currency,

105
00:04:33.725 --> 00:04:35.600
and you'll see I've actually

106
00:04:35.600 --> 00:04:38.030
got this value on a
drop down as well.

107
00:04:38.030 --> 00:04:41.090
So we don't have to just
get back population.

108
00:04:41.090 --> 00:04:43.670
The thing though is
we now going to not

109
00:04:43.670 --> 00:04:46.370
only have to determine
which row the values in,

110
00:04:46.370 --> 00:04:48.595
but also which column.

111
00:04:48.595 --> 00:04:51.940
So we're going to
need another MATCH.

112
00:04:51.940 --> 00:04:54.530
Now, we've already
got a MATCH function

113
00:04:54.530 --> 00:04:57.470
created for us in C4
returning our row number,

114
00:04:57.470 --> 00:05:00.270
what we're going to
do is click into D4,

115
00:05:00.270 --> 00:05:02.815
and we're going to type "=M"

116
00:05:02.815 --> 00:05:06.185
and tab to start a second MATCH.

117
00:05:06.185 --> 00:05:09.380
The lookup value this time is

118
00:05:09.380 --> 00:05:13.205
the column header for the
value I want to get back.

119
00:05:13.205 --> 00:05:16.520
So I'm going to click on
"Population" and type comma,

120
00:05:16.520 --> 00:05:17.960
and then I'm going to match that

121
00:05:17.960 --> 00:05:20.250
into my other column headings.

122
00:05:20.270 --> 00:05:23.575
Again, this is an exact match,

123
00:05:23.575 --> 00:05:25.750
and it will find capital position

124
00:05:25.750 --> 00:05:27.955
1 and population in position 4.

125
00:05:27.955 --> 00:05:31.520
So I press "Enter," and
there's my column number.

126
00:05:31.520 --> 00:05:34.170
All that's left to
do is to create

127
00:05:34.170 --> 00:05:35.855
the INDEX function that will

128
00:05:35.855 --> 00:05:38.515
use this row number and
this column number.

129
00:05:38.515 --> 00:05:40.540
So we're going to
click into B4 and

130
00:05:40.540 --> 00:05:44.095
type "=IN" and tab.

131
00:05:44.095 --> 00:05:46.375
Our array this time however,

132
00:05:46.375 --> 00:05:48.265
is that whole block of data.

133
00:05:48.265 --> 00:05:53.170
So I'm going to start
from B7 and drag to E7,

134
00:05:53.170 --> 00:05:54.985
and then press "Ctrl + Shift +

135
00:05:54.985 --> 00:05:57.455
Down Arrow" to select
all the values.

136
00:05:57.455 --> 00:05:58.780
I'm just going to scroll

137
00:05:58.780 --> 00:06:00.890
up so you can see what I'm doing,

138
00:06:00.960 --> 00:06:03.860
and I'm going type the comma.

139
00:06:03.860 --> 00:06:07.965
The next argument the INDEX
needs is the row number.

140
00:06:07.965 --> 00:06:09.785
Now, we could type
the matching here,

141
00:06:09.785 --> 00:06:11.380
but you don't have to if
you've got it sitting

142
00:06:11.380 --> 00:06:13.165
in another cell, which we do.

143
00:06:13.165 --> 00:06:15.310
So we're just going
to click into C4.

144
00:06:15.310 --> 00:06:18.010
If you were only doing
a one-way lookup,

145
00:06:18.010 --> 00:06:20.935
you only need to
provide two arguments.

146
00:06:20.935 --> 00:06:22.705
But we doing two-way lookup,

147
00:06:22.705 --> 00:06:23.965
so we're going to
need to give it that

148
00:06:23.965 --> 00:06:25.510
column number as well.

149
00:06:25.510 --> 00:06:27.035
So I'm going to type a comma,

150
00:06:27.035 --> 00:06:30.010
and we've got our column
number calculated here.

151
00:06:30.010 --> 00:06:34.100
So I'm going to click on
D4 and press "Enter."

152
00:06:34.700 --> 00:06:37.725
So that's our
population for Algeria,

153
00:06:37.725 --> 00:06:41.575
but if I come and change
population to be capital,

154
00:06:41.575 --> 00:06:43.915
there's our capital for Algeria,

155
00:06:43.915 --> 00:06:48.570
and if I click on Algeria and
change that to Australia,

156
00:06:48.620 --> 00:06:51.330
there's our capital
for Australia.

157
00:06:51.330 --> 00:06:53.460
So really powerful two-way lookup

158
00:06:53.460 --> 00:06:56.905
there using an INDEX
with two MATCHes.

159
00:06:56.905 --> 00:06:59.265
Now you understand
the principles.

160
00:06:59.265 --> 00:07:01.605
Let's go and finish off
that reconciliation.

161
00:07:01.605 --> 00:07:03.570
So I'm going to minimize this,

162
00:07:03.570 --> 00:07:05.595
and we're back in our Recon.

163
00:07:05.595 --> 00:07:08.340
Now, you may recall from
the last video that

164
00:07:08.340 --> 00:07:10.965
there was just one problem left,

165
00:07:10.965 --> 00:07:12.640
and that was this record,

166
00:07:12.640 --> 00:07:14.810
where the amounts
paid according to

167
00:07:14.810 --> 00:07:18.355
the supplier were different
to the one on our report.

168
00:07:18.355 --> 00:07:20.090
Now, Zara looks at the data more

169
00:07:20.090 --> 00:07:21.980
carefully and noticed that

170
00:07:21.980 --> 00:07:23.690
this customer reference
number is actually

171
00:07:23.690 --> 00:07:26.485
a duplicate of another,
which can't be right.

172
00:07:26.485 --> 00:07:29.060
What she'd like to do is return

173
00:07:29.060 --> 00:07:32.405
the correct reference
number from her system,

174
00:07:32.405 --> 00:07:34.370
and she can do this by

175
00:07:34.370 --> 00:07:36.290
matching the purchase
order number in

176
00:07:36.290 --> 00:07:39.175
this report to the
purchase order number

177
00:07:39.175 --> 00:07:41.475
in her MC report.

178
00:07:41.475 --> 00:07:43.100
So she's going to
match the purchase

179
00:07:43.100 --> 00:07:44.705
order number into this column,

180
00:07:44.705 --> 00:07:46.805
and when she finds
it at this position,

181
00:07:46.805 --> 00:07:50.910
she wants to get back the
appropriate payment reference.

182
00:07:51.830 --> 00:07:55.480
She can't use VLOOKUP
to do this however,

183
00:07:55.480 --> 00:07:57.890
because the purchase order number

184
00:07:57.890 --> 00:08:00.560
is to the right of the
payment reference.

185
00:08:00.560 --> 00:08:03.140
She can, however,
use an INDEX MATCH.

186
00:08:03.140 --> 00:08:04.990
So that's exactly what
we're going to do.

187
00:08:04.990 --> 00:08:07.335
That can also apply
in voice statement.

188
00:08:07.335 --> 00:08:10.000
We're going to click into
V2 and we're going to

189
00:08:10.000 --> 00:08:13.420
type "=IN" and Tab INDEX.

190
00:08:13.420 --> 00:08:14.950
Our lookup array is

191
00:08:14.950 --> 00:08:17.110
the payment reference
column on the other sheets,

192
00:08:17.110 --> 00:08:20.520
we just going to type PAY,
Down Arrow twice and Tab,

193
00:08:20.520 --> 00:08:22.800
because it's named, and comma.

194
00:08:22.800 --> 00:08:24.760
But now we need to MATCH

195
00:08:24.760 --> 00:08:26.230
our customer purchase
order number,

196
00:08:26.230 --> 00:08:29.045
so I'm going to type "MA" and Tab.

197
00:08:29.045 --> 00:08:31.765
I'm going to click
on the customer PO,

198
00:08:31.765 --> 00:08:33.250
and I'm going to match that into

199
00:08:33.250 --> 00:08:35.380
the purchase order column
in the other sheets.

200
00:08:35.380 --> 00:08:38.410
So "PO" and Tab to
select PO number.

201
00:08:38.410 --> 00:08:40.900
Don't forget to make
it exact, otherwise,

202
00:08:40.900 --> 00:08:43.785
you get random wrong
results coming back.

203
00:08:43.785 --> 00:08:46.055
Close the bracket for your MATCH,

204
00:08:46.055 --> 00:08:50.160
close the bracket for your
INDEX, and press "Enter."

205
00:08:51.320 --> 00:08:54.120
Zara was completely right.

206
00:08:54.120 --> 00:08:58.595
The payment reference
should be 24674, not 673.

207
00:08:58.595 --> 00:09:00.350
So we're just going
to come in here,

208
00:09:00.350 --> 00:09:04.745
and replace that three with
a four and press "Enter."

209
00:09:04.745 --> 00:09:06.500
It is now pulling back

210
00:09:06.500 --> 00:09:11.040
the correct amount and everything
is balancing perfectly.

211
00:09:11.180 --> 00:09:14.630
So we've seen how the
INDEX and MATCH can

212
00:09:14.630 --> 00:09:17.990
solve problems that may be on
the lookup functions count.

213
00:09:17.990 --> 00:09:20.480
There is a little bit of a
learning curve involved,

214
00:09:20.480 --> 00:09:22.130
but the good news is we've given

215
00:09:22.130 --> 00:09:23.630
you another great
practice challenged.

216
00:09:23.630 --> 00:09:25.550
Go and practice all
these new skills.

217
00:09:25.550 --> 00:09:28.440
So don't forget to check it out.